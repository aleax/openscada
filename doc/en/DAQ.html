<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="UTF-8" />
<title>Documents/DAQ - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="files/doc.css" rel="stylesheet" /></head>
<body><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="en">Documents/DAQ</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><span class="mw-pt-languages-ui mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">English</span>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Documents/DAQ/ru" title="Документы/Сбор данных (100% translated)">российский</a>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Documents/DAQ/uk" title="Документи/Збір даних (100% translated)">українська</a></div></div>
<p><i>Author:</i> <a class="external text" href="http://wiki.oscada.org/RomanSavochenko" rel="nofollow noreferrer noopener" target="_blank">Roman Svochenko</a>
</p>
<dl><dd><dl><dd><a class="external text" href="http://wiki.oscada.org/MaximLysenko" rel="nofollow noreferrer noopener" target="_blank">Maxim Lysenko</a> (2010) — the page translation</dd></dl></dd></dl>
<p><br />
</p>
<div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Data_acquisition_methods"><span class="tocnumber">1</span> <span class="toctext">Data acquisition methods</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Simple_synchronous_acquisition_mechanism"><span class="tocnumber">1.1</span> <span class="toctext">Simple synchronous acquisition mechanism</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Simple_asynchronous_acquisition_mechanism"><span class="tocnumber">1.2</span> <span class="toctext">Simple asynchronous acquisition mechanism</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Acquisition_mechanism_in_packages"><span class="tocnumber">1.3</span> <span class="toctext">Acquisition mechanism in packages</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Passive_acquisition_mechanism"><span class="tocnumber">1.4</span> <span class="toctext">Passive acquisition mechanism</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Virtual_data_sources"><span class="tocnumber">2</span> <span class="toctext"><span>Virtual data sources</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Logic_level_of_the_data_processing"><span class="tocnumber">3</span> <span class="toctext"><span>Logic level of the data processing</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Redundancy_of_the_data_sources"><span class="tocnumber">4</span> <span class="toctext">Redundancy of the data sources</span></a></li>
</ul>
</div>

<p>Data acquisition of the SCADA (Supervisory Control and Data Acquisition)-system is its integral part, which get data from sources of different type. The nature of data, which operates SCADA, is characterized by signals of basic value's types (Integer, Real, Boolean and String). The signals vary over time and has their history — life. In the theory of technological processes (TP), under the signal means the value of TP sensor in the ADC code — "raw" signal or in the real value — engineer one. Signals can be combined into groups, which are often called parameters or complex tags. For example, the advanced data sources can provide the structures of parameters with the predefined set of related signals. In addition to the direct data acquisition, to the function of this mechanism also includes the transfer of actions on the executive control devices of TP, usually it is: latches, pumps and control valves. Taken together, this equipment is known as Matching to Object Device (MOD).
</p><p>Data sources are characterized by a large variety, which can be divided into three groups:
</p>
<ul><li> Sources of "raw" data, providing the ADC code or levels of discrete signals, and also the sources which include simple processing. Typically, these are modules of distributed MODs or simpler industrial programmable logic controllers (PLCs).</li>
<li> Powerful industrial PLCs, which have significant computing power and the possibility of formation of complex parameters with different structure.</li>
<li> Local or related data sources. For example, the MOD as expansion cards, and also the data of the environment of hardware and software in which the system operates.</li></ul>
<p>The variety of data sources has created a wide range of mechanisms to access them. Local data sources are different in application programming interface (API), and network sources, in their turn, in transport and protocol interaction level. In general, this has led to the fact that the addition of support for a new data source requires the creation of interface module or driver. Taking into account the great variety of sources, it is extremely expensive and actually impossible to cover the entire spectrum of the market of these devices. The situation is somewhat simplified with the network source due to the presence of the number of standard and free interaction protocols, but many sources still use their own protocols: private, commercial or protocols, tied to private mechanisms of the commercial operating systems (OS).
</p><p>In terms of OpenSCADA, the following objects of the data model to serve the data acquisition mechanism are provided:
</p>
<ul><li> "Attribute" — reflection object of the signal data, includes the current value of the specified type of signal and access to the history of the change of these values;</li>
<li> "Parameter" — object of the attributes' group with the structure corresponding to the characteristics of the separate data source;</li>
<li> "Controller object" — object of the separate data device. Typically, this is a separate MOD module or a device of industrial PLC.</li></ul>
<p>To account the features of different data acquisition devices, as well as the different mechanisms of interaction, in OpenSCADA <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#DAQ" title="Special:MyLanguage/Documents/Program manual">the modular subsystem "Data acquisition"</a> is provided. The module of the subsystem is the driver for interfacing with a data source of specific type. Each module can contain the configuration of several devices of this type as controller objects. The general scheme of objects of "Data acquisition" subsystem is shown in Figure 1.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:309px;"><a class="image" href="http://oscada.org/wiki/File:Oscada_subsys_daq_str.png"><img class="thumbimage" height="335" src="files/Oscada_subsys_daq_str.png" width="307" /></a>  <div class="thumbcaption">Fig. 1. Scheme of the subsystem "Data acquisition".</div></div></div></div>
<h2><span class="mw-headline" id="Data_acquisition_methods"><span class="mw-headline-number">1</span> Data acquisition methods</span></h2>
<p>Taking into account variety of the data sources, and also the ways of their possible interaction, the data acquisition methods can be divided to: simple synchronous, simple asynchronous, package and passive ones.
</p><p>In the review of the mechanisms below, the following objects will be involved:
</p>
<ul><li> "ObjectSCADA" — any object of the SCADA-system, which refers to the value of the signal, such as archives and visualizers;</li>
<li> "DAQParamAttribute" — parameter attribute of the subsystem "Data acquisition", which is an intermediary for access to the value of the data source signal;</li>
<li> "DAQParamAttributeArch" — object of the attribute's archive;</li>
<li> "HardwarePLC" — data source object, for example, modules of the allocated MOD or industrial PLC.</li></ul>
<h3><span class="mw-headline" id="Simple_synchronous_acquisition_mechanism"><span class="mw-headline-number">1.1</span> Simple synchronous acquisition mechanism</span></h3>
<p>The mechanism is characterized by requests to the data source synchronously with the request to the parameter attribute (Fig. 2). This mechanism is usually used when working with local data sources, characterized by low latency, i.e. delay in response to the request. With this method you can get actual data directly with the request, but the time of the request of the object will include the time for transportation and processing of the request by the data source.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:686px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_simpleSync.png"><img class="thumbimage" height="179" src="files/DAQ_simpleSync.png" width="684" /></a>  <div class="thumbcaption">Fig. 2. Diagram of the sequence of interaction with the synchronous requests.</div></div></div></div>
<p>In accordance with the diagram above, we obtain the following sequence of requests for data acquisition and their transfer:
</p>
<ul><li> object of the SCADA-system sends the value request to the object of the parameter attribute <b>DAQParamAttribute::getVal()</b>;</li>
<li> object of the parameter attribute, receiving the request, sends it to the data source <b>HardwarePLC::valueRequest()</b>;</li>
<li> data source after processing the request returns the result;</li>
<li> object of the parameter attribute, receiving the result, returns its to the SCADA-system object.</li></ul>
<p>In OpenSCADA this mechanism is implemented by the following modules of the subsystem "DAQ":
</p>
<ul><li> <i><a href="Modules/JavaLikeCalc.html" title="Special:MyLanguage/Modules/JavaLikeCalc">JavaLikeCalc</a></i> — calculator on the Java-like high level language. As a data source, a user program in a Java-like language acts. Parameter attributes of the module synchronously address the inputs/outputs of the computing context of the user function.</li>
<li> <i><a href="Modules/LogicLev.html" title="Special:MyLanguage/Modules/LogicLev">LogicLev</a></i> — module of the logical-level parameters of the data acquisition, see more about it in section 3. As the data source of this module stand other parameters of the subsystem "Data acquisition" and the execution context of the parameters template. parameter attributes of the module synchronously address the attributes of other parameters in the reflection mode of the parameters of the subsystem "Data acquisition", or the inputs/outputs of the execution context of the template when work under the template.</li>
<li> <i><a href="Modules/BlockCalc.html" title="Special:MyLanguage/Modules/BlockCalc">BlockCalc</a></i> — calculator in the language of block diagrams. As a data source, the user block diagram is stood. Parameter attributes of the module synchronously address the inputs/outputs of the blocks of block scheme.</li>
<li> <i><a href="Modules/DAQGate.html" title="Special:MyLanguage/Modules/DAQGate">DAQGate</a></i> — module of the reflection of the controller objects of the remote OpenSCADA-stations on the local one. In the module the synchronous mode for recording data is implemented.</li>
<li> <i><a href="Modules/ModBus.html" title="Special:MyLanguage/Modules/ModBus">ModBus</a></i> — module of the accessing to the sources data through the ModBus protocols family. In the module the synchronous mode for recording data is implemented.</li>
<li> <i><a href="Modules/DiamondBoards.html" title="Special:MyLanguage/Modules/DiamondBoards">DiamondBoards</a></i> — module of the data accessing of the PC/104 cards of the Diamond Systems company. PC/104 boards are available on the ISA-bus, hence are local and available relatively quickly. When data acquisition is made not by interruption the access to the values of the ADC is synchronous. Recording mode of the DAC values always works synchronously.</li></ul>
<h3><span class="mw-headline" id="Simple_asynchronous_acquisition_mechanism"><span class="mw-headline-number">1.2</span> Simple asynchronous acquisition mechanism</span></h3>
<p>The mechanism is characterized by requests to the data source, regardless of the request to the parameter attribute (Fig. 3). Usually, requests to the data source are made periodically in own polling task of the single taken controller and with the blocks of several signals. This request to the parameter attribute returns the value obtained from the last connection session with the data source. This mechanism is usually used when working with remote (network) data sources, characterized by high latency, i.e. delay in the response to the request. 
</p><p>With this method it's possible to optimize the time resource spent on one signal, and thereby increase the maximum number of requested signals during the time interval of the polling.
</p><p>As an example, lets examine an industrial PLC "Siemens S7-315" during requesting him on the bus ProfiBus (1,5 Mbit/s). The average processing time of the MPI-request of this controller is 30 ms. If you use the synchronous mechanism for each signal, i.e. one request for each signal, then in one second we can get something about 33 signals. And if you apply the asynchronous mechanism, i.e. in the MPI-package to receive up to 220 bytes or 110 signals of integer type of 16-bit, then we can for one second get up to the 3630 signals. As you can see, the effectiveness of the asynchronous mechanism in this case is 110 times, that is the maximum capacity of MPI-package. 
</p><p>The disadvantage of the asynchronous mechanism is that the request of the value of parameter attribute returns not actual at the time of request value, but value of the last session of the polling of the controller. However, taking into account that the data source can be updated at intervals of ADC hardware limitations, and the sensors themselves may have certain restrictions on the reaction rate, the using of the asynchronous acquisition mechanism could have a serious grounds.
</p><p>Application of the asynchronous mechanism for recording the values to the PLC is a fairly rare fact, because recording of values usually involves impact of the operator on the TP. Operator on the fact rarely makes adjustments to the process, therefore, the recording can be performed synchronously. However, there are situations, such as managing of the TP by the regulator on SCADA-system, acting as the runtime environment of PLC.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:710px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_simpleAsync.png"><img class="thumbimage" height="279" src="files/DAQ_simpleAsync.png" width="708" /></a>  <div class="thumbcaption">Fig. 3. Diagram of the sequence of interaction with the asynchronous requests.</div></div></div></div>
<p>In accordance with the diagram above, we obtain the following picture:
</p>
<ul><li> parameter attribute, or the parent controller object, performs the periodic requests <b>HardwarePLC::valueRequest()</b> to get the value of signal or group of signals;</li>
<li> received signal values are located locally in the parameter attributes;</li>
<li> object of the SCADA-system sends the value request to the parameter attribute <b>DAQParamAttribute::getVal()</b> and gets locally saved value of the previous session of the data source polling.</li></ul>
<p>In OpenSCADA this mechanism is implemented by the following modules of the subsystem "DAQ":
</p>
<ul><li> <i><a href="Modules/DAQGate.html" title="Special:MyLanguage/Modules/DAQGate">DAQGate</a></i> — module of the reflection of controller objects of the remote OpenSCADA-stations on the local one. In the module the asynchronous mode of reading data is implemented.</li>
<li> <i><a href="Modules/System.html" title="Special:MyLanguage/Modules/System">System</a></i> — module of accessing the data of the execution area of OpenSCADA. In the module the asynchronous mode of reading data is implemented.</li>
<li> <i><a href="Modules/ModBus.html" title="Special:MyLanguage/Modules/ModBus">ModBus</a></i> — module of accessing the data sources through the "ModBus" protocols family. In this module the asynchronous mode is implemented both for the data reading and recording (optional) to the PLC.</li>
<li> <i><a href="Modules/SNMP.html" title="Special:MyLanguage/Modules/SNMP">SNMP</a></i> — module of accessing the data of the network devices through "the Simple Network Management Protocol". In the module the asynchronous mode of reading data is implemented.</li>
<li> <i><a href="Modules/Siemens.html" title="Special:MyLanguage/Modules/Siemens">Siemens</a></i> — module of accessing the data of Siemens controllers of the S7 series. In this module the asynchronous mode is implemented both for the data reading and recording (optional) to the PLC.</li></ul>
<h3><span class="mw-headline" id="Acquisition_mechanism_in_packages"><span class="mw-headline-number">1.3</span> Acquisition mechanism in packages</span></h3>
<p>Acquisition mechanism in packages is characterized by the acquisition of data for each signal by the packet that includes the history of its changes. I.e. per one session of data poll we obtain multiple values of history of the signal. The package mechanism works in conjunction with the synchronous and asynchronous mechanisms.
</p><p>In the case of working with the synchronous mechanism, the actual transfer of the data source archive to operational work in the system is performed (Fig. 2). Like the simple synchronous mechanism, it is desirable to use it only on low-latency data sources or with sources that work in sessional, for example, in the field of commercial accounting for reading the values of counters.
</p><p>When working in conjunction with the asynchronous mechanism, history of the received signals is usually placed directly in the archives (Fig. 4), and the current value of the parameter attribute is set to last value of the package. Such combination is effective in acquisition fast data or synchronizing archives after losing connection with the remote data source.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:555px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_packAsync.png"><img class="thumbimage" height="267" src="files/DAQ_packAsync.png" width="553" /></a>  <div class="thumbcaption">Fig. 4. Diagram of the sequence of interaction with the asynchronous requests of the package mechanism.</div></div></div></div>
<p>In accordance with the diagram above, we obtain the following behavior of the package mechanism for asynchronous requests:
</p>
<ul><li> parameter attribute, or the parent controller object, performs the periodic requests <b>HardwarePLC::valueRequest()</b> to get the value's packages of a signal or group of signals;</li>
<li> received value packages of the signals are placed in the archive by the request <b>DAQParamAttributeArch::setValues()</b>, and the last value of the packages is located in the parameter attribute;</li>
<li> object of SCADA-system sends the request of the archive's fragment to the parameter attribute <b>DAQParamAttribute::getValues()</b>, and he relays the request to the archive <b>DAQParamAttributeArch::getValues()</b>. As the result, the fragment of the archive, available after the previous session of the polling of the data source, is returned;</li>
<li> object of the SCADA-system sends the request of the last value of the parameter attribute <b>DAQParamAttribute::getVal()</b> and gets the locally saved value of the previous session of the data source polling.</li></ul>
<p>In OpenSCADA this mechanism is implemented by the following modules of the subsystem "DAQ":
</p>
<ul><li> <i><a href="Modules/DAQGate.html" title="Special:MyLanguage/Modules/DAQGate">DAQGate</a></i> — module of reflection of controller objects of the remote OpenSCADA-stations on the local one. The synchronous and asynchronous packet mode of reflection of the archives of the remote OpenSCADA-stations is provided.</li>
<li> <i><a href="Modules/DiamondBoards.html" title="Special:MyLanguage/Modules/DiamondBoards">DiamondBoards</a></i> — module for data accessing of PC/104 cards of Diamond Systems company. PC/104 cards are available on the ISA-bus, hence, are local and available relatively quickly. When data acquisition is done through interruption the expectation of the packets of fast values (up to 200 kHz) in one second (up to 200000 values in the package) is made and the subsequent placing of packets in the archives of the DAQ parameter attributes are performed.</li></ul>
<h3><span class="mw-headline" id="Passive_acquisition_mechanism"><span class="mw-headline-number">1.4</span> Passive acquisition mechanism</span></h3>
<p>The passive acquisition mechanism is characterized by the initiative of providing data to the SCADA-system from the data source. This mechanism is quite rare, but can occur in certain conditions or restrictions of the possibility of using the direct data acquisition mechanisms, Figure 5. An example of such situation can be the geographically allocated systems of the data acquisition through mobile networks GPRS/EDGE/3G/4G. In such networks, the allocation of all client nodes to individual real and static IP-addresses or the formation of a corporate mobile network may prove to be expensive, therefore, the initiative of the data transferring from client dynamic IP-addresses to one real IP-address of the SCADA-server is more accessible. Modification actions are transmitted to the data source at the time of the data transmission session by the source — reading. Although, typical requests are possible here through a VPN connection from a data source and working through a network intermediate DBMS.
</p><p>An intermediate variant is the initiative of the TCP-connection establishing from the data source and the typical requests do next by the server through the connection, that is supported now by OpenSCADA <a href="Modules/Sockets.html" title="Special:MyLanguage/Modules/Sockets">Transport.Sockets</a> input transport.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:729px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_passive.png"><img class="thumbimage" height="190" src="files/DAQ_passive.png" width="727" /></a>  <div class="thumbcaption">Fig. 5. Diagram of the sequence of interaction with the passive working mode.</div></div></div></div>
<p>In accordance with the diagram above, we obtain the following behavior of the passive mechanism:
</p>
<ul><li> data source object carries out periodic connection sessions with the parameter attribute <b>DAQParamAttributeArch::setVal()</b> to transfer its own data and receive influence commands;</li>
<li> object of the SCADA-system sends the request to the last value of the parameter attribute <b>DAQParamAttribute::getVal()</b> and gets the locally stored value of the previous connection session of the data source.</li></ul>
<p>In OpenSCADA this mechanism has not been yet used, but in principle there is the possibility of its realization, for example, through writing by the standard protocols "ModBus", "OPC-UA".
</p>
<h2><span class="mw-headline" id="Virtual_data_sources"><span class="mw-headline-number">2</span> <span id="Virtual" title="#Virtual">Virtual data sources</span></span></h2>
<p>In addition to the physical data acquisition the function of the virtual data acquisition is also important. Virtual data are the data obtained inside the system both independently and on the basis of the physical data. Practically, the virtual data formation mechanisms are implemented in conjunction with the mechanism of user computing. Among the industrial controllers and SCADA-systems the different programming languages are used. In the case of controllers such languages can be for example low-level languages (assemblers), but in recent years the high-level languages (C, Pascal and others) are increasingly used, as well as the formal languages of IEC 61131-3 (sequential function chart SFC, function block diagrams FBD, LD relay circuits and text ST, IL). In the case of SCADA-systems, the computing is often provided with the help of high-level programming languages and formal languages.
</p><p>In OpenSCADA the programming interfaces and virtual data sources on the basis of different languages can be implemented, in separate modules of the subsystem "Data acquisition". At the current time the available modules of virtual calculators are:
</p>
<ul><li> Calculator on the Java-like language: <a href="Modules/JavaLikeCalc.html" title="Special:MyLanguage/Modules/JavaLikeCalc">JavaLikeCalc</a>;</li>
<li> Block calculator: <a href="Modules/BlockCalc.html" title="Special:MyLanguage/Modules/BlockCalc">BlockCalc</a>.</li></ul>
<p>The mechanism of user functions, or <a href="User_API.html" title="Special:MyLanguage/Documents/User API">User Programming API</a>, is integrated into the OpenSCADA core. User functions can be provided by any object of the program, including modules in accordance with their functionality, thus providing the user with the set of functions for the control of one or another object. User API functions can be either static, i.e. implementing the fixed functionality of an individual object, and the dynamic ones, i.e. formed by the user for the desired task in the internal high-level programming language of the user.
</p><p>The module <a href="Modules/JavaLikeCalc.html" title="Special:MyLanguage/Modules/JavaLikeCalc">JavaLikeCalc</a> provides OpenSCADA with the mechanism to create dynamic functions of the user and their libraries on the Java-like language. Description of the function in the Java-like language consists in binding the parameters of the function by an algorithm. In addition, the module has the functions of the direct calculations by creating a computer controllers with the associated computational function. The module provides the mechanism of precompiling the context-dependent functions, that are used to embed the user algorithms directly in the context of the various components of OpenSCADA, that is, for example, <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#DAQ" title="Special:MyLanguage/Documents/Program manual">the parameters templates of the subsystem "Data acquisition"</a> and <a href="Modules/VCAEngine.html" title="Special:MyLanguage/Modules/VCAEngine">the Visual Control Area engine (VCA)</a>.
</p><p>The module <a href="Modules/BlockCalc.html" title="Special:MyLanguage/Modules/BlockCalc">BlockCalc</a> provides OpenSCADA with the mechanism for creating user calculations, based on the formal language of the block schemes. Languages of the block programming based on the concept of block schemes and functional blocks. Moreover, depending on the block nature, block scheme can be: logic circuits, relay logic circuits, a model of technological process and others. The essence of the block scheme is, that it contains the list of blocks and links between them. From a formal point of view, the block — is an element (function), which has inputs, outputs and an algorithm for computing. Based on the programming environment concept, the block is a frame of values associated with the function object. Inputs and outputs of blocks are to be connected to get the whole block scheme.
</p><p>With the purpose of filling the user programming API with the functions, the following specialized modules of static functions of the user programming API are created:
</p>
<ul><li> Library of System API functions: <a href="Modules/FLibSYS.html" title="Special:MyLanguage/Modules/FLibSYS">FLibSYS</a>;</li>
<li> Library of standard mathematical functions: <a href="Modules/FLibMath.html" title="Special:MyLanguage/Modules/FLibMath">FLibMath</a>;</li>
<li> Library of function for the compatibility with SCADA Complex1: <a href="Modules/FLibComplex1.html" title="Special:MyLanguage/Modules/FLibComplex1">FLibComplex1</a>.</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_progCompon.png"><img class="thumbimage" height="662" src="files/DAQ_progCompon.png" width="600" /></a>  <div class="thumbcaption">Fig. 6. Overall structure of the programming area components.</div></div></div></div>
<h2><span class="mw-headline" id="Logic_level_of_the_data_processing"><span class="mw-headline-number">3</span> <span id="LogicLev" title="#LogicLev">Logic level of the data processing</span></span></h2>
<p>Above we noted, that the type of the data source can vary from a "raw" to the complex. The "raw" means the source, that provides only the basic signals (Integer, Real, Boolean, String, ...) separately. The complex ones refers to the source that groups the signals and, in the parameter of the subsystem "Data acquisition", provides additional attributes that cover practically all diagnostic tasks, that is, the parameter is a completed object, that does not need to be supplemented.
</p><p>Taking into account this variation, the situation may occur, when the information in the controller parameter of the data source is insufficient to describe the real TP object in general and a derived object of a higher abstraction level is needed. The solution of this situation is the formation of complementary parameters, which isn't obvious and confusing. The better solution is to use the "Logic Level" layer, serving for the flexible formation of parameters-containers of signals with the necessary structure, and which has post-processing.
</p><p>Functionally, the "Logical level" is intended to provide the OpenSCADA with mechanism for the free formation of parameters-containers of signals of the desired structure.
</p><p>Operating appointment of the "Logic level" is:
</p>
<ul><li> expansion of the area of OpenSCADA application by increasing the flexibility of description of parameter of the subsystem "DAQ";</li>
<li> reduction of labor costs for the creation of complex automated systems.</li></ul>
<p>The "Logical level" concept is based on the template parameters, for which, in the subsystem "Data acquisition", the container of template libraries is provided (Fig.1). Each library contains templates of parameters that can be used by the modules of the subsystem "Data acquisition" for implementation of parameters based on the templates. The OpenSCADA modules, which use the templates in their work, are:
</p>
<ul><li> <a href="Modules/LogicLev.html" title="Special:MyLanguage/Modules/LogicLev">LogicLev</a> — module of implementation the classical conception of "Logic Level" .</li>
<li> <a href="Modules/ModBus.html" title="Special:MyLanguage/Modules/ModBus">ModBus</a> — module of accessing data sources through the family of "ModBus" protocols. Besides of description the direct registers type it also supports the logical type, where the "ModBus" registers describe into links of the template.</li>
<li> <a href="Modules/Siemens.html" title="Special:MyLanguage/Modules/Siemens">Siemens</a> — data acquisition module for Siemens controllers of the series S7. Thanks to the high flexibility and functionality of the controllers in this series, which allows for the formation of complex data types of diverse structure, all parameters of this module work on templates.</li></ul>
<p>General mechanism of the "Logic Level" on the example of the <a href="Modules/LogicLev.html" title="Special:MyLanguage/Modules/LogicLev">LogicLev</a> module is shown in Figure 7.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:302px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_loglevel.png"><img class="thumbimage" height="364" src="files/DAQ_loglevel.png" width="300" /></a>  <div class="thumbcaption">Fig. 7. Mechanism of the "Logic Level" on the example of the module "LogicLev".</div></div></div></div>
<p>On this figure you can see that the parameters of the logic level controller perform the reflection function of other parameters of the subsystem "DAQ" (on the example of parameters 1 and 4) and the free formation of the parameters based on templates 1, 2 and other parameters of the subsystem "DAQ" (on the example of the parameters 2, 3 and 5).
</p><p>Structure of the parameters with the template in their basis has the structure shown in Figure 8.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:244px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_str_prmtmpl.png"><img class="thumbimage" height="200" src="files/DAQ_str_prmtmpl.png" width="242" /></a>  <div class="thumbcaption">Fig. 8. Structure of the parameters, with a template in their basis.</div></div></div></div>
<p>As can be seen from the structure, the logic level parameter consists of the function object, attributes and configuration of the template. The function object is an instance of the execution of the template function with the set of inputs/outputs and the computation program of the template on the language of the user programming, usually it's the Java-like programming language of the module <a href="Modules/JavaLikeCalc.html" title="Special:MyLanguage/Modules/JavaLikeCalc">DAQ.JavaLikeCalc</a>. But the template may be generally without any program, providing only the structure of transfer the inputs/outputs. Attributes in the structure represent the list of attributes of the result parameter in accordance with the template. Configuration in the structure provides the configuration of the template properties and its external links.
</p><p>The logic of the work of logic-level parameters can be written as follows:
</p>
<ul><li> Parameter connects with the template from which it obtains the structure of attributes in accordance with the template function.</li>
<li> Binding of the object function of the parameter to the template function is performed.</li>
<li> Structure of links is formed in accordance with the template function. Based on the structure of links the form of linkage the parameter is formed and the user sets the links.</li>
<li> When accessing the attributes of the obtained parameter the check for the presence of a direct link does. In the case of the direct link presence the request is routed by this link, otherwise the value is taken from the function object of the parameter.</li>
<li> In parallel, the calculation of the template works by the function object of the parameter. However, before the calculation the reading of the values by the links is made, and after calculation the changes are recorded by these links.</li></ul>
<p>Parameters template in general provides the following:
</p>
<ul><li> I/O structure of the template function;</li>
<li> signs of the configuration and linkage of the template (constant, link);</li>
<li> preset values of the configuration of constants and link templates;</li>
<li> signs of the attributes of the resulting logical level parameter, types: not attribute, attribute with full access, attribute with read-only access;</li>
<li> mechanism for calculating the I/O of the template function by the user programming language of OpenSCADA.</li></ul>
<p>Figure 9 shows an image of the configuration tab of the parameters template of the subsystems "DAQ" as the table with the configuration of inputs/outputs and the text of the program of user programming.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:933px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_prmtmpl.png"><img class="thumbimage" height="727" src="files/DAQ_prmtmpl.png" width="931" /></a>  <div class="thumbcaption">Fig. 9. Configuration tab of a parameters template of the subsystem "DAQ".</div></div></div></div>
<p>The inputs/outputs tab "IO" of the parameters template provides the following properties of special purpose: "Attribute", "Configuration" and "Value".
</p><p>The property "Attribute" is the reflecting sign of the template I/O on the resulting attribute of the parameter. There the following options for this property are provided:
</p>
<ul><li> <i>No attribute</i> — input/output of the template function does not reflect on the attribute;</li>
<li> <i>Read only</i> — input/output of the template function reflects on the attribute with read-only access;</li>
<li> <i>Full access</i> — input/output of the template function reflects on the attribute with full access.</li></ul>
<p>The property "Configuration" is the sign indicating the using of input/output of the template function in the resulting configuration of the template on the logic level. The following options for this property are provided:
</p>
<ul><li> <i>Variable</i> — available for access and control only from the template procedure as a variable saved with the logical level parameter context;</li>
<li> <i>Constant</i> — available for setting at the parameter of logic level as a constant in the configuration section of the template;</li>
<li> <i>Link</i> — available for setting at the parameter of the logical level as a link in the configuration section of the template.</li></ul>
<p>The field "Value" describes the preset value for the constants and templates of the external links. Template of the external links is used to describe the mechanism of grouping and automatic allocation of the external links. The template structure of the external links is the specific for each module of the subsystem "DAQ", which uses the template mechanism. In the case of the logic level module the allocation is made over the external parameter attributes with the template of the external link of the form: <b>{Parameter}|{attribute}</b>. Where "Parameter" is used to combine the parameters and place on the configuration form, and "attribute" — for the associated linkage of the attributes at the parameter appointment.
</p><p>As an example of using the template, in Figure 10 is shown an image of the parameter "F3" of the logic level module, where the tab "Template configuration" is presented' for the configuration of the parameter template, including the linkage. In Figure 11 the tab "Attributes" is shown with the list of attributes and their values, created through the template.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:803px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_wprm_tmpl.png"><img class="thumbimage" height="595" src="files/DAQ_wprm_tmpl.png" width="801" /></a>  <div class="thumbcaption">Fig. 10. Tab "Template configuration" of the parameter "F3" of the logic level module.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:803px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_wprm_a.png"><img class="thumbimage" height="663" src="files/DAQ_wprm_a.png" width="801" /></a>  <div class="thumbcaption">Fig. 11. Tab "Attributes" of the parameter "F3" of the logical level module.</div></div></div></div>
<h2><span class="mw-headline" id="Redundancy_of_the_data_sources"><span class="mw-headline-number">4</span> Redundancy of the data sources</span></h2>
<p>Redundancy in general and of the data sources in particular serves to increase the overall level of fault-tolerance of the solution by integrating the redundant nodes in collaboration with the main node. In case of failure of the main node, the grab of the main node functions by the redundant one takes place. The redundant scheme can work in the mode of the load distribution between the co-operating nodes.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:515px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_red.png"><img class="thumbimage" height="351" src="files/DAQ_red.png" width="513" /></a>  <div class="thumbcaption">Fig. 12. Horizontal and vertical redundancy.</div></div></div></div>
<p>In the case of the "Data acquisition" subsystem, data reservation (Fig. 12) serves as:
</p>
<ul><li> <b>Redundancy of the data acquisition mechanism</b>. Typically, this function is realized without special arrangements by simply running of the parallel redundancy stations with the same configuration and working independently. However, in the case at the station working as PLC, such approach is unacceptable because of the simultaneous making of the control actions and the absence of synchronization of data of the calculators.</li>
<li> <b>Compensation of the data loss on the time of the node inaccessibility</b> with the redundant node archive. There are two mechanisms of the compensation. The first and the main mechanism implements the loading of the sections of the archive from the redundant station at the time of the station startup in general or of individual controller objects. The section of the archive is requested from the moment of the last record in the local archive and till the current time. The depth of the request is limited by the indicating of the limit time in the configuration of the redundancy. The second, complementary mechanism, performs the filling of the "holes" in the archive at the time of the actual user's request to the data. Such an approach on the one hand allows to make the predictable in time synchronization at startup and on the other hand it's actually eliminates the data loss in the case of working at least one station during the entire time.</li>
<li> <b>Distribution of the data acquisition load between the nodes</b>. When creating complex allocated systems there can be an important question of predicting and optimizing of the overall system performance. Taking into account these problems, the redundancy mechanism provides execution of the data acquisition tasks of individual sources (OpenSCADA controller objects) only at one station. The other stations' tasks would go to the data synchronization mode with the executive station. In the case of loss of the connection with the executive station, the local data acquisition task is started. It is also provided for the possibility of an optimal load distribution for executing the tasks of the data acquisition for a group of controller objects, between the stations.</li>
<li> <b>Optimization of the load on the external data sources</b> through the data request from an external source by the only one node. In practice, we often meet highly loaded data sources or interfaces of accessing to the data sources, for which even the data acquisition by one station can be a problem and would require reducing the acquisition periodicity, i.e. data quality. The mechanism of redundancy, besides the load distribution between the stations as described above, allows you to remove additional load form the data source and its interfaces, thereby improving the quality of the data. Writing to attributes of the controller object under redundancy causes to the modification request sending to the master one, that is — through it.</li>
<li> <b>Prevention of some differences of the data on different nodes</b> associated with the mismatch of moments of time at the independent acquisition of the data by individual nodes, performs in a way of receiving the data from the station with the active controller object. In systems of high accountability under the redundancy there should be excluded or minimized the differences in the data at different stations, that means the real acquisition of the data by one station and synchronization with these data of other ones.</li></ul>
<p>It is recommended that the redundancy is configured in such a way that the database of the redundant stations are kept the same, which in the future will allow you to safely copy them, at restoration, to any station and, accordingly, you can save only one set of databases in the backup. In this case, the settings specific to the individual station will be stored in the configuration file and it will be possible to easily configure and change the desired station by choosing the appropriate configuration file.
</p><p>Redundancy configuration start from the redundant stations appending to the list of OpenSCADA stations in the tab "Subsystem" of the subsystem "Transports" (Fig.13). And to add here you need not only the redundant stations to the current one but the same current one with its external IP, that is some loop. Further this configurations will have been stored into the generic DB of the redundant system, and from this time the DBs will be used in all redundant station creation. Then there is important to make on that stage all needed changes into the generic DB and about this project in general!
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:909px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_tr_extHst.png"><img class="thumbimage" height="448" src="files/DAQ_tr_extHst.png" width="907" /></a>  <div class="thumbcaption">Fig. 13. Tab "Subsystem" of the "Transports" subsystem.</div></div></div></div>
<p>Next for the concrete station, with copy of the generic DB, we configure its specific parameters into the tab "Redundancy" of the main page (Fig.14), which will be stored into the configuration file.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:670px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_sys_rd.png"><img class="thumbimage" height="586" src="files/DAQ_sys_rd.png" width="668" /></a>  <div class="thumbcaption">Fig. 14. Tab "Redundancy" of the main page.</div></div></div></div>
<p>After that all next configurations of the redundancy perform into the tab "Redundancy" of the subsystem "Data acquisition" (Fig.15). If you will set the parameter "Local primary commands transfer" (Fig.14) then the configurations, like to any other generic ones, can be carried out at one of the stations, and the changes made will fall on all the redundant stations, of course, if they will be available.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:824px;"><a class="image" href="http://oscada.org/wiki/File:DAQ_rd.png"><img class="thumbimage" height="586" src="files/DAQ_rd.png" width="822" /></a>  <div class="thumbcaption">Fig. 15. Tab "Redundancy" of the "Data Acquisition" subsystem.</div></div></div></div>
<p>The service task of the redundancy mechanism is always running and executed at intervals which are set in the appropriate configuration field. The real work on implementing the redundancy is carried out in the presence of at least one redundant station in the list of stations, and means:
</p>
<ul><li> Controlling of the connection with the external stations. In the controlling process the requests to remote stations are made to get the updated information and to check the connection. In the case of loss of connection with the station the repeat of connection to it is made through interval specified in the configuration field "Restore connection timeout". In the "Live" field of the station the current state of communication is displayed. In the "Counter" field the number of requests carried to the remote station, or the time remaining for the next connection attempt to the lost station is displayed.</li>
<li> Local planning of execution the controller objects in reserve. Planning is carried out in accordance with the station level and preferences of execution of the controller objects.</li>
<li> Calling the data synchronization function for the local controller objects, working in the mode of data synchronization from the external stations.</li></ul>
<p>To control the time spent in the cycle of serving the redundancy, the status field is provided. When approaching the real execution time to the cycle of the redundancy tasks it's recommended to increase the periodicity of this task execution!
</p><p>For the controller object of the subsystem "Data Acquisition", "Asymmetric" and "Only Alarms" reservation modes are provided. Asymmetric redundancy is working with the configuration of the controller of the remote station, as it is, and does not trying to generalize it. For this mode work all early presented functions and properties of the redundancy. The redundancy "Only Alarms" is working in fact without a redundancy, but with oppressing the alarms from the reserve controller object to exclude a duple messages into the alarms.
</p>





</div></body>
</html>