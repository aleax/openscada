<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="UTF-8" />
<title>Модули/Пускатель Qt GUI - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="../../en/files/doc.css" rel="stylesheet" /></head>
<body><div class="floatright"><a href="../index.html"><img alt="OpenSCADA" src="../../en/files/index.png" /></a></div><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="ru">Модули/Пускатель Qt GUI</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="ru"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a class="external text" href="http://oscada.org/wiki/index.php?title=Special:Translate&amp;group=page-Modules%2FQTStarter&amp;action=page&amp;filter=&amp;language=ru" rel="nofollow noreferrer noopener" target="_blank">translated version</a></span> of the page <a class="external" href="http://oscada.org/wiki/Modules/QTStarter" title="Modules/QTStarter">Modules/QTStarter</a> and the translation is 100% complete.</div><hr /><div class="mw-pt-languages" dir="ltr" lang="en"><div class="mw-pt-languages-list autonym"><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" href="../../en/Modules/QTStarter.html" title="Modules/QTStarter (100% translated)">English</a>&nbsp;• ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">mRussian</span>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="../../uk/Modules/QTStarter.html" title="Модулі/Пускач Qt GUI (100% translated)">Українська</a></div></div>
<table class="wikitable">

<tr>
<th> Модуль </th>
<th> Имя </th>
<th> Версия </th>
<th> Лицензия </th>
<th> Источник </th>
<th> Языки </th>
<th> Платформы </th>
<th> Тип </th>
<th> Автор
</th></tr>

<tr>
<td> <a href="../Modules/QTStarter.html" title="Special:MyLanguage/Modules/QTStarter">QTStarter</a> </td>
<td> Qt GUI пускатель
</td>
<td> 5.12 </td>
<td> GPL2 </td>
<td> ui_QTStarter.so </td>
<td> en,uk,ru,de </td>
<td> x86,x86_64,ARM
</td>
<td> Пользовательские интерфейсы </td>
<td> Роман Савоченко
</td></tr>
<tr>
<th colspan="9"> Описание
</th></tr>
<tr>
<td colspan="9"> Предоставляет Qt GUI пускатель. Qt-пускатель является единственным и обязательным компонентом для всех GUI модулей, основанных на библиотеке Qt.
<ul><li> <b>Общая трудоёмкость:</b> &gt; 10 <span title="человеко-дней, 1ЧД — 10 часов">ЧД<sup style="color: blue">[!]</sup></span></li>
<li> <b>Спонсировано, реализации резервирования на 0.5 <span title="человеко-дней, 1ЧД — 10 часов">ЧД<sup style="color: blue">[!]</sup></span>:</b> Хайди Рамезани</li>
<li> <b>Сделать (To Do):</b></li></ul>
<dl><dd> - реализовать менеджер подпроектов для их запуска в отдельных процессах, но с их хранением и управлением в одном конфигурационном файле проекта, для высоко-надёжных конфигураций;</dd>
<dd> - реализовать менеджер фонового исполнения процессов.</dd></dl>
</td></tr></table>
<p>Модуль предоставляет в OpenSCADA пускатель GUI модулей, основанных на многоплатформенной библиотеке <a class="external text" href="http://qt.io" rel="nofollow noreferrer noopener" target="_blank">Qt</a> графического пользовательского интерфейса (GUI), изначально созданной фирмой <a class="external text" href="http://www.trolltech.com" rel="nofollow noreferrer noopener" target="_blank">TrollTech</a>. Также, модуль реализует элементы менеджера проектов OpenSCADA. Отдельный модуль для запуска Qt GUI модулей нужен ввиду необходимости организации однопотокового исполнения всех компонентов визуализации Qt и централизованной инициализации главного объекта Qt-библиотеки — QApplication.
</p>
<div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.92.D1.81.D1.82.D1.83.D0.BF.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Вступление</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Qt_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D0.B8_OpenSCADA"><span class="tocnumber">2</span> <span class="toctext">Qt модули OpenSCADA</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.D0.9F.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B_OpenSCADA"><span class="tocnumber">3</span> <span class="toctext">Проекты OpenSCADA</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.D0.92.D0.B8.D0.B4_.D0.B8_.D0.BE.D1.89.D1.83.D1.89.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">4</span> <span class="toctext">Вид и ощущение</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.D0.9A.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F"><span class="tocnumber">5</span> <span class="toctext"><span>Конфигурация</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#API_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8F"><span class="tocnumber">6</span> <span class="toctext">API программирования пользователя</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id=".D0.92.D1.81.D1.82.D1.83.D0.BF.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"><span class="mw-headline-number">1</span> Вступление</span></h2>
<p>Изначально этот модуль создаёт отдельный поток для основного потока Qt, где есть возможность формирования экрана динамической заставки, поскольку основные задачи OpenSCADA продолжают исполнение в основном потоке. Однако версия Qt5 стала особенно чувствительной к исполнению в неглавном потоке, поэтому для неё в OpenSCADA добавлена такая возможность, но с обновлением сообщений в заставке из сервисного потока до и после момента переключения на исполнение ним первичных задач. Для контроля этой возможности предусмотрен параметр запуска <i>--QtInNotMainThread</i>, который включает исполнение в неглавном потоке, для Qt4, соответственно, по умолчанию, осуществляется исполнение в главном, что типично для Qt5.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:606px;"><a class="image" href="http://oscada.org/wiki/File:QTStarter_splash_ru.png"><img class="thumbimage" height="304" src="../files/QTStarter_splash_ru.png" width="604" /></a>  <div class="thumbcaption">Fig.1. Динамический экран заставки модуля.</div></div></div></div>
<p>Диалоговое окно пускателя (Рис.2) в общем предоставляет:
</p>
<ul><li> выбор присутствующих Qt GUI модулей, может отсутствовать в случае первичного запуска для выбора только проекта OpenSCADA;</li>
<li> выбор присутствующих OpenSCADA проектов для их выбора или переключения;</li>
<li> выход из OpenSCADA;</li>
<li> меню помощи с пунктами: "Про", "Про Qt", "Руководство QTStarter" (F1), "Руководство OpenSCADA 0.9" и "Что это" (Shift+F1).</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:472px;"><a class="image" href="http://oscada.org/wiki/File:QTStarter_dialog_ru.png"><img class="thumbimage" height="673" src="../files/QTStarter_dialog_ru.png" width="470" /></a>  <div class="thumbcaption">Рис.2. Диалоговое окно пускателя этого модуля.</div></div></div></div>
<p>В случае отсутствия диалогового окна запуска и всех окон модулей Qt GUI, программа может быть запущена или свёрнута в системный лоток (Рис.3), созданный этим модулем.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:386px;"><a class="image" href="http://oscada.org/wiki/File:QTStarter_systray_ru.png"><img class="thumbimage" height="181" src="../files/QTStarter_systray_ru.png" width="384" /></a>  <div class="thumbcaption">Рис.3. Проект "АГЛКС", запущенный или свёрнутый в системный лоток.</div></div></div></div> 
<p>Модулем осуществляется отключение функции сохранения сеанса программы при принудительном закрытии системой, для того чтобы предотвратить попытки восстановления этого сеанса при старте системы, поскольку OpenSCADA этого не нужно.
</p><p>Модулем предусматривается поддержка эмуляции правой клавиши мыши для окружений с сенсорным экраном, вроде Android, поскольку интерфейс часто предусматривает контроль исключительно с помощью контекстного меню. Эмуляция включается установкой параметра командной строки <i>--simulRightMKeyTm=&lt;tm&gt;</i>, при старте программы, где указывается время удержания (типично две секунды) нажатия левой клавиши мыши (или на экране) для генерации сообщения правой клавиши мыши и контекстной помощи. Эмуляция правой клавиши не выключает-откладывает первичных сообщений левой клавиши, соответственно её общие действия должны работать корректно, но возможны несоответствия в местах где первичное сообщение что-то переключает и эмулированное сообщение уже пойдёт не по адресу!
</p>
<h2><span class="mw-headline" id="Qt_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D0.B8_OpenSCADA"><span class="mw-headline-number">2</span> Qt модули OpenSCADA</span></h2>
<p>Для запуска Qt GUI модулей используется расширенный интерфейс вызова функций модулей. Данный интерфейс подразумевает экспортирование функций внешними модулями. В нашем случае Qt GUI модули должны экспортировать следующие функции:
</p>
<ul><li> <i>QIcon icon();</i> — передаёт объект иконки вызываемого модуля, для построения перечня.</li>
<li> <i>QMainWindow *openWindow();</i> — создаёт объект главного окна данного Qt GUI модуля и передаёт его пускателю. Может возвращать NULL в случае невозможности создания нового окна.</li></ul>
<p>Для идентификации, Qt GUI модуль должен определять информационный элемент модуля "SubType" как "Qt". Исходя из этого признака "Пускатель" с ним работает.
</p><p>После получения объекта главного окна "Пускатель" его просто отображает, а окно модуля может само дополнительно добавить элементы "Пускателя", в виде общего перечня Qt модулей OpenSCADA, для их вызова из этого окна. Общий перечень Qt модулей OpenSCADA может добавляться в меню или панель инструментов окна, путём вызова слота "makeStarterMenu(QWidget *mn = NULL)" класса QApplication от "Пускателя", где в <i>mn</i> указывается виджет контейнера действий (QAction), или меню главного окна, для NULL.
</p><p>Для указания Qt GUI модулей, которые запускаются при старте, модуль стартера содержит конфигурационное поле "StartMod". В этом поле записываются идентификаторы модулей, которые запускаются. Конфигурационное поле "StartMod" можно определить в конфигурационном файле, а также в системной таблице БД ("SYS") через диалог <a href="#Cfg">конфигурации модуля</a> (рис.4).
</p><p>В случае закрытия окон всех Qt GUI модулей или запуске без определения модуля для запуска в поле "StartMod", "Пускатель" создаёт собственное диалоговое окно (рис.2). Если поле "CloseToTray" конфигурационного файла или <a href="#Cfg">конфигурацией модуля</a> (рис.4) установлено то в этом случае осуществляется сворачивание программы в системный лоток (рис.3).
</p>
<h2><span class="mw-headline" id=".D0.9F.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B_OpenSCADA"><span class="mw-headline-number">3</span> Проекты OpenSCADA</span></h2>
<p>С интеграцией в OpenSCADA элементов менеджера проектов этот модуль получил функцию выбора существующих и создания новых проектов OpenSCADA, в списке проектов и команд проектов (рис.2). На данный момент предусмотрено два режима диалогового окна пускателя (рис.2), это — режим первичного-инициирующего запуска и режим исполнения выбранного проекта.
</p><p>Первичный-инициирующий режим, по факту, является режимом запуска без определённого проекта и предусматривает именно выбор проекта для переключения в другой режим, и соответственно прячет список Qt GUI модулей, даже если они загружены в инициирующую конфигурацию.
</p><p>В режиме исполнения проекта работают все типовые механизмы, а именно это вызов Qt GUI модулей и запуск-сворачивание в системный лоток, а диалоговое окно пускателя (рис.2) содержит перечень присутствующих Qt GUI модулей и информацию про запущенный проект, в заголовке окна.
</p><p>В перечне проектов пользователю (через контекстное меню) дополнительно предоставляется возможность удалить неисполняемые проекты, зарезервировать — создать резервную копию, и восстановить проекты из выбранной резервной копии.
</p><p>Кроме непосредственно названий проектов в перечне проектов, справа от названия, приведено их состояние — "текущий", "выполняется" и "{N} рез.копий". Состояние "текущий" означает, что осуществляется исполнение именно этого проекта. Состояние "исполняется" указывает на наличие файла блокирования множественного запуска, а соответственно и исполнения проекта, и отдельно от этого проекта если рядом не указано состояние "текущий". Выбрать и попробовать переключиться на проект в состоянии "исполняется" можно, приняв предупреждение, но если этот проект реально сейчас исполняется и наличие файла блокировки не является остаточным после аварийного завершения программы то программа, которая переключается, просто завершится! Состояние "{N} рез.копий" указывает на наличие указанного количества резервных копий проекта.
</p>
<h2><span class="mw-headline" id=".D0.92.D0.B8.D0.B4_.D0.B8_.D0.BE.D1.89.D1.83.D1.89.D0.B5.D0.BD.D0.B8.D0.B5"><span class="mw-headline-number">4</span> Вид и ощущение</span></h2>
<p>В связи с расширением границ использования OpenSCADA на мобильные программные платформы вроде Maemo, MeeGo, Android и частых случаев несоответствия вида программ на библиотеках Qt4 и Qt5 к современным окружениям рабочего стола, этот модуль был расширен собственным механизмом контроля вида и ощущений конечного визуального интерфейсу.
</p><p>В целом модуль сейчас предусматривает контроль за общим: стилем виджетов Qt, общим шрифтом, палитрой интерфейса и таблицами каскадных стилей. Этот контроль осуществляется через параметры конфигурационного файла "Style", "Font", "Palette", "StyleSheets" и <a href="#Cfg">конфигурацией модуля</a> (рис.4).
</p><p>Также, модулем предусмотрено оформление наработок отдельных видов и ощущений в библиотеке композитного характера, которая формируется в таблице конфигурационного файла со структурой: <b>LookFeel(<u>NAME</u>, FONT, STYLE, PALETTE, STL_SHTS)</b>.
</p><p>Т.е., для мобильных устройств или наперёд известных специфических окружений рабочего стола, нужный вид и ощущения можно предварительно устанавливать в конфигурационном файле пакетов программы, и для всех можно быстро изменить после установки, выбрав нужный из библиотеки.
</p>
<h2><span class="mw-headline" id=".D0.9A.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F"><span class="mw-headline-number">5</span> <span id="Cfg" title="#Cfg">Конфигурация</span></span></h2>
<p>Для конфигурации функций, которые приведены выше, модулем предоставляется возможность настройки их параметров посредством интерфейса управления OpenSCADA (Рис.4):
</p>
<ul><li> Секция "Опции модуля":
<ul><li> <i>Модули Qt для запуска</i>.</li>
<li> <i>Сворачивать или запускать в системный лоток</i>.</li></ul></li>
<li> Секция "Вид и ощущения", изменения тут не применяются сразу и требуют перегрузки:
<ul><li> <i>Известные профили</i> — комбобокс с перечнем профилей в библиотеке и перечень команд над текущим профилем:
<ul><li> "&lt;Очистить&gt;" — очистить текущий профиль;</li>
<li> "&lt;Прочитать назад&gt;" — прочитать профиль из текущих настроек Qt, только в очищенные элементы профиля.</li>
<li> "{Имя профиля}" — прочитать значение с указанного именем профиля и добавить-скомбинировать с текущим, если он не пустой.</li></ul></li>
<li> <i>Стиль виджетов</i> — поле профиля, предусматривает возможность выбора из перечня известных в этой конфигурации Qt и не является композитным.</li>
<li> <i>Общий шрифт</i> — общий шрифт Qt, который также определяет размер иконок.</li>
<li> <i>Палитра</i> — поле профиля цветов интерфейса в трёх группах по строкам: активная, выключенная, неактивная. И с двадцатью цветами в группе-строке, разделённые символом ',': WindowText(0), Button(1), Light(2), Midlight(3), Dark(4), Mid(5), Text(6), BrightText(7), ButtonText(8), Base(9), Window(10), Shadow(11), Highlight(12), HighlightedText(13), Link(14), LinkVisited(15), AlternateBase(16), NoRole(17), ToolTipBase(18), ToolTipText(19). Профиль допускает определение только нужных цветов, оставляя неопределённые пустыми, и именно это определяет композитность палитры, а именно — заполнение пустот другим профилем библиотеки.</li>
<li> <i>Страницы стилей</i> — поле профиля каскадных таблиц стилей (CSS), композитность которого заключается в добавлении CCS правил в конец текущего профиля.</li></ul></li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:699px;"><a class="image" href="http://oscada.org/wiki/File:QTStarter_cfg_ru.png"><img class="thumbimage" height="688" src="../files/QTStarter_cfg_ru.png" width="697" /></a>  <div class="thumbcaption">Рис.4. Страница конфигурации модуля.</div></div></div></div>
<h2><span class="mw-headline" id="API_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8F"><span class="mw-headline-number">6</span> API программирования пользователя</span></h2>
<p><b>Объект модуля (SYS.UI.QTStarter)</b>
</p>
<ul><li> <i>Array sensors()</i> — получить все доступные сенсоры от Qt mobility, возвращает "false" если не доступно ни одного сенсора.</li></ul>






</div><table style="border-top: dotted 2px #999999; margin-top: 20pt; color: gray;" width="100%"><tr><td style="text-align: left;" width="40%"><a href="http://oscada.org/wiki/Modules/QTStarter/ru">Modules/QTStarter/ru</a> - <a href="http://oscada.org/en/main/about-the-project/licenses/">GFDL</a></td><td style="text-align: center;">June 2022</td><td style="text-align: right;" width="40%">OpenSCADA 1+r2832</td></tr></table></body>
</html>