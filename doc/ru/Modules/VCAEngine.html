<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="UTF-8" />
<title>Модули/Движок Среды Визуализации и Управлений (СВУ) - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="../../en/files/doc.css" rel="stylesheet" /></head>
<body><div class="floatright"><a href="http://oscada.org"><img alt="OpenSCADA" src="../../en/files/Logo-big.png" /></a></div><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="ru">Модули/Движок Среды Визуализации и Управлений (СВУ)</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="ru"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a class="external text" href="http://oscada.org/wiki/index.php?title=Special:Translate&amp;group=page-Modules%2FVCAEngine&amp;action=page&amp;filter=&amp;language=ru" rel="nofollow noreferrer noopener" target="_blank">translated version</a></span> of the page <a class="external" href="http://oscada.org/wiki/Modules/VCAEngine" title="Modules/VCAEngine">Modules/VCAEngine</a> and the translation is 100% complete.</div><hr /><div class="mw-pt-languages" dir="ltr" lang="en"><div class="mw-pt-languages-list autonym"><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" href="../../en/Modules/VCAEngine.html" title="Modules/VCAEngine (100% translated)">English</a>&nbsp;• ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">российский</span>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="../../uk/Modules/VCAEngine.html" title="Модулі/Рушій Середовища Візуалізації та Управління (СВУ) (100% translated)">українська</a></div></div>
<table class="wikitable">

<tr>
<th> Модуль </th>
<th> Имя </th>
<th> Версия </th>
<th> Лицензия </th>
<th> Источник </th>
<th> Языки </th>
<th> Платформы </th>
<th> Тип </th>
<th> Автор
</th></tr>

<tr>
<td> <a href="../Modules/VCAEngine.html" title="Special:MyLanguage/Modules/VCAEngine">VCAEngine</a> </td>
<td> Движок Среды Визуализации и Управления
</td>
<td> 6.9 </td>
<td> GPL2 </td>
<td> ui_VCAEngine.so </td>
<td> en,uk,ru,de </td>
<td> x86,x86_64,ARM
</td>
<td> UI </td>
<td> Роман Савоченко
</td></tr>
<tr>
<th colspan="9"> Описание
</th></tr>
<tr>
<td colspan="9"> Общий движок среды визуализации и управления.
<ul><li> <b>Сделать (To Do):</b></li></ul>
<dl><dd> - дополнить пользовательское API редактирования файлов растром (PNG, JPEG, GIF), посредством LibGD2, и векторно (SVG):
<dl><dd>+ дополнить загрузкой и сохранением изменений изображений в таблице сеанса и из процедур пользователя, позволяет редактировать SVG (XML);</dd>
<dd>- реализовать основные функции объекта GD (в <a href="../Modules/FLibSYS.html" title="Special:MyLanguage/Modules/FLibSYS">Special.FLibSYS</a>).</dd></dl></dd>
<dd> ... <i>также для <a href="../Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">Vision</a></i> ...</dd>
<dd> - перенести запросы времени исполнения к VCAEngine в асинхроный режим;
<dl><dd>&nbsp;!&gt; имеет проблему с обработкой рекурсивных сообщений в event(), для случая потери сообщений отпускания мыши при обработке сообщений нажатия мыши.</dd></dl></dd>
<dd> - реализовать фоновое исполнение редактируемых страниц в режиме разработки, для визуального формирования диаграмм совместно с <a href="../Modules/BlockCalc.html" title="Special:MyLanguage/Modules/BlockCalc">BlockCalc</a> и DAQ-источниками в целом.</dd>
<dd> ... <i>также для <a href="../Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">Vision</a> и <a href="../Modules/WebVision.html" title="Special:MyLanguage/Modules/WebVision">WebVision</a></i> ...</dd>
<dd> - добавить глобальное меню пространства пользователя с помощью специфических к проекту свойств;</dd>
<dd> - разработать формирование блочных диаграмм (динамическими кадрами) из графического интерфейса.</dd></dl>
</td></tr></table>
<p>Модуль предоставляет в OpenSCADA движок среды визуализации и управления (СВУ). Сам модуль не реализует визуализации СВУ, а содержит данные в соответствии с концепцией "Модель/данные – Интерфейс". Визуализация данных этого модуля выполняется модулями визуализации СВУ, например, модулем <a href="../Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">Vision</a> и <a href="../Modules/WebVision.html" title="Special:MyLanguage/Modules/WebVision">WebVision</a>.
</p><p>Среда визуализации и управления (СВУ) является неотъемлемой составляющей SCADA системы. Она применяется на клиентских станциях с целью доступного предоставления информации об объекте управления и выдачи управляющих воздействий на объект. В различных практических ситуациях и условиях могут применяться СВУ, построенные на различных принципах визуализации. Например, это могут быть библиотеки виджетов Qt, GTK+, wxWidgets или гипертекстовые механизмы на основе технологий HTML, XHTML, XML, CSS и JavaScript или сторонние приложения визуализации, реализованные на различных языках программирования Java, Python и т.д. Любой из этих принципов имеет свои преимущества и недостатки, комбинация которых может стать непреодолимым препятствием в возможности использования СВУ в том или ином практическом случае. Например, технологии вроде библиотеки Qt позволяют создавать высокопроизводительные СВУ, что несомненно важно для станций оператора управления технологическим процессом (ТП). Однако, необходимость инсталляции данного клиентского ПО может сделать его использование невозможным в отдельных ситуациях. С другой стороны, Web-технологии не требуют инсталляции на клиентские системы и являются предельно многоплатформенными (достаточно указать ссылку на Web-сервер в любом Web-браузере), что наиболее важно для различных инженерных и административных станций. С другой стороны, производительность и надёжность таких интерфейсов ниже, что практически исключает их использование на станциях оператора ТП.
</p><p>OpenSCADA имеет предельно гибкую архитектуру, которая позволяет создавать внешние интерфейсы, в том числе и пользовательские, на любой основе и вкус. Например, среда конфигурации OpenSCADA доступна как на Qt-библиотеке, так и на Web-основе.
</p><p>В тоже время, независимое создание реализаций СВУ на различной основе может повлечь за собой невозможность использования данных конфигурации одной СВУ в другой. Что неудобно и ограничено с пользовательской стороны, а также накладно в плане реализации и последующей поддержки.
</p><p>С целью избежания этих проблем, а также создания в кратчайшие сроки полного спектра различных типов СВУ, основан <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Sub-projects/VCA" title="Special:MyLanguage/Sub-projects/VCA">проект создания концепции СВУ</a>. Результатом этого проекта стал данный модуль движка(модели данных) СВУ, а также модули непосредственной визуализации <a href="../Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">Vision</a> и <a href="../Modules/WebVision.html" title="Special:MyLanguage/Modules/WebVision">WebVision</a>.
</p>
<div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.9D.D0.B0.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Назначение</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.D0.9A.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8_.D1.84.D0.BE.D1.80.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D0.BE.D0.B2_.D0.A1.D0.92.D0.A3"><span class="tocnumber">2</span> <span class="toctext">Конфигурация и формирование интерфейсов СВУ</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.D0.90.D1.80.D1.85.D0.B8.D1.82.D0.B5.D0.BA.D1.82.D1.83.D1.80.D0.B0"><span class="tocnumber">3</span> <span class="toctext">Архитектура</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#.D0.9A.D0.B0.D0.B4.D1.80.D1.8B_.D0.B8_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D1.8B_.D0.BE.D1.82.D0.BE.D0.B1.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F_.28.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D1.8B.29"><span class="tocnumber">3.1</span> <span class="toctext">Кадры и элементы отображения (виджеты)</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#.D0.9F.D1.80.D0.BE.D0.B5.D0.BA.D1.82"><span class="tocnumber">3.2</span> <span class="toctext"><span>Проект</span></span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#.D0.A1.D0.B5.D0.B0.D0.BD.D1.81_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.B0"><span class="tocnumber">3.3</span> <span class="toctext">Сеанс исполнения проекта</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#.D0.A1.D1.82.D0.B8.D0.BB.D0.B8"><span class="tocnumber">3.4</span> <span class="toctext">Стили</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#.D0.A1.D0.BE.D0.B1.D1.8B.D1.82.D0.B8.D1.8F.2C_.D0.B8.D1.85_.D0.BE.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B0_.D0.B8_.D0.BA.D0.B0.D1.80.D1.82.D1.8B_.D1.81.D0.BE.D0.B1.D1.8B.D1.82.D0.B8.D0.B9"><span class="tocnumber">3.5</span> <span class="toctext">События, их обработка и карты событий</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#.D0.A1.D0.B8.D0.B3.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F"><span class="tocnumber">3.6</span> <span class="toctext"><span>Сигнализация</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#.D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B0.D0.BC.D0.B8"><span class="tocnumber">3.7</span> <span class="toctext">Управление правами</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#.D0.A1.D0.B2.D1.8F.D0.B7.D1.8B.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81_.D0.B4.D0.B8.D0.BD.D0.B0.D0.BC.D0.B8.D0.BA.D0.BE.D0.B9"><span class="tocnumber">3.8</span> <span class="toctext">Связывание с динамикой</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#.D0.9F.D1.80.D0.B8.D0.BC.D0.B8.D1.82.D0.B8.D0.B2.D1.8B_.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.BE.D0.B2"><span class="tocnumber">3.9</span> <span class="toctext"><span>Примитивы виджетов</span></span></a>
<ul>
<li class="toclevel-3"><a href="#.D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.B0.D1.80.D0.BD.D0.B0.D1.8F_.D0.B3.D1.80.D0.B0.D1.84.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0_.28ElFigure.29"><span class="tocnumber">3.9.1</span> <span class="toctext"><span>Элементарная графическая фигура (ElFigure)</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D1.84.D0.BE.D1.80.D0.BC.D1.8B_.28FormEl.29"><span class="tocnumber">3.9.2</span> <span class="toctext"><span>Элемент формы (FormEl)</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D1.82.D0.B5.D0.BA.D1.81.D1.82.D0.B0_.28Text.29"><span class="tocnumber">3.9.3</span> <span class="toctext"><span>Элемент текста (Text)</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D0.BE.D1.82.D0.BE.D0.B1.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BC.D0.B5.D0.B4.D0.B8.D0.B0-.D0.BC.D0.B0.D1.82.D0.B5.D1.80.D0.B8.D0.B0.D0.BB.D0.BE.D0.B2_.28Media.29"><span class="tocnumber">3.9.4</span> <span class="toctext"><span>Элемент отображения медиа-материалов (Media)</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D0.BF.D0.BE.D1.81.D1.82.D1.80.D0.BE.D0.B5.D0.BD.D0.B8.D1.8F_.D0.B4.D0.B8.D0.B0.D0.B3.D1.80.D0.B0.D0.BC.D0.BC_.28Diagram.29"><span class="tocnumber">3.9.5</span> <span class="toctext"><span>Элемент построения диаграмм (Diagram)</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D0.BF.D0.BE.D1.81.D1.82.D1.80.D0.BE.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D1.80.D0.BE.D1.82.D0.BE.D0.BA.D0.BE.D0.BB.D0.BE.D0.B2_.D0.BD.D0.B0_.D0.BE.D1.81.D0.BD.D0.BE.D0.B2.D0.B5_.D0.B0.D1.80.D1.85.D0.B8.D0.B2.D0.BE.D0.B2_.D1.81.D0.BE.D0.BE.D0.B1.D1.89.D0.B5.D0.BD.D0.B8.D0.B9_.28Protocol.29"><span class="tocnumber">3.9.6</span> <span class="toctext"><span>Элемент построения протоколов на основе архивов сообщений (Protocol)</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D1.84.D0.BE.D1.80.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BE.D1.82.D1.87.D1.91.D1.82.D0.BD.D0.BE.D0.B9_.D0.B4.D0.BE.D0.BA.D1.83.D0.BC.D0.B5.D0.BD.D1.82.D0.B0.D1.86.D0.B8.D0.B8_.28Document.29"><span class="tocnumber">3.9.7</span> <span class="toctext"><span>Элемент формирования отчётной документации (Document)</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.9A.D0.BE.D0.BD.D1.82.D0.B5.D0.B9.D0.BD.D0.B5.D1.80_.28Box.29"><span class="tocnumber">3.9.8</span> <span class="toctext"><span>Контейнер (Box)</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-13"><a href="#.D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.91.D0.94_.D0.B4.D0.BB.D1.8F_.D1.85.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F_.D0.B1.D0.B8.D0.B1.D0.BB.D0.B8.D0.BE.D1.82.D0.B5.D0.BA_.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.BE.D0.B2_.D0.B8_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"><span class="tocnumber">3.10</span> <span class="toctext">Использование БД для хранения библиотек виджетов и проектов</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#API_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.B8_.D1.81.D0.B5.D1.80.D0.B2.D0.B8.D1.81.D0.BD.D1.8B.D0.B5_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D1.8B_OpenSCADA"><span class="tocnumber">3.11</span> <span class="toctext"><span>API пользовательского программирования и сервисные интерфейсы OpenSCADA</span></span></a>
<ul>
<li class="toclevel-3"><a href="#API_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F"><span class="tocnumber">3.11.1</span> <span class="toctext"><span>API пользовательского программирования</span></span></a></li>
<li class="toclevel-3"><a href="#.D0.A1.D0.B5.D1.80.D0.B2.D0.B8.D1.81.D0.BD.D1.8B.D0.B5_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D1.8B_OpenSCADA"><span class="tocnumber">3.11.2</span> <span class="toctext">Сервисные интерфейсы OpenSCADA</span></a>
<ul>
<li class="toclevel-4"><a href="#.D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC_.D0.B0.D1.82.D1.80.D0.B8.D0.B1.D1.83.D1.82.D0.BE.D0.B2_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.BE.D0.B2_.D0.B2.D0.B8.D0.B7.D1.83.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8_.28.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D1.8B.29"><span class="tocnumber">3.11.2.1</span> <span class="toctext">Доступ к значениям атрибутов элементов визуализации (виджеты)</span></a></li>
<li class="toclevel-4"><a href="#.D0.93.D1.80.D1.83.D0.BF.D0.BF.D0.BE.D0.B2.D0.BE.D0.B9_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC_.D0.B0.D1.82.D1.80.D0.B8.D0.B1.D1.83.D1.82.D0.BE.D0.B2_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.BE.D0.B2_.D0.B2.D0.B8.D0.B7.D1.83.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8_.28.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.B0.D0.BC.29"><span class="tocnumber">3.11.2.2</span> <span class="toctext">Групповой доступ к значениям атрибутов элементов визуализации (виджетам)</span></a></li>
<li class="toclevel-4"><a href="#.D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D0.B0.D0.BC_.D1.81.D0.B5.D0.B0.D0.BD.D1.81.D0.B0"><span class="tocnumber">3.11.2.3</span> <span class="toctext">Доступ к страницам сеанса</span></a></li>
<li class="toclevel-4"><a href="#.D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.B8.D0.B3.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B5.D0.B9"><span class="tocnumber">3.11.2.4</span> <span class="toctext">Управление сигнализацией</span></a></li>
<li class="toclevel-4"><a href="#.D0.9C.D0.B0.D0.BD.D0.B8.D0.BF.D1.83.D0.BB.D1.8F.D1.86.D0.B8.D1.8F_.D1.81.D0.B5.D0.B0.D0.BD.D1.81.D0.B0.D0.BC.D0.B8_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"><span class="tocnumber">3.11.2.5</span> <span class="toctext">Манипуляция сеансами проектов</span></a></li>
<li class="toclevel-4"><a href="#.D0.93.D1.80.D1.83.D0.BF.D0.BF.D0.BE.D0.B2.D0.BE.D0.B9_.D0.B7.D0.B0.D0.BF.D1.80.D0.BE.D1.81_.D0.B4.D0.B5.D1.80.D0.B5.D0.B2.D0.B0_.D0.B1.D0.B8.D0.B1.D0.BB.D0.B8.D0.BE.D1.82.D0.B5.D0.BA_.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.BE.D0.B2"><span class="tocnumber">3.11.2.6</span> <span class="toctext">Групповой запрос дерева библиотек виджетов</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#.D0.9A.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D1.8F_.D0.BF.D0.BE.D1.81.D1.80.D0.B5.D0.B4.D1.81.D1.82.D0.B2.D0.BE.D0.BC_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D0.B0_.D1.83.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F_OpenSCADA"><span class="tocnumber">4</span> <span class="toctext">Конфигурация модуля посредством интерфейса управления OpenSCADA</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id=".D0.9D.D0.B0.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D0.B5"><span class="mw-headline-number">1</span> Назначение</span></h2>
<p>Данный модуль движка(модели данных) СВУ предназначен для формирования логической структуры СВУ и исполнения сеансов отдельных экземпляров проектов СВУ. Также, модуль предоставляет конечным визуализаторам СВУ все необходимые данные, как посредством локальных механизмов взаимодействия OpenSCADA, так и интерфейса управления OpenSCADA, для удалённого доступа.
</p><p>Финальная версия этого модуля СВУ обеспечит:
</p><p>Перечислим возможности, которые сможет и обеспечивает СВУ, построенная на основе данного проекта:
</p>
<ul><li> три уровня сложности в формировании интерфейса визуализации, позволяющие органично осваивать и применять инструментарий по принципу — от простого к сложному:</li></ul>
<dl><dd><ol><li> формирование из шаблонных кадров, путём назначения динамики и без графической конфигурации;</li>
<li> графическое формирование новых кадров, путём использования готовых элементов визуализации из библиотеки — мнемосхемы;</li>
<li> формирование, в библиотеке, новых: кадров, шаблонных кадров и элементов отображения.</li></ol></dd></dl>
<ul><li> построение интерфейсов визуализации практически любой сложности (ограниченную "дискретностью" функций примитивов), начиная от простых интерфейсов мониторинга и, заканчивая полноценными иерархическими интерфейсами, используемыми в SCADA системах;</li>
<li> предоставление различных способов формирования и конфигурации пользовательского интерфейса, основанных на различных интерфейсах графического представления (Qt, Web, ...), или-же посредством стандартного интерфейса управления OpenSCADA;</li>
<li> построение и коррекция интерфейса, установка и смена динамики в процессе исполнения;</li>
<li> построение, на уровне пользователя, новых шаблонных кадров и формирование специализированных, под область применения, библиотек кадров (например, включение кадров параметров, графиков и других элементов с увязкой их друг с другом), согласно идее вторичного использования, накопления и совершенствования;</li>
<li> построение новых пользовательских элементов визуализации и формирование специализированных, под область применения, библиотек кадров, согласно идее вторичного использования, накопления и совершенствования;</li>
<li> описание логики новых шаблонных кадров и пользовательских элементов визуализации как простыми связями, так и лаконичным, полноценным языком пользовательского программирования;</li>
<li> возможность включение, в пользовательские элементы визуализации, функций (или кадров вычисления функций) объектной модели OpenSCADA, практически связывая представление с алгоритмом вычисления; например, визуализируя библиотеку моделей аппаратов ТП, для последующего визуального построения моделей ТП;</li>
<li> разделение данных пользовательских интерфейсов и интерфейсов представления этих данных, позволяющее строить интерфейс пользователя в одной среде, а исполнять во многих других (Qt, Web, ...);</li>
<li> возможность подключения к исполняющемуся интерфейсу для наблюдения и коррекции действий; например, при обучении операторов и контроля за его действиями в реальном времени;</li>
<li> визуальное построение различных схем с наложением логических связей и последующим централизованным исполнением в фоне — визуальное построение и исполнение математических моделей, логических схем, релейных схем и иного;</li>
<li> предоставление, в OpenSCADA, функций объектного API; может использоваться для управления свойствами интерфейса визуализации из пользовательских процедур;</li>
<li> построение серверов для: кадров, элементов визуализации и проектов интерфейсов визуализации; с возможностью обслуживания множественных клиентских соединений;</li>
<li> простая организация клиентских станций на различной основе (Qt, Web, ...), с подключением к центральному серверу;</li>
<li> полноценный механизм разделения полномочий между пользователями, позволяющий создавать и исполнять проекты с различными правами доступа к его компонентам;</li>
<li> гибкое формирование правил сигнализаций и уведомления, с учётом и поддержкой различных способов уведомления;</li>
<li> поддержка пользовательского формирования палитры и шрифтовых предпочтений интерфейса визуализации, в стилях;</li>
<li> поддержка пользовательского формирования карт событий под различное оборудование управления и пользовательские предпочтения;</li>
<li> поддержка профилей пользователей, позволяющая определять различные свойства интерфейса визуализации (цветовая гамма, шрифтовые особенности, предпочтительные карты событий);</li>
<li> гибкое хранение и распространение библиотек виджетов, кадров и проектов интерфейсов визуализации в БД, поддерживаемых OpenSCADA; практически, пользователю нужно только зарегистрировать полученную БД с данными.</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id=".D0.9A.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8_.D1.84.D0.BE.D1.80.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D0.BE.D0.B2_.D0.A1.D0.92.D0.A3"><span class="mw-headline-number">2</span> Конфигурация и формирование интерфейсов СВУ</span></h2>
<p>Сам модуль не содержит механизмов визуального формирования интерфейсов СВУ, такие инструменты могут предоставляться модулями конечной визуализации СВУ, например, он предоставляется модулем <a href="../Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">Vision</a>.
</p><p>Хотя визуальных механизмов формирования СВУ модулем не предоставляется, для управления логической структурой предоставляется механизм, реализованный на основе интерфейса управления OpenSCADA, а значит, доступный для использования в любом конфигураторе OpenSCADA. Диалоги этого интерфейса рассмотрены далее, в контексте рассмотрения архитектуры модуля и его данных.
</p>
<h2><span class="mw-headline" id=".D0.90.D1.80.D1.85.D0.B8.D1.82.D0.B5.D0.BA.D1.82.D1.83.D1.80.D0.B0"><span class="mw-headline-number">3</span> Архитектура</span></h2>
<p>СВУ, в целом, может работать в двух режимах — разработки и исполнения. В режиме разработки формируется интерфейс СВУ и его компоненты, определяются механизмы взаимодействия. В режиме исполнения выполняется формирование интерфейса СВУ и производится взаимодействие с конечным пользователем, на основе разработанных СВУ.
</p><p>Интерфейс СВУ формируется из кадров, каждый из которых, в свою очередь, формируется из элементов примитивов или пользовательских элементов интерфейса. При этом, пользовательские элементы интерфейса также формируются из примитивов или других пользовательских элементов. Таким образом обеспечивается иерархичность и повторное использования уже разработанных компонентов.
</p><p>Кадры и пользовательские элементы размещаются в библиотеках виджетов. Из элементов этих библиотек формируются проекты интерфейсов конечной визуализации СВУ. На основе-же этих проектов формируются сеансы визуализации.
</p><p>Описанная структура СВУ приведена на рисунке.
</p>
<div class="center"><div class="floatnone"><a class="image" href="http://oscada.org/wiki/File:VCA_struct_ru.png"><img alt="VCA struct ru.png" height="976" src="../files/VCA_struct_ru.png" width="855" /></a></div></div>
<p>Данная архитектура СВУ позволяет реализовать поддержку трёх уровней сложности у процесса разработки интерфейсов управления:
</p>
<ul><li> Формирования интерфейса визуализации и управления (ВУ) с помощью библиотеки шаблонных кадров, путём помещения шаблонов кадров в проект и назначения динамики.</li>
<li> В дополнении к первому уровню производится формирование собственных кадров на основе библиотеки производных и базовых виджетов. Возможно как прямое назначение динамики в виджете, так и последующее её назначение в проекте.</li>
<li> В дополнении ко второму уровню производится самостоятельное формирование производных виджетов, новых шаблонных кадров, а также кадров с использованием механизма описания логики взаимодействия и обработки событий на языке пользовательского программирования OpenSCADA.</li></ul>
<p><br />
</p>
<h3><span class="mw-headline" id=".D0.9A.D0.B0.D0.B4.D1.80.D1.8B_.D0.B8_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D1.8B_.D0.BE.D1.82.D0.BE.D0.B1.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F_.28.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D1.8B.29"><span class="mw-headline-number">3.1</span> Кадры и элементы отображения (виджеты)</span></h3>
<p>Кадр это окно, непосредственно предоставляющее информацию пользователю в графической и/или текстовой форме. Группа взаимосвязанных кадров формирует цельный пользовательский интерфейс ВУ.
</p><p>Содержимое кадра формируется из элементов отображения (виджетов). Виджеты могут быть базовыми примитивами (различные элементарные фигуры, текст, тренд и т.д.) и производными, сформированные из базовых или других производных виджетов. Все виджеты группируются по библиотекам. В процессе работы, пользователь может формировать собственные библиотеки производных виджетов.
</p><p>Собственно сам кадр также является виджетом, который используется в роли конечного элемента визуализации. А это значит, что библиотеки виджетов могут хранить и заготовки кадров, и шаблоны результирующих страниц пользовательского интерфейса.
</p><p>Кадры и виджеты являются пассивными элементами, которые обычно не содержат связей с динамикой и другими кадрами, а только предоставляют информацию о свойствах и характере динамики(конфигурации), подключаемой к свойствам. Активированные кадры, содержащие ссылки на динамику и активные связи, формируют пользовательский интерфейс и хранятся в проектах. В некоторых случаях возможно прямое назначение динамики в заготовках кадров.
</p><p>Производные кадры/виджеты могут содержать вложенные виджеты, которые могут быть склеены-связаны один с другим логикой, с помощью языка пользовательского программирования OpenSCADA.
</p>
<div class="center"><div class="floatnone"><a class="image" href="http://oscada.org/wiki/File:VCA_widget_ru.png"><img alt="VCA widget ru.png" height="585" src="../files/VCA_widget_ru.png" width="800" /></a></div></div>
<p>Виджет является элементом, посредством которого обеспечивается:
</p>
<ul><li> визуализация оперативной и архивной информации ведения ТП;</li>
<li> сигнализация про нарушения ведения ТП;</li>
<li> переключение между кадрами ТП;</li>
<li> управление технологическим оборудованием и параметрами ведения ТП.</li></ul>
<p>Настройка и связывание виджетов производится посредством их свойств. Родительский виджет, и виджеты содержащиеся в нем, могут дополняться пользовательскими свойствами. В последствии, пользовательские и статические атрибуты связываются со свойствами вложенных виджетов, посредством внутренней логики. Для отображения динамики (текущих и архивных данных) свойства виджетов динамизируются, т.е связываются с атрибутами параметров OpenSCADA или свойствами других виджетов. Использование, для связывания вложенных виджетов внутренней логикой, языка пользовательского программирования OpenSCADA снимает вопрос реализации сложной логики визуализации, обеспечивая тем самым высокую гибкость. Практически, можно создавать полностью динамизированные кадры со сложными взаимосвязями на уровне пользователя.
</p><p><br />
</p>
<h3><span class="mw-headline" id=".D0.9F.D1.80.D0.BE.D0.B5.D0.BA.D1.82"><span class="mw-headline-number">3.2</span> <span id="Project" title="#Project">Проект</span></span></h3>
<p>Непосредственная конфигурация, и свойства конечного интерфейса визуализации, содержатся в проекте интерфейса визуализации СВУ, которых может быть создано множество.
</p><p>Каждый проект включает страницы из библиотек кадров-виджетов. В ряде режимов, сама страница может включать в себя вложенные страницы как независимые от родительской, так и с использованием родительского в роли шаблона. Шаблонные страницы-виджеты позволяют предельно упростить процесс создания однотипных кадров простого мониторинга, инженером АСУ ТП или пользователем OpenSCADA. Примером таких однотипных кадров могут быть: группы контуров, группы графиков, протоколы и различные сводные таблицы. Мнемосхемы технологических процессов редко подпадают под такую схему и формируются в отдельной странице-виджете.
</p><p>Страница, как и виджет на котором она основана, предоставляет возможность привязки динамики к описанным в ней свойствам — связи, которые могут быть установлены динамикой или константами. Кроме того, связывание непосредственно на уровне страницы проекта является предпочтительным, чем осуществление этого на уровне виджетов библиотек.
</p><p>Пример иерархического представления компонентов проекта классического интерфейса ВУ технологического процесса, с описанием выражений стандартных вызовов, приведен на рисунке.
</p>
<div class="center"><div class="floatnone"><a class="image" href="http://oscada.org/wiki/File:VCA_prog_tree_ru.png"><img alt="VCA prog tree ru.png" height="681" src="../files/VCA_prog_tree_ru.png" width="437" /></a></div></div>
<p>Предусмотрены следующие специальные свойства страниц:
</p>
<ul><li> <i>Контейнер</i> — страница является контейнером вложенных страниц.</li>
<li> <i>Шаблон</i> — страница является шаблоном вложенных страниц.</li>
<li> <i>Пусто</i> — пустая и неактивная страница. Это свойство используется совместно со свойством <i>Контейнер</i>, для организации логических контейнеров страниц.</li>
<li> <i>Связь</i> — связь на другую страницу ка контейнер под-страниц, которые будут использоваться на стороне исполнения проектов (сеансов) без их отдельного создания. </li></ul>
<p>На комбинациях вышеуказанных специальных свойств страниц реализованы следующие их типы:
</p>
<ul><li> <i>Стандарт</i> — стандартная страница (не установлено ни одно из свойств), является полноценной конечной страницей.</li>
<li> <i>Контейнер</i> — полноценная страница со свойством контейнера (<i>Контейнер</i>).</li>
<li> <i>Логический контейнер</i> — логический контейнер, фактически сам не являющийся страницей (<i>Контейнер</i>|<i>Пусто</i>), выполняет роль промежуточного и группирующего элемента в дереве страниц.</li>
<li> <i>Шаблон</i> — страница-шаблон (<i>Шаблон</i>). Чистая шаблонная страница, используется для описания общих свойств и доопределения их во вложенных страницах, в частном порядке.</li>
<li> <i>Контейнер и шаблон</i> — страница шаблон и контейнер (<i>Шаблон</i>|<i>Контейнер</i>), совмещает функции шаблона и контейнера.</li>
<li> <i>Связь</i> — связь на другую страницу. Связи могут быть использованы на полностью динамических и высоко тиражируемых страницах, для оптимизации использования памяти. Для разделения открытия связанных страниц Вы должны использовать атрибут "path". Функция uiCmd() <a href="#UserAPI">пользовательского API</a> должна использоваться для управления страницами этого типа вместо прямой записи в атрибуты страниц "pgOpen" и "pgOpenSrc".</li></ul>
<p>На стороне визуализации (RunTime) построена логика, регулирующая каким образом открывать страницы, на основе следующих атрибутов базового элемента "Box":
</p>
<ul><li> <i>pgOpen</i> — признак "Страница открыта";</li>
<li> <i>pgNoOpenProc</i> — признак "Исполнять страницу даже если она не открыта";</li>
<li> <i>pgOpenSrc</i> — содержит адрес виджета, или страницы, открывшей текущую страницу; в случае вложенного контейнерного виджета здесь содержится адрес включаемой страницы; для открытия страницы из скрипта достаточно здесь указать адрес виджета-источника открытия, но для страниц типа "Связь" Вы должны отдавать предпочтение использованию функции uiCmd() <a href="#UserAPI">пользовательского API</a>, для управления страницами;</li>
<li> <i>pgGrp</i> — группа страниц, используется для связки контейнеров страниц со страницами, согласно общей группы.</li></ul>
<p>Логика определения способа открытия страниц работает следующим образом:
</p>
<ul><li> если страница имеет группу "main" или совпадает с группой страницы в главном окне или нет страницы на главном окне, то открывать страницу в главном окне;</li>
<li> если страница имеет группу, которая совпадает с группой одного из контейнеров текущей страницы, то открыть в этом контейнере;</li>
<li> если источник открытия страницы совпадает с текущей страницей, то открыть в виде дополнительного окна над текущей страницей;</li>
<li> передать вызов на запрос открытия дополнительным окнам, с обработкой у каждого по первым трем пунктам;</li>
<li> если никто из родственных окон не открыл новую страницу то открыть её как родственное окно главного окна.</li></ul>
<p><br />
</p>
<h3><span class="mw-headline" id=".D0.A1.D0.B5.D0.B0.D0.BD.D1.81_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.B0"><span class="mw-headline-number">3.3</span> Сеанс исполнения проекта</span></h3>
<p>Сеанс проекта это развёрнутое дерево проекта непосредственного его исполнения, включающего отдельную задачу иерархического исполнения процедур виджетов. Для каждого проекта может быть открыто множество сеансов. Формирование конечного интерфейса визуализации осуществляется визуализаторами, исходя из данных сеанса проекта, после создания сеанса по запросу.
</p><p>Между виджетами, на различных уровнях иерархии, в конечном счёте выстраиваются достаточно сложные наследственные связи, которые определяются возможностью использования одних виджетов другими, начиная с библиотечного виджета и заканчивая виджетом сеанса. Для разъяснения этих особенностей взаимодействия, на рисунке изображена исчерпывающая карта "использующего" наследования.
</p>
<div class="center"><div class="floatnone"><a class="image" href="http://oscada.org/wiki/File:VCA_map_inher_ru.png"><img alt="VCA map inher ru.png" height="1083" src="../files/VCA_map_inher_ru.png" width="794" /></a></div></div>
<p>На уровне сеансов, виджет содержит объект значений процедуры обсчёта. Этот объект инициируется и используется в случае наличия самой процедуры вычисления. В момент инициализации создаётся перечень параметров процедуры и выполняется её компиляция с этими параметрами, в модуле, реализующем выбранный язык программирования и с названием результирующей процедуры в виде закодированного полного имени виджета. Скомпилированная функция подключается к объекту значений процедуры обсчёта, а далее выполняется её вычисление с периодом сеанса.
</p><p>Вычисление и обработка виджета выполняется в следующей последовательности:
</p>
<ul><li> выбираются события, доступные на момент вычисления, из атрибута "event" виджета;</li>
<li> события загружаются в параметр "event" объекта вычисления; </li>
<li> в объект вычисления загружаются значения по входным связям; </li>
<li> в объект вычисления загружаются значения специальных переменных (f_frq, f_start и f_stop); </li>
<li> в объект вычисления загружаются значения выбранных параметров виджета; </li>
<li> вычисление; </li>
<li> выгрузка значений объекта вычисления в выбранные параметры виджета; </li>
<li> выгрузка событий из параметра "event" объекта вычисления;</li>
<li> обработка событий и передача необработанных на уровень выше.</li></ul>
<p>Объекты сеанса наследуются от абстрактного объекта "Widget" и используют соответствующие объекты проекта. Так, сеанс "Session" использует проект "Project" и формирует на основе него развёрнутое дерево. Страница проекта "Page" прямо используется страницей сеанса "SessPage". Остальные объекты "SessWdg" разворачиваются в соответствии с иерархией элементов страницы.
</p><p>В дополнение к стандартным свойствам абстрактного виджета "Widget", элементы страницы и сами страницы сеанса получают свойства: хранения объекта значений вычислительной процедуры, обсчёта процедур и механизм обработки событий. Страницы сеанса, в дополнение ко всему, содержат контейнер следующих по иерархии страниц. Сеанс, в целом, вычисляется с указанной периодичностью и в последовательности: 
</p>
<ul><li> "Страница верхнего уровня" -&gt; "Страница нижнего уровня"</li>
<li> "Виджет нижнего уровня" -&gt; "Виджет верхнего уровня"</li></ul>
<p>Такая политика позволяет обходить страницы в соответствии с их иерархией, а событиям в виджетах "всплывать" на верх за одну итерацию.
</p><p>Сеансы поддерживают многоязычность на уровне <a href="../../en/API.html#CntrNode" title="Special:MyLanguage/Documents/API">интерфейса управления OpenSCADA</a>, которая зависит от значения общих атрибутов "lang" и "user", и которые визуализатор может устанавливать в соответствии со своим языком. Эта функция включается <a href="../Program_manual.html#Config" title="Special:MyLanguage/Documents/Program manual">динамическим переводом сообщений OpenSCADA</a>.
</p><p><br />
</p>
<h3><span class="mw-headline" id=".D0.A1.D1.82.D0.B8.D0.BB.D0.B8"><span class="mw-headline-number">3.4</span> Стили</span></h3>
<p>Известно, что человек может иметь индивидуальные особенности восприятия графической информации. Если эти особенности не учитывать то можно получить неприятие и отторжение пользователя к интерфейсу ВУ. Такое неприятие и отторжение может привести к фатальным ошибкам при управлении ТП, а также травмировать человека постоянной работой с интерфейсом. В SCADA системах приняты соглашения, которые регламентируют требования по созданию унифицированного интерфейса ВУ, нормально воспринимаемого большинством людей. При этом, практически отсутствует учёт особенностей людей с некоторыми отклонениями.
</p><p>С целью учесть это обстоятельство, и предоставить возможность централизованно и просто изменять визуальные свойства интерфейса, проектом реализуется менеджер стилей интерфейса визуализации.
</p><p>Пользователем может быть создано множество стилей, каждый из которых будет хранить цветовые, шрифтовые и другие свойства элементов кадра. Простая смена стиля позволит быстро преобразить интерфейс ВУ, а возможность назначения индивидуального стиля для пользователя позволит учесть его особенности.
</p><p>Для реализации этой возможности, при создании кадров, необходимо для свойств цвета, шрифта и других установить параметр "Конфигурация" (таблицы во вкладке "Обработка") в значение "Из стиля". А в параметре "Конфигурационный шаблон" указать идентификатор поля стиля. Далее, это поле автоматически появится в менеджере стилей и его можно будет там менять. Менеджер стилей доступен на странице конфигурации проекта во вкладке "Стили". На этой вкладке можно стили создавать, удалять и изменять, удалять их поля.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:699px;"><a class="image" href="http://oscada.org/wiki/File:VCA_prj_stl_ru.png"><img class="thumbimage" height="531" src="../files/VCA_prj_stl_ru.png" width="697" /></a>  <div class="thumbcaption">Рисунок. Вкладка "Стили" страницы конфигурации проекта.</div></div></div></div>
<p>В целом, стили доступны начиная с уровня проектов. На уровне библиотек виджетов можно только определять поля стилей у виджетов. На уровне проекта, при выборе стиля, включается работа со стилями, что предполагает доступ к полям стилей вместо непосредственных значений атрибутов. Фактически, это означает, что при чтении или записи атрибута виджета, указанные операции будут осуществляться над соответствующим полем выбранного стиля.
</p><p>При запуске проекта на исполнения будет использован установленный в проекте стиль. В последствии, пользователь может выбрать стиль из перечня доступных. Выбранный пользователем стиль будет сохранён и использован при следующем запуске проекта.
</p><p><br />
</p>
<h3><span class="mw-headline" id=".D0.A1.D0.BE.D0.B1.D1.8B.D1.82.D0.B8.D1.8F.2C_.D0.B8.D1.85_.D0.BE.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B0_.D0.B8_.D0.BA.D0.B0.D1.80.D1.82.D1.8B_.D1.81.D0.BE.D0.B1.D1.8B.D1.82.D0.B8.D0.B9"><span class="mw-headline-number">3.5</span> События, их обработка и карты событий</span></h3>
<p>Учитывая спектр задач, для которых может использоваться OpenSCADA, нужно предусмотреть механизм управления интерактивными пользовательскими событиями. Это связано с тем, что при решении отдельных задач встраиваемых систем, устройства ввода и управления могут значительно отличатся. Впрочем, достаточно взглянуть на обычную офисную клавиатуру и клавиатуру ноутбука, чтобы снять любые сомнения о необходимости менеджера событий.
</p><p>Менеджер событий должен работать используя карты событий. Карта событий — это список именованных событий с указанием его происхождения. Происхождением события может быть клавиатура, манипулятор мыши, джойстик и т.д. При возникновении события менеджер событий ищет его в активной карте и сопоставляет с именем события. Сопоставленное имя события помещается в очередь на обработку. Виджеты, в этом случае, должны обрабатывать полученную очередь событий.
</p><p>Активная карта событий указывается в профиле каждого пользователя или устанавливается по умолчанию, <span style="color: red">в планах</span>.
</p><p>В целом, предусмотрены четыре типа событий:
</p>
<ul><li> события образов-примитивов СВУ (префикс: <b>ws_</b>), например, событие нажатия экранной кнопки — "ws_BtPress";</li>
<li> клавишные события (префикс: <b>key_</b>) — все события от клавиатуры и мыши в виде "key_presAlt1";</li>
<li> пользовательские события (префикс: <b>usr_</b>), генерируются пользователем в процедурах обсчёта виджетов;</li>
<li> мапированные события (префикс: <b>map_</b>) — события, полученные из карты событий, <span style="color: red">в планах</span>.</li></ul>
<p>Само событие представляет недостаточно информации, особенно если его обработка происходит на уровнях выше. Для однозначной идентификации события и его источника, событие, в целом, записывается следующим образом: "ws_BtPress:/curtime". Где:
</p>
<dl><dd><i>ws_BtPress</i> — событие;</dd>
<dd><i>/curtime</i> — путь к дочернему элементу, сгенерировавшее событие.</dd></dl>
<p>В таблице 3.5 приведён перечень стандартных событий, поддержка которых должна быть обеспечена в визуализаторах СВУ.
</p><p><b>Таблица 3.5.</b> Стандартные события
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Описание
</th></tr>
<tr>
<td colspan="2"> <i>Клавиатурные события:</i> <b>key_[pres|rels][Ctrl|Alt|Shift]{Key}</b>
</td></tr>
<tr>
<td> *SC#3b </td>
<td> Скан-код клавиши.
</td></tr>
<tr>
<td> *#2cd5 </td>
<td> Код неименованной клавиши.
</td></tr>
<tr>
<td> *Esc </td>
<td> "Esc".
</td></tr>
<tr>
<td> *BackSpace </td>
<td> Удаление предыдущего символа — "&lt;-".
</td></tr>
<tr>
<td> *Return, *Enter </td>
<td> Ввод — "Enter".
</td></tr>
<tr>
<td> *Insert </td>
<td> Вставка — "Insert".
</td></tr>
<tr>
<td> *Delete </td>
<td> Удаление — "Delete".
</td></tr>
<tr>
<td> *Pause </td>
<td> Пауза — "Pause".
</td></tr>
<tr>
<td> *Print </td>
<td> Печать экрана — "Print Screen".
</td></tr>
<tr>
<td> *Home </td>
<td> Дом — "Home".
</td></tr>
<tr>
<td> *End </td>
<td> Конец — "End".
</td></tr>
<tr>
<td> *Left </td>
<td> Влево — "&lt;-".
</td></tr>
<tr>
<td> *Up </td>
<td> Вверх — '^'.
</td></tr>
<tr>
<td> *Right </td>
<td> Вправо — "-&gt;".
</td></tr>
<tr>
<td> *Down </td>
<td> Вниз — '\/'.
</td></tr>
<tr>
<td> *PageUp </td>
<td> Страницы вверх — "PageUp".
</td></tr>
<tr>
<td> *PageDown </td>
<td> Страницы вниз — "PageDown".
</td></tr>
<tr>
<td> *F1 ... *F35 </td>
<td> Функциональная клавиша от "F1" до "F35".
</td></tr>
<tr>
<td> *Space </td>
<td> Пробел — ' '.
</td></tr>
<tr>
<td> *Apostrophe </td>
<td> Апостроф — '`'.
</td></tr>
<tr>
<td> *Asterisk </td>
<td> Звёздочка на дополнительном поле клавиатуры — '*'.
</td></tr>
<tr>
<td> *Plus </td>
<td> Плюс на дополнительном поле клавиатуры — '+'.
</td></tr>
<tr>
<td> *Comma </td>
<td> Запятая — ','.
</td></tr>
<tr>
<td> *Minus </td>
<td> Минус — '-'.
</td></tr>
<tr>
<td> *Period </td>
<td> Точка — '.'.
</td></tr>
<tr>
<td> *Slash </td>
<td> Наклонная черта — '\'.
</td></tr>
<tr>
<td> *0 ... *9 </td>
<td> Цифра от '0' до '9'.
</td></tr>
<tr>
<td> *Semicolon </td>
<td> Точка с запятой — ';'.
</td></tr>
<tr>
<td> *Equal </td>
<td> Равно — '='.
</td></tr>
<tr>
<td> *A ... *Z </td>
<td> Клавиши букв латинского алфавита от 'A' до 'Z'.
</td></tr>
<tr>
<td> *BracketLeft </td>
<td> Левая квадратная скобка — '['.
</td></tr>
<tr>
<td> *BackSlash </td>
<td> Обратная наклонная черта — '/'.
</td></tr>
<tr>
<td> *BracketRight </td>
<td> Правая квадратная скобка — ']'.
</td></tr>
<tr>
<td> *QuoteLeft </td>
<td> Левая кавычка — <b>.</b>
</td></tr>
<tr>
<td colspan="2"> <i>События клавиатурного фокуса.</i>
</td></tr>
<tr>
<td> ws_FocusIn </td>
<td> Фокус получен виджетом.
</td></tr>
<tr>
<td> ws_FocusOut </td>
<td> Фокус утерян виджетом.
</td></tr>
<tr>
<td colspan="2"> <i>Мышиные события:</i>
</td></tr>
<tr>
<td> key_mouse[Pres|Rels][Left|Right|Midle] </td>
<td> Нажата/отпущена кнопка мыши.
</td></tr>
<tr>
<td> key_mouseDblClick </td>
<td> Двойное нажатие левой кнопки мыши.
</td></tr>
<tr>
<td colspan="2"> <i>События квитирования на стороне визуализатора.</i>
</td></tr>
<tr>
<td> ws_alarmLev </td>
<td> Квитирование всех нарушений всеми способами и типами уведомления.
</td></tr>
<tr>
<td> ws_alarmNtf{N} </td>
<td> Квитирование всех нарушений уведомления типа {N} (0...7).
</td></tr>
<tr>
<td colspan="2"> <i>События примитива элементарной фигуры <b>ElFigure</b>:</i>
</td></tr>
<tr>
<td> ws_Fig[Left|Right|Midle|DblClick] </td>
<td> Активация фигур (заливок) клавишей мыши.
</td></tr>
<tr>
<td> ws_Fig{N}[Left|Right|Midle|DblClick] </td>
<td> Активация фигуры (заливки) <i>N</i> клавишей мыши.
</td></tr>
<tr>
<td colspan="2"> <i>События примитива элемента формы <b>FormEl</b>:</i>
</td></tr>
<tr>
<td> ws_LnAccept </td>
<td> Установлено новое значение в строке ввода.
</td></tr>
<tr>
<td> ws_TxtAccept </td>
<td> Изменено значение редактора текста.
</td></tr>
<tr>
<td> ws_ChkChange </td>
<td> Состояние флажка изменено.
</td></tr>
<tr>
<td> ws_BtPress </td>
<td> Кнопка нажата.
</td></tr>
<tr>
<td> ws_BtRelease </td>
<td> Кнопка отпущена.
</td></tr>
<tr>
<td> ws_BtToggleChange </td>
<td> Изменена вдавленность кнопки.
</td></tr>
<tr>
<td> ws_BtMenu={Item} </td>
<td> Выбор элемента меню <i>Item</i> по кнопке.
</td></tr>
<tr>
<td> ws_BtLoad </td>
<td> Выбранный файл загружен.
</td></tr>
<tr>
<td> ws_CombChange </td>
<td> Изменено значение поля выбора.
</td></tr>
<tr>
<td> ws_ListChange </td>
<td> Изменен текущий элемент списка.
</td></tr>
<tr>
<td> ws_TreeChange </td>
<td> Изменен текущий элемент дерева.
</td></tr>
<tr>
<td> ws_TableChangeSel </td>
<td> Изменён выбор элемента таблицы.
</td></tr>
<tr>
<td> ws_TableEdit_{colN}_{rowN} </td>
<td> Отредактирована ячейка таблицы ({colN}:{rowN}).
</td></tr>
<tr>
<td> ws_SliderChange </td>
<td> Изменение положения слайдера.
</td></tr>
<tr>
<td colspan="2"> <i>События примитива медиа-контента <b>Media</b>:</i>
</td></tr>
<tr>
<td> ws_MapAct{N}[Left|Right|Midle] </td>
<td> Активирована медиа-область с номером <i>N</i>, клавишей мыши.
</td></tr>
<tr>
<td> ws_MediaFinished </td>
<td> Окончано проигрывание Медиа-потока.
</td></tr></table>
<p>События являются основным механизмом уведомления и активно используются для осуществления взаимодействия с пользователем. Для обработки событий предусмотрены два механизма:
</p>
<ul><li> Первичный — сценарий управления открытием страниц.</li>
<li> Вторичный — вычислительная процедура виджета.</li></ul>
<p>Механизм "Сценарий управления открытием страниц" основан на базовом атрибуте виджета "evProc", в котором может описываться открытие страниц. Сценарий этого атрибута записывается в виде списка команд с синтаксисом: "<b>{event}:{evSrc}:{com}:{prm}</b>". Где:
</p>
<ul><li> <i>event</i> — ожидаемое событие;</li>
<li> <i>evSrc</i> — путь вложенного виджета-источника события;</li>
<li> <i>com</i> — команда сеанса;</li>
<li> <i>prm</i> — параметр команды.</li></ul>
<p>Реализованы следующие команды:
</p>
<ul><li> <i>open</i> — открытие страницы; открываемая страница указывается в параметре <i>prm</i> как прямо, так и в виде шаблона, например — <b>/pg_so/1/*/*</b>;</li>
<li> <i>next</i> — открытие следующей страницы; открываемая страница указывается в параметре <i>prm</i>, в виде шаблона, например: <b>/pg_so/*/*/$</b>;</li>
<li> <i>prev</i> — открытие предыдущей страницы; открываемая страница указывается в параметре <i>prm</i>, в виде шаблона, например: <b>/pg_so/*/*/$</b>.</li></ul>
<p>Специальные символы шаблона расшифровываются следующим образом:
</p>
<ul><li> <i>pg_so</i> — прямое имя требуемой-статической страницы (с префиксом), требует обязательного соответствия и используется для идентификации предыдущей открытой страницы;</li>
<li> <i>1</i> — имя и место новой страницы в общем пути (без префикса);</li>
<li> <i>*</i> — страница берётся из имени предыдущей открытой страницы или подставляется первая доступная страница, если предыдущая открытая отсутствует;</li>
<li> <i>$</i> — указывает на место открытой страницы, относительно которой необходимо искать следующую или предыдущую.</li></ul>
<p>Для правильного понимания работы механизма шаблонов, при выборе страницы, приведём несколько реальных примеров:
</p>
<ul><li> <i>Переключение объекта сигнализации:</i></li></ul>
<dl><dd><dl><dd>Исходно: <b>/pg_so/pg_1/pg_mn/pg_1</b></dd>
<dd>Команда: <b>open:/pg_so/2/*/*</b></dd>
<dd>Результат: <b>/pg_so/pg_2/pg_mn/pg_1</b></dd></dl></dd></dl>
<ul><li> <i>Переключение вида отображения:</i></li></ul>
<dl><dd><dl><dd>Исходно: <b>/pg_so/pg_1/pg_mn/pg_1</b></dd>
<dd>Команда: <b>open:/pg_so/*/gkadr/*</b></dd>
<dd>Результат: <b>/pg_so/pg_1/pg_gkadr/pg_1</b></dd></dl></dd></dl>
<ul><li> <i>Следующая/предыдущая страница вида отображения:</i></li></ul>
<dl><dd><dl><dd>Исходно: <b>/pg_so/pg_1/pg_mn/pg_1</b></dd>
<dd>Команда: <b>next:/pg_so/*/*/$</b></dd>
<dd>Результат: <b>/pg_so/pg_1/pg_mn/pg_2</b></dd></dl></dd></dl>
<p>В качестве примера, приведём сценарий обеспечения работы главной страницы интерфейса пользователя:
</p>
<pre style="white-space: pre-wrap;">
ws_BtPress:/prev:prev:/pg_so/*/*/$
ws_BtPress:/next:next:/pg_so/*/*/$
ws_BtPress:/go_mn:open:/pg_so/*/mn/*
ws_BtPress:/go_graph:open:/pg_so/*/ggraph/*
ws_BtPress:/go_cadr:open:/pg_so/*/gcadr/*
ws_BtPress:/go_view:open:/pg_so/*/gview/*
ws_BtPress:/go_doc:open:/pg_so/*/doc/*
ws_BtPress:/go_resg:open:/pg_so/rg/rg/*
ws_BtPress:/so1:open:/pg_so/1/*/*
ws_BtPress:/so2:open:/pg_so/2/*/*
ws_BtPress:/so3:open:/pg_so/3/*/*
ws_BtPress:/so4:open:/pg_so/4/*/*
ws_BtPress:/so5:open:/pg_so/5/*/*
ws_BtPress:/so6:open:/pg_so/6/*/*
ws_BtPress:/so7:open:/pg_so/7/*/*
ws_BtPress:/so8:open:/pg_so/8/*/*
ws_BtPress:/so9:open:/pg_so/9/*/*
ws_BtPress:*:open:/pg_control/pg_terminator
</pre>
<p>Механизм "Обработка событий с помощью вычислительной процедуры виджета" основан на атрибуте "event" и пользовательской процедуре вычисления, на языке программирования OpenSCADA. События, по мере поступления, аккумулируются в атрибуте "event" до момента вызова вычислительной процедуры. Вычислительная процедура вызывается с указанным периодом вычисления виджета и получает значение атрибута "event" в виде списка событий. В процедуре вычисления, пользователь может: проанализировать, обработать и исключить обработанные события из списка, а также добавить в список новые события. Оставшиеся, после исполнения процедуры, и новые события анализируются на предмет соответствия условиям вызова сценарием первичного механизма, после чего, оставшиеся события передаются на верхний по иерархии виджет, для обработки им, при этом осуществляется дополнение пути событий согласно иерархии проникновения.
</p><p>Содержимым атрибута "event" является список событий формата "<b>{event}:{evSrc}</b>", с событием в отдельной строке. Приведём пример процедуры обработки событий на Java-подобном языке пользовательского программирования OpenSCADA:
</p>
<pre style="white-space: pre-wrap;">
for(ev_rez = "", off = 0; (sval=event.parse(0,"\n",off)).length; ) {
  if(sval == "ws_BtPress:/cvt_light") alarmSt = 0x1000001;
  else if(sval == "ws_BtPress:/cvt_alarm") alarmSt = 0x1000002;
  else if(sval == "ws_BtPress:/cvt_sound") alarmSt = 0x1000004;
  else ev_rez += sval+"\n";
}
event = ev_rez;
</pre>
<p><br />
</p>
<h3><span class="mw-headline" id=".D0.A1.D0.B8.D0.B3.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F"><span class="mw-headline-number">3.6</span> <span id="Alarms" title="#Alarms">Сигнализация</span></span></h3>
<p>Важным элементом любого интерфейса визуализации является уведомление пользователя про нарушения — сигнализация. Для упрощения восприятия, а также в виду тесной связи визуализации и уведомления (как правило, уведомление дополняет визуализацию) решено интегрировать интерфейс уведомления в интерфейс визуализации. Для этого, во всех виджетах, предусматриваются два дополнительных атрибута уровня сеанса: "alarm" и "alarmSt". Атрибут "alarm" используется для формирования сигнала виджетом в соответствии с его логикой, а атрибут "alarmSt" используется для контроля за фактом сигнализации ветви дерева сеанса.
</p><p>Атрибут "alarm" является строкой, которая имеет следующий формат: "<b>{lev}|{categ}|{message}|{type}|{tp_arg}</b>"<br />
Где:
</p>
<ul><li> <i>lev</i> — уровень сигнализации: число от 0 до 255;</li>
<li> <i>categ</i> — категория сигнала: параметр подсистемы сбора, объект, путь или комбинация;</li>
<li> <i>message</i> — сообщение сигнализации;</li>
<li> <i>type</i> — типы уведомления, указываются в виде целого числа (0...7), содержащего флаги способов уведомлений; типовые способы уведомления:
<ul><li> <i>1</i> — визуальная;</li>
<li> <i>2</i> — гудок, часто производится через PC-speaker;</li>
<li> <i>4</i> — звуковой сигнал из файла звука или синтез речи; если в <i>tp_arg</i> указано имя ресурса звукового файла, то воспроизводится именно он, иначе выполняется синтез речи из текста, указанного в <i>message</i>.</li></ul></li>
<li> <i>tp_arg</i> — аргумент типа; часто используется для прямого указания ресурса звукового сигнала — файл звукового формата, при осуществлении звуковой сигнализации.</li></ul>
<p>Атрибут "alarmSt" является целым числом, которое отражает максимальный уровень сигнала и факт квитирования ветви дерева сеанса. Формат числа имеет следующий вид:
</p>
<ul><li> первый байт (0...255) характеризует уровень сигнала ветви;</li>
<li> второй байт указывает тип уведомления, также как и в атрибуте "alarm";</li>
<li> третий байт указывает тип несквитированного уведомления, также как и в атрибуте "alarm";</li>
<li> четвёртый байт имеет специальное значение, определяемое отдельными битами:
<ul><li> бит 0 — указывает, установкой, на факт квитирования уведомлений в первом байте;</li>
<li> бит 1 — указывает, при установке его и бита 0, на возврат квитирования — включение уведомления.</li></ul></li></ul>
<p><b>Формирование сигнала и получение его визуализатором.</b><br />
Формирование сигнала производится самим виджетом, путём установки собственного атрибута "alarm" нужным образом и, в соответствии с ним, автоматически устанавливается атрибут "alarmSt" текущего и вышестоящих виджетов. Визуализаторы получают уведомление о сигнале с помощью стандартного механизма уведомления об изменении атрибутов виджетов.
</p><p>Учитывая то, что обработка условий сигнализации осуществляется в виджетах, страницы, содержащие объекты сигнализации, должны исполняться в фоне, независимо от открытости их в данный момент. Это осуществляется путём установки флага исполнения страницы в фоне.
</p><p>Хотя механизм сигнализации и построен в среде визуализации, возможность формирования невизуальных элементов сигнализации остаётся, например, путём создания страницы, которая никогда не будет открываться.
</p><p><b>Квитация</b><br />
Квитация (от quietance) — процесс подтверждения факта того, что оперативный персонал обратил внимание на нарушение в работе ТП. Обычно этот процесс подразумевает принятие мер оператором для устранения нарушения и нажатие соответствующей кнопки прекращения сигнализации.
</p><p>Квитация производится путём указания корня ветви виджетов и типов уведомления, что позволяет реализовать квитацию на стороне визуализатора как по группам, например, по объектам сигнализации, так и индивидуально по объектам источника. При этом можно независимо квитировать разные типы сигнализаций. Установка квитации производится простой модификацией атрибута "alarmSt".
</p><p>Пример скрипта, для работы с сигналами, приведён ниже:
</p>
<pre style="white-space: pre-wrap;">
//Выделение факта наличия сигнализаций разных способов-типов уведомления
cvt_light_en = alarmSt&amp;0x100; cvt_alarm_en = alarmSt&amp;0x200; cvt_sound_en = alarmSt&amp;0x400;
//Выделение факта наличия несквитированных сигнализаций разных способов уведомления
cvt_light_active = alarmSt&amp;0x10000; cvt_alarm_active = alarmSt&amp;0x20000; cvt_sound_active = alarmSt&amp;0x40000;
//Обработка событий кнопок квитации и квитация разных способов уведомлений
for(ev_rez = "", off = 0; (sval=event.parse(0,"\n",off)).length; ) {
  if(sval == "ws_BtPress:/cvt_light") alarmSt = 0x1000001;
  else if(sval == "ws_BtPress:/cvt_alarm") alarmSt = 0x1000002;
  else if(sval == "ws_BtPress:/cvt_sound") alarmSt = 0x1000004;
  else ev_rez += sval + "\n";
}
event = ev_rez;
</pre>
<p><b>Внешние методы уведомления</b><br />
Основным и типовым способом уведомления является дисплейная световая сигнализация аварийными цветами и их динамикой у элементов визуализации, которая присутствует всегда и не требует специфической конфигурации. Однако, часто нужны уведомления внешнего типа, например: внешней лампой, бузером PC или "ревуном", произвольным звуком, синтезированной речью и т.д.
</p><p>Для осуществления такой возможности, внешние способы уведомления, и соответствующие им типы уведомления, свободно описываются для сервера визуализации и самого визуализатора. На стороне сервера визуализации описывается формирование/получение ресурса уведомления и само уведомление. На стороне визуализатора описывается уведомление согласно ресурсам сервера визуализации.
</p><p>Описание правил и сценариев внешних уведомлений осуществляется с помощью пользовательских атрибутов текстового типа для страниц проекта визуализации, которые применяются при открытии этих страниц. Т.е. потенциально, для каждой открываемой страницы можно описать собственные правила уведомления, хотя, обычно достаточно и описываются общие правила уведомления на главной странице проекта — странице, которая открывается один раз и не закрывается при работе:
</p>
<ul><li> Для сервера/движка визуализации, атрибутом "notify{N}" в формате:</li></ul>
<pre style="white-space: pre-wrap; margin-left: 15px">
//flags=notifyServ[{DL}][|resource[|queue[|qMergeMess]]];
if(doRes) { Текст команды формирования ресурса. }
if(doNtf) { Текст команды уведомления. }
</pre>
<ul><li> Для визуализатора, атрибутом "notifyVis[Vision|WebVision]{N}" в формате:</li></ul>
<pre style="white-space: pre-wrap; margin-left: 15px">
//flags=notify[{DL}][|resource[|queue[|quietanceRet]]];
//name={Имя уведомителя}
//ico={Имя иконки}
{ Текст команды уведомления для любого или конкретного визуализатора. }
</pre>
<p>Флаги:
</p>
<ul><li> <i>notify[{DL}]</i>, <i>notifyServ[{DL}]</i> — включает уведомление c повтором через время <i>DL</i>, если указано; для <i>DL</i> = 0 повтор производится сразу.</li>
<li> <i>resource</i> — запрашивать-формировать (принудительно) ресурс уведомления у сервера визуализации, может быть звуковым файлом, текстом или другими данными формирования уведомления; но на данное время уведомители в основном ожидают аудио.</li>
<li> <i>queue</i> — ресурсы уведомления определяются не только по глобальному признаку нарушения и квитации, а и согласно приоритетной очереди источников уведомления-ресурсов. Очередь формируется на стороне сервера визуализации, а для визуализаторов указывается необходимость работы с ней при запросе ресурсов.</li>
<li> <i>qMergeMess</i> — объединять уведомления в очереди по равенству сообщения.</li>
<li> <i>quietanceRet</i> — возможность отзыва-возврата квитации визуализатора, т.е. по сути — обратного включения уведомления.</li></ul>
<p>Наличие поля "resStatic" включает получение ресурса непосредственно из mime-таблицы или файла, указывается в способ подобный <a href="#Media">примитиву "Медиа"</a>.
</p><p>Переменные обмена:
</p>
<ul><li> <i>en</i>[0,1] — уведомление включить (1) или выключить (0);</li>
<li> <i>doNtf</i>[0,1] — вызов сценария уведомления;</li>
<li> <i>doRes</i>[0,1] — вызов сценария формирования ресурса;</li>
<li> <i>res</i> — содержимое или имя файла с содержимым ресурса, для внешних сценариев;</li>
<li> <i>resTp</i> — тип ресурса, вроде "audio/ogg"; является возвратом и помещается в стандартный выход (для Shell) для <i>doRes</i>;</li>
<li> <i>mess</i> — сообщение-параметры формирования ресурса и уведомления;</li>
<li> <i>lang</i> — язык текущего пользователя или системы;</li>
<li> <i>prcID</i> — уникальный идентификатор процедуры (вроде "ses_AGLKS_ntf2"), в основном для безопасного создания временных файлов.</li></ul>
<p>Примеры и комментарии к работе типовых способов уведомлений:
</p>
<ul><li> Бузер на стороне визуализатора или сервера визуализации:</li></ul>
<dl><dd><ul><li> alarm = "10|Prm||0x02"</li>
<li> notifyVisVision1 | notify1 = </li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify|notifyServ|notifyServ
if(en) SYS.system("beep -f 1000 -l 1000000 &amp;", true);
else if((beepPID=SYS.system("pidof beep")).toInt()) SYS.system("kill "+beepPID); </pre>
<dl><dd><ul><li> notifyVisVision1 | notify1 = </li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify|notifyServ
if test $en = 1; then
	beep -f 1000 -l 1000000 &amp;
else
	beepPID=$(pidof beep)
	if test "x$beepPID"&nbsp;!= "x"; then kill $beepPID; fi
fi </pre>
<ul><li> Повторяющееся проигрывание готового звукового файла, одного общего, на стороне визуализатора или сервера визуализации:</li></ul>
<dl><dd><ul><li> alarm = "10|Prm||0x04"</li>
<li> notify2 | notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify2|notifyServ2
if(en) SYS.system("play -q alarm.ogg");</pre>
<dl><dd><ul><li> notify2 | notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify2|notifyServ2
if test $en = 1; then play -q alarm.ogg; fi</pre>
<ul><li> Проигрывание индивидуального, для источника, звукового файла, на стороне визуализатора:</li></ul>
<dl><dd><ul><li> alarm = "10|Prm||0x04|res:al_prm1"</li>
<li> notify2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=queue</pre>
<dl><dd><ul><li> notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify2|queue
if(doNtf &amp;&amp; en &amp;&amp; res.length) {
  SYS.fileWrite("tmpPlay", res);
  SYS.system("play -q tmpPlay");
  SYS.fileRemove("tmpPlay");
}</pre>
<dl><dd><ul><li> notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify2|queue
if test $doNtf = 1 -a $en = 1 -a -s $res; then play -q $res; fi
</pre>
<ul><li> Синтез речи индивидуального сообщения, для источника, на стороне визуализатора:</li></ul>
<dl><dd><ul><li> alarm = "10|Prm|Текстовое сообщение синтеза речи|0x04"</li>
<li> notify2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=queue</pre>
<dl><dd><ul><li> notifyVisVision2 = </li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify2|queue
if(doNtf &amp;&amp; en &amp;&amp; mess.length) {
  SYS.fileWrite("tmpForSpeech", mess);
  SYS.system("festival --tts tmpForSpeech");
  SYS.fileRemove("tmpForSpeech");
}
</pre>
<dl><dd><ul><li> notifyVisVision2 = </li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify2|queue
if test $doNtf = 1 -a $en = 1 -a "x"&nbsp;!= "x$mess"; then
  echo $mess &gt; tmpForSpeech
  festival --tts tmpForSpeech
  rm tmpForSpeech
fi
</pre>
<ul><li> Подготовка звукового файла, одного общего, и его проигрывание на стороне визуализатора или сервера визуализации:</li></ul>
<dl><dd><ul><li> alarm = "10|Prm||0x04"</li>
<li> notify2 = </li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify2|notifyServ2|resource
if(doRes) res = SYS.fileRead("alarm.ogg");  //Вставить сюда другой метод генерации
if(doNtf &amp;&amp; en &amp;&amp; res.length) {
  SYS.fileWrite("tmpPlay", res);
  SYS.system("play -q tmpPlay");
  SYS.fileRemove("tmpPlay");
}</pre>
<dl><dd><ul><li> notify2 = </li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify2|notifyServ2|resource
if test $doRes = 1; then cp -f alarm.ogg $res; fi  #Вставить сюда другой метод генерации
if test $doNtf = 1 -a $en = 1 -a -s $res; then play -q $res; fi
</pre>
<dl><dd><ul><li> notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify2|resource
if(en &amp;&amp; res.length) {
  SYS.fileWrite("tmpPlay", res);
  SYS.system("play -q tmpPlay");
  SYS.fileRemove("tmpPlay");
}</pre>
<dl><dd><ul><li> notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify2|resource
if test $en = 1 -a -s $res; then play -q $res; fi
</pre>
<ul><li> Подготовка индивидуального, для источника уведомления, звукового файла через синтез речи, на стороне визуализатора или сервера визуализации:</li></ul>
<dl><dd><ul><li> alarm = "10|Prm|Текстовое сообщение синтеза речи|0x04"</li>
<li> notify2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify2|notifyServ2|queue
if(doRes &amp;&amp; mess.length) {
 SYS.fileWrite("tmpText", mess);
 SYS.system("text2wave tmpText -o tmpWAV");
 res = SYS.fileRead("tmpWAV");
 SYS.fileRemove("tmpText"); SYS.fileRemove("tmpWAV");
}
if(doNtf &amp;&amp; en &amp;&amp; res.length) {
 SYS.fileWrite("tmpPlay", res);
 SYS.system("play -q tmpPlay");
 SYS.fileRemove("tmpPlay");
}</pre>
<dl><dd><ul><li> notify2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify2|notifyServ2|queue
if test $doRes = 1 -a "x"&nbsp;!= "x$mess"; then
 echo $mess &gt; tmpText
 text2wave tmpText -o $res
 rm tmpText
fi
if test $doNtf = 1 -a $en = 1 -a -s $res; then play -q $res; fi
</pre>
<dl><dd><ul><li> notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
//flags=notify2|queue
if(en &amp;&amp; res.length) {
 SYS.fileWrite("tmpPlay", res);
 SYS.system("play -q tmpPlay");
 SYS.fileRemove("tmpPlay");
}</pre>
<dl><dd><ul><li> notifyVisVision2 =</li></ul></dd></dl>
<pre style="white-space: pre-wrap; margin-left: 30px">
#!/bin/sh
#flags=notify2|queue
if test $en = 1 -a -s $res; then play -q $res; fi
</pre>
<p><br />
</p>
<h3><span class="mw-headline" id=".D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B0.D0.BC.D0.B8"><span class="mw-headline-number">3.7</span> Управление правами</span></h3>
<p>Для разделения доступа к интерфейсу ВУ и его составляющим, каждый виджет содержит информацию о владельце, его групах и правах доступа. Права доступа записываются в виде триады: "<b>{пользователь}{группа[,группа1,группаN]}{остальные}</b>", где каждый элемент состоит из двух признаков доступа, для которых принята следующая интерпретация:
</p>
<ul><li> <b>r</b> — право на просмотр виджета;</li>
<li> <b>w</b> — право на контроль над виджетом.</li></ul>
<p>В режиме разработки используется простая схема доступа "root.UI:RWRWR_", что означает — все пользователи могут открывать и просматривать библиотеки, их компоненты и проекты; а редактировать могут все пользователи группы "UI" (пользовательские интерфейсы).
</p><p>В режиме исполнения работают права, описанные в компонентах интерфейса, которые предусматривают возможность наследования владельца и прав, сверху вниз. Причём, по умолчанию, наследование включено в каждом виджете, а значит — они получат владельца и права проекта. В тоже время, прямая установка прав составного виджета распространит их на все компоненты этого виджета.
</p><p><br />
</p>
<h3><span class="mw-headline" id=".D0.A1.D0.B2.D1.8F.D0.B7.D1.8B.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81_.D0.B4.D0.B8.D0.BD.D0.B0.D0.BC.D0.B8.D0.BA.D0.BE.D0.B9"><span class="mw-headline-number">3.8</span> Связывание с динамикой</span></h3>
<p>Для предоставления в интерфейс визуализации актуальных данных, должны использоваться данные подсистемы "Сбор данных (DAQ)". Природа этих данных следующая:
</p>
<ol><li> параметры, содержащие некоторое количество атрибутов;</li>
<li> атрибуты параметра могут предоставлять данные пяти типов: Логический, Целый, Вещественный, Строковый и Объект;</li>
<li> атрибуты параметра могут иметь архив (историю);</li>
<li> атрибуты параметра могут быть на чтение, запись и с полным доступом.</li></ol>
<p>Учитывая первый пункт, нужно обеспечить возможность группового назначения ссылки. Для этого используем <a href="../DAQ.html#LogicLev" title="Special:MyLanguage/Documents/DAQ">концепцию логического уровня</a>.
</p><p>В соответствии с пунктом 2, связи обеспечивают прозрачное преобразование типов и не требуют специальной конфигурации.
</p><p>Для удовлетворения возможности доступа к архивам, в соответствии с пунктом 3, связи выполняют проверку типа атрибута и, в случае подключения к "Адресу", в значение помещается адрес связи.
</p><p>В терминах СВУ, динамические связи и конфигурация динамики являются одним процессом, для описания конфигурации которого предусматривается вкладка "Обработка" виджетов. Вкладка содержит таблицу конфигурации свойств атрибутов и текст процедуры вычисления виджета.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1164px;"><a class="image" href="http://oscada.org/wiki/File:VCA_wdg_proc_ru.png"><img class="thumbimage" height="769" src="../files/VCA_wdg_proc_ru.png" width="1162" /></a>  <div class="thumbcaption">Рисунок. Вкладка "Обработка" страницы конфигурации виджета.</div></div></div></div>
<p>Кроме полей конфигурации атрибутов, в таблице предусматривается колонка "Обработка", для избирательного использования атрибутов в вычислительной процедуре виджета, и колонки "Конфигурация", "Конфигурационный шаблон" для описания конфигурации связей.
</p><p>Если в колонке "Обработка" стоит true, то в вычислительной процедуре становится доступной переменная <i>{идентификатор виджета}_{идентификатор атрибута}</i>, например <i>cw_value</i>.
</p><p>Колонка "Конфигурация" позволяет указать тип связи атрибута виджета:
</p>
<ul><li> <i>Постоянная</i> — во вкладке связей виджета появляется поле указания постоянной, например, особого цвета или заголовка шаблонных кадров.</li>
<li> <i>Входная связь</i> — связь с динамикой только для чтения.</li>
<li> <i>Выходная связь</i> — связь с динамикой только для записи.</li>
<li> <i>Полная связь</i> — полная связь с динамикой, чтение и запись.</li>
<li> <i>Из стиля</i> — брать значение из стиля проекта.</li></ul>
<p>Колонка "Конфигурационный шаблон" позволяет связать группы динамических атрибутов. Например, это могут быть разные типы параметров подсистемы "DAQ" и другие виджеты интерфейса. При корректном формировании этого поля работает механизм автоматического назначения атрибутов, при указании только параметра подсистемы "DAQ" или виджета интерфейса, что упрощает и ускоряет процесс конфигурации. Значение этой колонки имеет следующий формат:
</p>
<ul><li> <i>Для постоянной:</i> прямое значение атрибута.</li>
<li> <i>Для связи:</i> "<b>{параметр}|{идентификатор}</b>", где:
<ul><li> <i>параметр</i> — группа атрибутов;</li>
<li> <i>идентификатор</i> — идентификатор атрибута; именно значение в этом поле сопоставляется с атрибутами параметров DAQ после указания групповой связи, при автоматическом связывании;</li></ul></li>
<li> <i>Для стиля:</i> идентификатор-имя поля стиля.</li></ul>
<p>Установка связей может быть нескольких типов, который определяется префиксом:
</p>
<ul><li> <i>val:</i> — Прямая загрузка значения через механизм связей. Например, связь "val:100" загружает значение 100 в атрибут виджета. Часто используется в случае отсутствия конечной точки связи, с целью прямой установки значения.</li>
<li> <i>prm:</i> — Связь на атрибут параметра или параметр, в целом, для группы атрибутов подсистемы "Сбор данных". Например, связь "prm:/LogicLev/experiment/Pi/var" осуществляет доступ атрибута виджета к атрибуту параметра подсистемы "Сбор данных". Знак "(+)", в конце адреса, указывает на успешную линковку и присутствие целевого объекта. Для атрибутов объектного типа допустим иерархический доступ к конкретному свойству объекта, путём указания его пути через символ '#', например: "prm:/LogicLev/experiment/Pi/var#pr1/pr2".</li>
<li> <i>wdg:</i> — Связь на атрибут другого виджета или виджет, в целом, для группы атрибутов. Например, связь "wdg:/ses_AGLKS/pg_so/pg_1/pg_ggraph/pg_1/a_bordColor" осуществляет доступ атрибута одного виджета к атрибуту другого. Поддерживаются как абсолютные, так и относительные пути связей. Точкой отсчёта адреса абсолютной связи выступает объект корня модуля "VCAEngine", а значит — первым элементом абсолютного адреса является идентификатор сеанса или проекта. Первый элемент, на стороне сеанса, опускается, поэтому связи, установленные в проекте, там работают. Относительные связи берут отсчёт от виджета, где связь указана. Специальным элементом относительной связи является элемент вышестоящего узла "..".</li>
<li> <i>arh:</i> — Особый тип связи, доступный только для отдельного атрибута типа "Адрес", который позволяет подключиться прямо к архиву значений ("arh:CPU_load"). Может быть полезен для указания архива в качестве источника данных примитива "Диаграмма".</li></ul>
<p>Обработка связей происходит с периодичностью вычисления виджета, в порядке:
</p>
<ul><li> получение данных входных связей;</li>
<li> выполнение вычисления процедуры виджета;</li>
<li> передача значений по выходным связям.</li></ul>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="../../en/files/At.png" width="22" /></a> Период вычисления виджета в значении по умолчанию "-1" означает цепное использование значения периода владельца виджета до первого положительного значения, или периода вычисления проекта.
</p><p>На рисунке представлена вкладка связей с групповым назначением атрибутов, путём указания только параметра. На следующем рисунке представлено индивидуальное назначение атрибутов.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:753px;"><a class="image" href="http://oscada.org/wiki/File:VCA_wdg_lnk_grp_ru.png"><img class="thumbimage" height="531" src="../files/VCA_wdg_lnk_grp_ru.png" width="751" /></a>  <div class="thumbcaption">Рисунок. Вкладка "Связи" страницы конфигурации виджета c групповым назначением атрибутов путём указания только параметра.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:753px;"><a class="image" href="http://oscada.org/wiki/File:VCA_wdg_lnk_attr_ru.png"><img class="thumbimage" height="531" src="../files/VCA_wdg_lnk_attr_ru.png" width="751" /></a>  <div class="thumbcaption">Рисунок. Вкладка "Связи" страницы конфигурации виджета c индивидуальным назначением атрибутов.</div></div></div></div>
<p>При размещении виджета в контейнер виджетов все связи исходного виджета добавляются в список результирующих связей контейнера виджетов, однако, только на глубину в один уровень вложения.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:851px;"><a class="image" href="http://oscada.org/wiki/File:VCA_cntwdg_lnk_ru.png"><img class="thumbimage" height="665" src="../files/VCA_cntwdg_lnk_ru.png" width="849" /></a>  <div class="thumbcaption">Рисунок. Вкладка "Связи" страницы конфигурации контейнера виджетов, включающего виджеты со связями.</div></div></div></div>
<p>Из вышесказанного видно, что связи устанавливаются пользователем в процессе конфигурации интерфейса. Однако, для предоставления возможности создания кадров общего назначения с функцией предоставления детализированных данных разных источников одного типа, необходим механизм <span id="DynLink" title="#DynLink">динамической установки связей</span>. Такой механизм предусматривается:
</p>
<ul><li> резервированием ключевого идентификатора "<b>&lt;page&gt;</b>" для группы атрибутов связей у кадров общего назначения;</li>
<li> динамическим назначением связей с идентификатором "<b>&lt;page&gt;</b>", в процессе открытия кадра общего назначения сигналом от другого виджета.</li></ul>
<p>Рассмотрим пример, когда имеется кадр общего назначения "Панель контроля графиком" и множество "Графиков" на разных кадрах. "Панель контроля графиком" имеет связи с шаблонами:
</p>
<ul><li> tSek -&gt; "&lt;page&gt;|tSek"</li>
<li> tSize -&gt; "&lt;page&gt;|tSize"</li>
<li> trcPer -&gt; "&lt;page&gt;|trcPer"</li>
<li> valArch -&gt; "&lt;page&gt;|valArch"</li></ul>
<p>При этом, каждый виджет "График" имеет атрибуты "tSek", "tSize", "trcPer" и "valArch". При вызове сигнала открытия "Панели контроля графиком" из любого виджета "График", происходит связывания атрибутов "Панели контроля графиком" с атрибутами виджета "График", согласно шаблону. Как результат, все изменения на "Панели контроля графиком" будут отражаться на графике, посредством этих связей.
</p><p>Если у виджета "График" присутствуют внешние связи на параметры подсистемы "Сбор данных", связи "Панели контроля графиком" будут устанавливаться на внешний источник. Кроме того, если у "Панели контроля графиком" будут заявлены связи на атрибуты, отсутствующие непосредственно у виджета "График", то будет производится поиск наличия таких атрибутов у внешнего источника — первого на который установлена прямая связь, выполняя, тем самым, дополнение недостающих связей.
</p><p>Для наглядного изображения этого механизма приведена таблица.
</p><p><b>Таблица.</b> Механизм динамической линковки.
</p>
<table class="wikitable">

<tr>
<th> Атрибуты "Панели контроля графиком" (шаблон динамической связи) </th>
<th> Атрибуты "Графика" </th>
<th> Атрибуты внешнего "Параметра" </th>
<th> Результирующая связь или значение связующегося атрибута
</th></tr>
<tr>
<td> tSek (&lt;page&gt;|tSek) </td>
<td> tSek </td>
<td> - </td>
<td> "График".tSek
</td></tr>
<tr>
<td> tSize (&lt;page&gt;|tSize) </td>
<td> tSize </td>
<td> - </td>
<td> "График".tSize
</td></tr>
<tr>
<td> trcPer (&lt;page&gt;|trcPer) </td>
<td> trcPer </td>
<td> - </td>
<td> "График".trcPer
</td></tr>
<tr>
<td> valArch (&lt;page&gt;|valArch) </td>
<td> valArch </td>
<td> - </td>
<td> "График".valArch
</td></tr>
<tr>
<td> var (&lt;page&gt;|var) </td>
<td> var </td>
<td> var </td>
<td> "Параметр".var
</td></tr>
<tr>
<td> ed (&lt;page&gt;|ed) </td>
<td> - </td>
<td> ed </td>
<td> "Параметр".ed
</td></tr>
<tr>
<td> max (&lt;page&gt;|max) </td>
<td> - </td>
<td> - </td>
<td> EVAL
</td></tr>
<tr>
<td> min (&lt;page&gt;|min) </td>
<td> - </td>
<td> - </td>
<td> EVAL
</td></tr></table>
<p><br />
</p>
<h3><span class="mw-headline" id=".D0.9F.D1.80.D0.B8.D0.BC.D0.B8.D1.82.D0.B8.D0.B2.D1.8B_.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.BE.D0.B2"><span class="mw-headline-number">3.9</span> <span id="WidgetPrimitives" title="#WidgetPrimitives">Примитивы виджетов</span></span></h3>
<p>Любой вновь создаваемый виджет основывается на одном из нескольких примитивов — конечном элементе визуализации, путём установки родственной связи как прямо на примитив, так и посредством нескольких промежуточных пользовательских виджетов. Каждый из примитивов содержит механизм модели данных. Экземпляр виджета хранит значения свойств собственной конфигурации примитива.
</p><p>В задачи интерфейса визуализации входит поддержка и работа с моделью данных примитивов виджетов. Примитивы виджетов должны быть тщательно проработаны и унифицированы, с целью охватить как можно больше возможностей в как можно меньшем количестве слабо связанных друг с другом, по назначению, примитивов.
</p><p><b>Таблица.</b> Библиотека примитивов виджетов — базовые элементы отображения
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Наименование </th>
<th> Функция
</th></tr>
<tr>
<td> ElFigure </td>
<td> Элементарная графическая фигура </td>
<td>
<p>Примитив является основой отрисовки элементарных графических фигур со всевозможной комбинацией их в одном объекте. Предусматривается поддержка следующих элементарных фигур:
</p>
<ul><li> Линия.</li>
<li> Дуга.</li>
<li> Кривая Безье.</li>
<li> Заливка замкнутого пространства.<br /></li></ul>
<p>Для всех фигур, содержащихся в виджете, устанавливаются единые свойства толщины, цвета и т.д., также, предусматривается возможность указания вышеперечисленных атрибутов для каждой фигуры отдельно и их динамизация.
</p>
</td></tr>
<tr>
<td> FormEl </td>
<td> Элемент формы </td>
<td>
<p>Включает поддержку стандартных компонентов формы:
</p>
<ul><li> Редактирование строки.</li>
<li> Редактирование текста.</li>
<li> Флажок.</li>
<li> Кнопка.</li>
<li> Выбор из списка.</li>
<li> Список.</li>
<li> Дерево.</li>
<li> Таблица.</li>
<li> Слайдер.</li>
<li> Строка прокрутки. </li></ul>
</td></tr>
<tr>
<td> Text </td>
<td> Текст </td>
<td> Элемент текста-метка. Характеризуется типом шрифта, цветом, ориентацией и выравниванием. Предусматривается поддержка аргументов.
</td></tr>
<tr>
<td> Media </td>
<td> Медиа </td>
<td> Элемент отображения растровых и векторных изображений различных форматов, проигрывания анимированных изображений, проигрывание аудио-фрагментов и просмотр видео-фрагментов.
</td></tr>
<tr>
<td> Diagram </td>
<td> Диаграмма </td>
<td> Элемент диаграммы с поддержкой возможности отображения нескольких потоков в реальном времени для: трендов (временных графиков), частотного спектра, XY диаграмм.
</td></tr>
<tr>
<td> Protocol </td>
<td> Протокол </td>
<td> Элемент протокола — визуализатор сообщений программы, с поддержкой нескольких режимов работы.
</td></tr>
<tr>
<td> Document </td>
<td> Документ </td>
<td> Элемент формирования отчётов, журналов и другой документации на основе доступных данных.
</td></tr>
<tr>
<td> Box </td>
<td> Контейнер </td>
<td> Содержит механизм размещения-включения других виджетов для формирования новых, более сложных, виджетов и страниц конечной визуализации.
</td></tr>
<tr>
<td> Function, <span style="color: red">в планах</span> </td>
<td> Функция API объектной модели OpenSCADA </td>
<td> Невизуальный виджет, на стороне исполнения, позволяющий включать вычислительные функции объектной модели OpenSCADA в СВУ.
</td></tr></table>
<p><b>Таблица.</b> Общий набор свойств/атрибутов виджета
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> id </td>
<td> Идентификатор </td>
<td> - </td>
<td> Идентификатор элемента. Атрибут только для чтения, призванный предоставить информацию об идентификаторе элемента.
</td></tr>
<tr>
<td> path </td>
<td> Путь </td>
<td> - </td>
<td> Путь к этому виджету. Атрибут только для чтения и предоставления исчерпывающей информации о расположения элемента.
</td></tr>
<tr>
<td> parent </td>
<td> Родитель </td>
<td> - </td>
<td> Путь к родительскому виджету. Атрибут только для чтения и предоставления информации о расположении предка от которого унаследован виджет.
</td></tr>
<tr>
<td> owner </td>
<td> Владелец </td>
<td> - </td>
<td> Владелец и группы виджета, в виде "<b>{владелец}:{группа[,группа2,группаN]}</b>", по умолчанию "root:UI".
</td></tr>
<tr>
<td> perm </td>
<td> Доступ </td>
<td> - </td>
<td>
<p>Права доступа к виджету, в виде "<b>{пользователь}{группы}{другие}</b>" плюс флаг наследования, включающий наследование владельца и его прав от вышестоящего виджета.<br />
Где "<b>пользователь</b>", "<b>группы</b>" и "<b>другие</b>" это:
</p>
<ul><li> "__" — нет доступа;</li>
<li> "R_" — только чтение;</li>
<li> "RW" — чтение и запись.<br /></li></ul>
<p>По умолчанию 01000 — наследование.
</p>
</td></tr>
<tr>
<td> root </td>
<td> Корень </td>
<td> 1 </td>
<td> Идентификатор виджета-примитива (базового элемента), который лежит в основе образа визуализации виджета.
</td></tr>
<tr>
<td> name </td>
<td> Имя </td>
<td> - </td>
<td> Имя элемента. Модифицируемое имя элемента.
</td></tr>
<tr>
<td> dscr </td>
<td> Описание </td>
<td> - </td>
<td> Описание элемента. Текстовое поле краткого описания.
</td></tr>
<tr>
<td> en </td>
<td> Включен </td>
<td> 5 </td>
<td> Состояние "Включен" элемента. Отключенный элемент не отображается при исполнении.
</td></tr>
<tr>
<td> active </td>
<td> Активный </td>
<td> 6 </td>
<td> Состояние "Активный" элемента. Активный элемент может получать фокус при исполнении, а значит — получать клавиатурные и иные события с последующей их обработкой.
</td></tr>
<tr>
<td> geomX </td>
<td> Геометрия: x </td>
<td> 7 </td>
<td> Геометрия, координата 'x' положения элемента.
</td></tr>
<tr>
<td> geomY </td>
<td> Геометрия: y </td>
<td> 8 </td>
<td> Геометрия, координата 'y' положения элемента.
</td></tr>
<tr>
<td> geomW </td>
<td> Геометрия: ширина </td>
<td> 9 </td>
<td> Геометрия, ширина элемента.
</td></tr>
<tr>
<td> geomH </td>
<td> Геометрия: высота </td>
<td> 10 </td>
<td> Геометрия, высота элемента.
</td></tr>
<tr>
<td> geomXsc </td>
<td> Геометрия: x масштаб </td>
<td> 13 </td>
<td> Масштаб элемента по горизонтали.
</td></tr>
<tr>
<td> geomYsc </td>
<td> Геометрия: y масштаб </td>
<td> 14 </td>
<td> Масштаб элемента по вертикали.
</td></tr>
<tr>
<td> geomZ </td>
<td> Геометрия: z </td>
<td> 11 </td>
<td> Геометрия, координата 'z' (уровень) элемента на кадре. Также определяет порядок передачи фокуса между активными элементами.
</td></tr>
<tr>
<td> geomMargin </td>
<td> Геометрия: отступ </td>
<td> 12 </td>
<td> Геометрия, поля-отступы элемента.
</td></tr>
<tr>
<td> tipTool </td>
<td> Помощь: подсказка </td>
<td> 15 </td>
<td> Текст краткой помощи или подсказки по данному элементу. Обычно реализуется как всплывающая подсказка, при удержании курсора мыши над элементом.
</td></tr>
<tr>
<td> tipStatus </td>
<td> Помощь: состояние </td>
<td> 16 </td>
<td>
<p>Текст информации о состоянии элемента или руководства к действию над элементом. Обычно реализуется в виде сообщения в строке статуса, при удержании курсора мыши над элементом. 
</p>
<dl><dd> * Модификация данного атрибута из сеанса корневой страницы осуществляет запись сообщения в строку статуса окна визуализации сеанса.</dd></dl>
</td></tr>
<tr>
<td> contextMenu </td>
<td> Контекстное меню </td>
<td> 17 </td>
<td>
<p>Контекстное меню в виде списка строк: "<b>{ItName}:{Signal}</b>".<br />
Где:
</p>
<ul><li> "ItName" — имя элемента;</li>
<li> "Signal" — имя сигнала, формирующегося при выборе: "<b>usr_{Signal}</b>". </li></ul>
</td></tr>
<tr>
<td> evProc </td>
<td> Обработка событий </td>
<td> - </td>
<td>
<p>Атрибут хранения сценария обработки событий непосредственного управления пользовательским интерфейсом. Сценарий представляет собой список команд интерфейсу визуализации, генерируемых при поступлении события (атрибут <b>event</b>). Прямая обработка событий для управления страницами в виде: "<b>{event}:{evSrc}:{com}:{prm}</b>". Где:
</p>
<ul><li> "event" — ожидаемое событие;</li>
<li> "evSrc" — источник события;</li>
<li> "com" — команда сеанса: open, next, prev;</li>
<li> "prm" — параметр команды, где используется:
<ul><li> pg_so — прямое имя желаемой страницы, с префиксом;</li>
<li> 1 — имя новой страницы в общем пути, без префикса;</li>
<li> * — имя страницы берётся из имени предыдущей страницы;</li>
<li> $ — указывает на место, относительно которого открывается страница.<br /></li></ul></li></ul>
<p>Примеры:
</p>
<ul><li> ws_BtPress:/prev:prev:/pg_so/*/*/$</li>
<li> ws_BtPress:/next:next:/pg_so/*/*/$</li>
<li> ws_BtPress:/go_mn:open:/pg_so/*/mn/*</li>
<li> ws_BtPress:/go_graph:open:/pg_so/*/ggraph </li></ul>
</td></tr>
<tr>
<td> <i>Дополнительные атрибуты элементов, помещённых в проект в роли страницы.</i>
</td></tr>
<tr>
<td> pgOpen </td>
<td> Страница: открыта </td>
<td> - </td>
<td>
<p>Признак "Страница открыта". 
</p>
<dl><dd> * Модификация из сеанса осуществляет немедленное открытие/закрытие данной страницы, но для страниц типа "Связь" Вы должны отдавать предпочтение использованию функции uiCmd() <a href="#UserAPI">пользовательского API</a>, для управления страницами. </dd></dl>
</td></tr>
<tr>
<td> pgNoOpenProc </td>
<td> Страница: обрабатывать закрытой </td>
<td> - </td>
<td> Признак "Исполнять страницу даже если она закрыта".
</td></tr>
<tr>
<td> pgOpenSrc </td>
<td> Страница: источник открытия </td>
<td> 3 </td>
<td>
<p>Полный адрес страницы, открывшей данную. 
</p>
<dl><dd> * Запись/очистка адреса виджета (инициатора открытия), осуществляет немедленное открытие/закрытие страницы. В случае записи адреса, и выполнения <a href="#DynLink">других условий</a>, осуществляется динамическое связывание текущего виджета с инициатором. Но для страниц типа "Связь" Вы должны отдавать предпочтение использованию функции uiCmd() <a href="#UserAPI">пользовательского API</a>, для управления страницами.</dd></dl>
</td></tr>
<tr>
<td> pgGrp </td>
<td> Страница: группа </td>
<td> 4 </td>
<td> Группа страницы.
</td></tr>
<tr>
<td colspan="4"> <i>Дополнительные атрибуты режима исполнения — сеанса.</i><br />(Виртуальные атрибуты не доступны в процедуре виджета)
</td></tr>
<tr>
<td> event </td>
<td> События </td>
<td> - </td>
<td> Специальный атрибут сбора событий виджета в списке, разделённом новой строкой. Доступ к атрибуту защищён критической секцией для избежания потери событий. Атрибут всегда доступен в процедуре виджета.
</td></tr>
<tr>
<td> load </td>
<td> Загрузка </td>
<td> -1 </td>
<td> Виртуальная команда групповой загрузки данных.
</td></tr>
<tr>
<td> focus </td>
<td> Фокус </td>
<td> -2 </td>
<td> Специальный атрибут индикации факта получения фокуса, активным виджетом. Атрибут этого виджета и вложенных виджетов доступен в процедурах виджета.
</td></tr>
<tr>
<td> perm </td>
<td> Доступ </td>
<td> -3 </td>
<td> Виртуальный атрибут прав активного пользователя на просмотр и контроль над виджетом.
</td></tr></table>
<dl><dd> * — Специальная функция атрибута виджета, выполняемая в сеансе проекта при пользовательской модификации.</dd></dl>
<p>Движок среды визуализации предусматривает активацию атрибутов, специфичных для визуализатора. Процесс активации осуществляется при открытии сеанса визуализации проекта и предусматривает, в этом проекте: создание специфичного атрибута с указанными свойствами, если он отсутствует, и активацию отслеживания его модификации движком среды визуализации, как для атрибутов формирования образов примитивов. Для непосредственного определения такого атрибута можно также использовать префикс идентификатора атрибута "vs_", что быстрее и исключает стадию активации. С перечнем специфичных для визуализатора атрибутов можно ознакомиться в документации соответствующего визуализатора.
</p>
<h4><span class="mw-headline" id=".D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.B0.D1.80.D0.BD.D0.B0.D1.8F_.D0.B3.D1.80.D0.B0.D1.84.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0_.28ElFigure.29"><span class="mw-headline-number">3.9.1</span> <span id="ElFigure" title="#ElFigure">Элементарная графическая фигура (ElFigure)</span></span></h4>
<p>Примитив является основой в отрисовке элементарных графических фигур со всевозможной их комбинацией в одном объекте. Учитывая широкий спектр всевозможных фигур, которые должен поддерживать примитив, и, в тоже время, являться достаточно простым в использовании и, по возможности, в реализации, было решено ограничить перечень базовых фигур, используемых для построения результирующих графических объектов, до таких: линия, дуга, кривая Безье и заливка замкнутых контуров. Основываясь уже на этих базовых фигурах, можно строить производные фигуры, комбинируя базовые. В рамках примитива существует возможность задания прозрачности цвета в диапазоне [0...255], где '0' — полная прозрачность.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитива "Элементарная фигура (ElFigure)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> lineWdth </td>
<td> Линия: ширина </td>
<td> 20 </td>
<td> Ширина линии.
</td></tr>
<tr>
<td> lineClr </td>
<td> Линия: цвет </td>
<td> 21 </td>
<td>
<p>Имя цвета в виде "<b>{color}[-{alpha}]</b>", где:
</p>
<ul><li> "color" — стандартное имя цвета или его числовое представление из трёх шестнадцатеричных чисел отдельных цветов "#RRGGBB";</li>
<li> "alpha" — уровень альфа-канала [0...255], где 0 — полностью прозрачный.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "red" — сплошной красный цвет;</li>
<li> "#FF0000" — сплошной красный цвет в цифровом коде;</li>
<li> "red-127" — полупрозрачный красный цвет.</li></ul>
</td></tr>
<tr>
<td> lineStyle </td>
<td> Линия: стиль </td>
<td> 22 </td>
<td> Стиль линии: сплошная, пунктир, точечная.
</td></tr>
<tr>
<td> bordWdth </td>
<td> Граница: ширина </td>
<td> 23 </td>
<td> Ширина бордюра линии. Нулевая ширина указывает на отсутствие бордюра.
</td></tr>
<tr>
<td> bordClr </td>
<td> Граница: цвет </td>
<td> 24 </td>
<td> Цвет бордюра (детали в атрибуте 21).
</td></tr>
<tr>
<td> fillColor </td>
<td> Заполнение: цвет </td>
<td> 25 </td>
<td> Цвет заливки (детали в атрибуте 21).
</td></tr>
<tr>
<td> fillImg </td>
<td> Заполнение: изображение </td>
<td> 26 </td>
<td>
<p>Имя изображения в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник изображения:
<ul><li> <i>file</i> — прямо из локального файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:backLogo" — из таблицы mime ресурсов БД для идентификатора "backLogo";</li>
<li> "backLogo" — как и предыдущий;</li>
<li> "file:/var/tmp/backLogo.png" — из локального файла по пути "/var/tmp/backLogo.png".</li></ul>
</td></tr>
<tr>
<td> orient </td>
<td> Угол поворота </td>
<td> 28 </td>
<td> Угол поворота содержимого виджета.
</td></tr>
<tr>
<td> mirror </td>
<td> Отражение </td>
<td> 29 </td>
<td> Отражение содержимого виджета, <span>ограничено на данный момент</span>.
</td></tr>
<tr>
<td> elLst </td>
<td> Список элементов </td>
<td> 27 </td>
<td>
<p>Список графических элементов в формате:
</p>
<ul><li> Линия. Общая форма записи в списке, для статических и динамических параметров (могут смешиваться):</li></ul>
<dl><dd><dl><dd>"<b>line:({x}|{y}):({x}|{y})[:{width}[:{color}[:{bord_w}[:{bord_clr}[:{line_stl}]]]]]</b>"</dd>
<dd>"<b>line:{p1}:{p2}[:w{n}[:c{n}[:w{n}[:c{n}[:s{n}]]]]]</b>"</dd></dl></dd></dl>
<ul><li> Дуга. Общая форма записи в списке, для статических и динамических параметров (могут смешиваться):</li></ul>
<dl><dd><dl><dd>"<b>arc:({x}|{y}):({x}|{y}):({x}|{y}):({x}|{y}):({x}|{y})[:{width}[:{color}[:{bord_w}[:{bord_clr}[:{line_stl}]]]]]</b>"</dd>
<dd>"<b>arc:{p1}:{p2}:{p3}:{p4}:{p5}[:w{n}[:c{n}[:w{n}[:c{n}[:s{n}]]]]]</b>"</dd></dl></dd>
<dd><a class="image" href="http://oscada.org/wiki/File:VCA_arc.png"><img alt="VCA arc.png" height="215" src="../../en/files/VCA_arc.png" width="164" /></a>
<dl><dd>p1, p2 — начальная и конечная точки эллиптической дуги, соответственно;</dd>
<dd>p3 — центр дуги;</dd>
<dd>p4 — первый радиус;</dd>
<dd>p5 — второй радиус.</dd></dl></dd></dl>
<ul><li> Кривая Безье. Форма записи в списке, для статических и динамических параметров (могут смешиваться):</li></ul>
<dl><dd><dl><dd>"<b>bezier:({x}|{y}):({x}|{y}):({x}|{y}):({x}|{y})[:{width}[:{color}[:{bord_w}[:{bord_clr}[:{line_stl}]]]]]</b>"</dd>
<dd>"<b>bezier:{p1}:{p2}:{p3}:{p4}[:w{n}[:c{n}[:w{n}[:c{n}[:s{n}]]]]]</b>"</dd></dl></dd></dl>
<ul><li> Заливка. Форма записи в списке, для статических и динамических параметров (могут смешиваться):</li></ul>
<dl><dd><dl><dd>"<b>fill:({x}|{y}):({x}|{y}):...:({x}|{y})[:{fill_clr}[:{fill_img}]]</b>"</dd>
<dd>"<b>fill:{p1}:{p2}:...:{pN}[:c{n}[:i{n}]]</b>"<br /></dd></dl></dd></dl>
<p>Где:
</p>
<dl><dd><i>x, y</i> — прямая точка (x,y), координаты в пикселах с плавающей точкой;</dd>
<dd><i>p1 ... pN</i> — динамическая точка 1...N;</dd>
<dd><i>width, bord_w</i> — прямая ширина линии и бордюра в пикселах с плавающей точкой;</dd>
<dd><i>w{n}</i> — динамическая ширина 'n';</dd>
<dd><i>color, bord_clr, fill_clr</i> — прямой цвет линии, бордюра и заполнения, в виде имени или 32-битного кода с альфа: {имя}[-{AAA}], #RRGGBB-AAA;</dd>
<dd><i>c{n}</i> — динамический цвет 'n';</dd>
<dd><i>line_stl</i> — прямой стиль линии: 0-Сплошная, 1-Пунктирная, 2-Точечная;</dd>
<dd><i>s{n}</i> — динамический стиль 'n';</dd>
<dd><i>fill_img</i> — прямое изображение заполнения в виде "[{src}%3A]{name}", где:
<dl><dd>"src" — источник изображения:
<dl><dd><i>file</i> — непосредственно из локального файла по пути;</dd>
<dd><i>res</i> — из таблицы mime-ресурсов БД.</dd></dl></dd>
<dd>"name" — путь файла или идентификатор mime-ресурса.</dd></dl></dd>
<dd><i>i{n}</i> — динамическое изображение заполнения 'n'.<br /></dd></dl>
<p>Например:
</p>
<ul><li> line:(50|25):(90.5|25):2:yellow:3:green:2</li>
<li> arc:(25|50):(25|50):1:4:(25|50)::#000000-0</li>
<li> fill:(25|50):(25|50):c2:i2</li>
<li> fill:(50|25):(90.5|25):(90|50):(50|50):#d3d3d3:h_31 </li></ul>
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты каждой точки из списка графических фигур <b>elLst</b></i>
</td></tr>
<tr>
<td> p{n}x </td>
<td> Точка {n}:x </td>
<td> 30+n*6 </td>
<td> Координата 'x' точки <i>n</i>.
</td></tr>
<tr>
<td> p{n}y </td>
<td> Точка {n}:y </td>
<td> 30+n*6+1 </td>
<td> Координата 'y' точки <i>n</i>.
</td></tr>
<tr>
<td> w{n} </td>
<td> Ширина {n} </td>
<td> 30+n*6+2 </td>
<td> Ширина <i>n</i>.
</td></tr>
<tr>
<td> с{n} </td>
<td> Цвет {n} </td>
<td> 30+n*6+3 </td>
<td> Цвет <i>n</i> (детали в атрибуте 21).
</td></tr>
<tr>
<td> i{n} </td>
<td> Изображение {n} </td>
<td> 30+n*6+4 </td>
<td> Изображение <i>n</i> (детали в атрибуте 26).
</td></tr>
<tr>
<td> s{n} </td>
<td> Стиль {n} </td>
<td> 30+n*6+5 </td>
<td> Стиль <i>n</i>.
</td></tr></table>
<h4><span class="mw-headline" id=".D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D1.84.D0.BE.D1.80.D0.BC.D1.8B_.28FormEl.29"><span class="mw-headline-number">3.9.2</span> <span id="FormEl" title="#FormEl">Элемент формы (FormEl)</span></span></h4>
<p>Примитив, предназначенный для предоставления, в распоряжение пользователя, стандартных элементов формы. Общий перечень атрибутов зависит от типа элемента.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитива "Элемент формы (FormEl)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> elType </td>
<td> Тип элемента </td>
<td> 20 </td>
<td> Тип элемента, от значения которого зависит перечень дополнительных атрибутов:
<ul><li> Строка редактирования</li>
<li> Редактор текста</li>
<li> Флажок</li>
<li> Кнопка</li>
<li> Выбор из списка (ComboBox)</li>
<li> Список</li>
<li> Дерево</li>
<li> Таблица</li>
<li> Слайдер</li>
<li> Полоса прокрутки</li></ul>
</td></tr>
<tr>
<td colspan="4"> <i>Строка редактирования:</i>
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td> Содержимое строки.
</td></tr>
<tr>
<td> view </td>
<td> Вид </td>
<td> 22 </td>
<td> Вид строки редактирования:
<ul><li> Текст</li>
<li> Комбобокс</li>
<li> Целое</li>
<li> Вещественное</li>
<li> Время</li>
<li> Дата</li>
<li> Дата и время</li>
<li> Пароль</li></ul>
</td></tr>
<tr>
<td> cfg </td>
<td> Конфигурация </td>
<td> 23 </td>
<td>
<p>Конфигурация строки. Формат значения данного поля для различных видов строки:
</p>
<dl><dd><i>Текст</i> — конфигурация форматированного ввода по шаблону с параметрами (поддерживается только Qt в <a href="../Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">UI.Vision</a>):
<dl><dd><dl><dd><b>A</b> — Необходим ASCII алфавитный символ, [A-Za-z].</dd>
<dd><b>a</b> — Разрешён, но не обязателен, ASCII алфавитный символ.</dd>
<dd><b>N</b> — Необходим ASCII алфавитно-цифровой символ, [A-Za-z0-9].</dd>
<dd><b>n</b> — Разрешён, но не обязателен, ASCII алфавитно-цифровой символ.</dd>
<dd><b>X</b> — Необходим любой символ.</dd>
<dd><b>x</b> — Разрешён, но не обязателен, любой символ.</dd>
<dd><b>9</b> — Необходима ASCII цифра, [0-9].</dd>
<dd><b>0</b> — Разрешёна, но не обязательна, ASCII цифра.</dd>
<dd><b>D</b> — Необходима ASCII цифра, [1-9].</dd>
<dd><b>d</b> — Разрешёна, но не обязательна, ASCII цифра.</dd>
<dd><b>#</b> — Разрешёны, но не обязательны, ASCII цифра или знаки плюс/минус.</dd>
<dd><b>H</b> — Необходим символ шестнадцатеричного числа, [A-Fa-f0-9].</dd>
<dd><b>h</b> — Разрешён, но не обязателен, символ шестнадцатеричного числа.</dd>
<dd><b>B</b> — Необходим бинарный символ, [0-1].</dd>
<dd><b>b</b> — Разрешён, но не обязателен, бинарный символ.</dd>
<dd><b>&gt;</b> — Все следующие алфавитные символы в верхнем регистре.</dd>
<dd><b>&lt;</b> — Все следующие алфавитные символы в нижнем регистре.</dd>
<dd><b>!</b> — Выключение преобразования регистра.</dd>
<dd><b>\\</b> — Используйте в разделителях, для экранирования специальных символов, которые перечислены.</dd></dl></dd></dl></dd>
<dd><i>Комбобокс</i> — список значений редактируемого комбо-бокса, по строкам.</dd>
<dd><i>Целое</i> — значение целого числа в форме: "<b>{Минимум}:{Максимум}:{ШагИзменения}:{Префикс}:{Суффикс}</b>".</dd>
<dd><i>Вещественное</i> — значение вещественного числа в форме: "<b>{Минимум}:{Максимум}:{ШагИзменения}:{Префикс}:{Суффикс}:{ЗнаковПослеТочки}</b>".</dd>
<dd><i>Время</i>, <i>Дата</i>, <i>Дата и время</i> — формировать дату по шаблону с параметрами:
<dl><dd><dl><dd><b>d</b> — номер дня (1-31);</dd>
<dd><b>dd</b> — номер дня (01-31);</dd>
<dd><b>ddd</b> — сокращённое наименование дня ("Mon" ... "Sun");</dd>
<dd><b>dddd</b> — полное наименование дня ("Monday" ... "Sunday");</dd>
<dd><b>M</b> — номер месяца (1-12);</dd>
<dd><b>MM</b> — номер месяца (01-12);</dd>
<dd><b>MMM</b> — сокращённое имя месяца ("Jan" ... "Dec");</dd>
<dd><b>MMMM</b> — полное имя месяца ("January" ... "December");</dd>
<dd><b>yy</b> — последние две цифры года;</dd>
<dd><b>yyyy</b> — год полностью;</dd>
<dd><b>h</b> — час (0-23);</dd>
<dd><b>hh</b> — час (00-23);</dd>
<dd><b>m</b> — минуты (0-59);</dd>
<dd><b>mm</b> — минуты (00-59);</dd>
<dd><b>s</b> — секунды (0-59);</dd>
<dd><b>ss</b> — секунды (00-59);</dd>
<dd><b>AP,ap</b> — отображать AM/PM или am/pm. </dd></dl></dd></dl></dd></dl>
</td></tr>
<tr>
<td> confirm </td>
<td> Подтверждать </td>
<td> 24 </td>
<td> Включение режима подтверждения.
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td>
<p>Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>", где:
</p>
<ul><li> "family" — семейство шрифта, для пробелов используйте символ '_', вроде: "Arial", "Courier", "Times_New_Roman";</li>
<li> "size" — размер шрифта в пикселях;</li>
<li> "bold" — усиление шрифта (0 или 1);</li>
<li> "italic" — наклонность шрифта (0 или 1);</li>
<li> "underline" — подчёркивание шрифта (0 или 1);</li>
<li> "strike" — перечёркивание шрифта (0 или 1).<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "Arial 10 1 0 0 0" — Arial шрифт размером 10 пикселей и усиленный. </li></ul>
</td></tr>
<tr>
<td colspan="4"> <i>Редактор текста:</i>
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td> Содержимое редактора.
</td></tr>
<tr>
<td> wordWrap </td>
<td> Перенос слов </td>
<td> 22 </td>
<td> Автоматический перенос текста по словам.
</td></tr>
<tr>
<td> confirm </td>
<td> Подтверждать </td>
<td> 24 </td>
<td> Включение режима подтверждения.
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td> Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>" (детали выше).
</td></tr>
<tr>
<td colspan="4"> <i>Флажок:</i>
</td></tr>
<tr>
<td> name </td>
<td> Имя </td>
<td> 26 </td>
<td> Имя/метка флажка.
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td> Значение флажка.
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td> Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>" (детали выше).
</td></tr>
<tr>
<td colspan="4"> <i>Кнопка:</i>
</td></tr>
<tr>
<td> name </td>
<td> Имя </td>
<td> 26 </td>
<td> Имя-надпись на кнопке. Допустимы символы '\n' для возможности ввода многострочных надписей.
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td>
<p>Значение, отличается для разных режимов:
</p>
<ul><li> "Стандарт" — параметры повтора событий при удержании <b>{задержка}-{интервал}</b>, время в миллисекундах;</li>
<li> "Переключатель" — значение переключателя;</li>
<li> "Меню" — список адресов элементов меню вида <b>/grp1/grp2/item1</b>;</li>
<li> "Загрузка" — строка описания <b>{ШаблонФайлов}|{Заголовок}|{ФайлПоУмолчаниюИЗагр}|{ФайлMime}</b> и содержимое загруженного файла. Шаблон файлов в виде "Изображение (*.png *.xpm *.jpg);;CSV-файл (*.csv)".</li>
<li> "Сохранение" — строка описания <b>{ШаблонФайлов}|{Заголовок}|{ФайлПоУмолчанию}|{ФайлMime}</b> и содержимое сохраняемого файла. Шаблон файлов как и выше.</li></ul>
</td></tr>
<tr>
<td> img </td>
<td> Изображение </td>
<td> 22 </td>
<td>
<p>Изображение на кнопке. Имя изображения в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник изображения:
<ul><li> <i>file</i> — прямо из локального файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:backLogo" — из таблицы mime ресурсов БД для идентификатора "backLogo";</li>
<li> "backLogo" — как и предыдущий;</li>
<li> "file:/var/tmp/backLogo.png" — из локального файла по пути "/var/tmp/backLogo.png". </li></ul>
</td></tr>
<tr>
<td> color </td>
<td> Цвет </td>
<td> 23 </td>
<td>
<p>Цвет кнопки. Имя цвета в виде "<b>{color}[-{alpha}]</b>", где:
</p>
<ul><li> "color" — стандартное имя цвета или его числовое представление из трёх шестнадцатеричных чисел отдельных цветов "#RRGGBB";</li>
<li> "alpha" — уровень альфа-канала [0...255], где 0 — полностью прозрачный.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "red" — сплошной красный цвет;</li>
<li> "#FF0000" — сплошной красный цвет в цифровом коде;</li>
<li> "red-127" — полупрозрачный красный цвет.</li></ul>
</td></tr>
<tr>
<td> colorText </td>
<td> Цвет: текст </td>
<td> 27 </td>
<td> Цвет текста (детали выше).
</td></tr>
<tr>
<td> mode </td>
<td> Режим </td>
<td> 24 </td>
<td>
<p>Режим работы кнопки:
</p>
<ul><li> "Стандарт" — обычная кнопка с возможностью повтора событий при удержании, параметры в "value";</li>
<li> "Переключатель" — кнопка с фиксацией, значение в "value";</li>
<li> "Меню" — открытие меню по нажатию, перечень элементов в "value";</li>
<li> "Загрузка" — организация пользовательской загрузки небольших файлов через интерфейс визуализации; при нажатии кнопки, в этом режиме, открывается диалог выбора файла загрузки, а содержимое выбранного файла загружается в атрибут "value";</li>
<li> "Сохранение" — организация пользовательского сохранения небольших файлов через интерфейс визуализации; при записи содержимого файла в атрибут "value" пользователю будет открыт диалог выбора/указания файла для сохранения, после выбора, содержимое атрибута "value" сохранится в файл, а "value" очистится.</li></ul>
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td> Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>" (детали выше).
</td></tr>
<tr>
<td colspan="4"> <i>Список:</i>
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td> Текущее значение списка.
</td></tr>
<tr>
<td> items </td>
<td> Элементы </td>
<td> 22 </td>
<td> Перечень элементов списка.
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td> Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>" (детали выше).
</td></tr>
<tr>
<td> mult </td>
<td> Множественный выбор </td>
<td> 23 </td>
<td> Разрешать выбор множества элементов списка.
</td></tr>
<tr>
<td colspan="4"> <i>Выбор из списка, Дерево:</i>
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td> Текущее значение списка.
</td></tr>
<tr>
<td> items </td>
<td> Элементы </td>
<td> 22 </td>
<td> Перечень элементов списка или иерархических элементов дерева в виде пути "<b>/{КАТ}/{КАТ}/{ЭЛЕМ}</b>".
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td> Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>" (детали выше).
</td></tr>
<tr>
<td colspan="4"> <i>Таблица:</i>
</td></tr>
<tr>
<td> set </td>
<td> Значение установки </td>
<td> 23 </td>
<td> Значение редактирования ячейки таблицы с адресом в событии "<b>ws_TableEdit_{colN}_{rowN}</b>".
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td>
<p>Адрес выбранного элемента. Изменение сопровождается событием "<b>ws_TableChangeSel</b>". Формат адреса зависит от режима выбора таблицы:
</p>
<ul><li> "Ячейка" — адрес ячейки в формате "<b>{row}:{col}</b>".</li>
<li> "Строка", "Колонка" — номер строки-колонки или содержимое ячейки ключа строки-колонки, указанной атрибутом "keyID".</li></ul>
</td></tr>
<tr>
<td> items </td>
<td> Элементы </td>
<td> 22 </td>
<td>
<p>Структура и содержимое таблицы в виде XML:
</p>
<pre style="white-space: pre-wrap;">
&lt;tbl&gt;
&lt;h&gt;&lt;s&gt;{Заголовок1}&lt;/s&gt;&lt;s&gt;{Заголовок2}&lt;/s&gt;&lt;/h&gt;
&lt;r&gt;&lt;s&gt;{Ряд1Колонка1Строка}&lt;/s&gt;&lt;i&gt;{Ряд1Колонка2Целое}&lt;/i&gt;&lt;/r&gt;
&lt;r&gt;&lt;b&gt;{Ряд2Колонка1Логическое}&lt;/b&gt;&lt;r&gt;{Ряд2Колонка2Вещественное}&lt;/r&gt;&lt;/r&gt;
&lt;/tbl&gt;</pre>
<p>Теги:
</p>
<dl><dd>"tbl" — Таблица, свойства таблицы в целом:
<ul><li> "sel" — режим выбора-выделения элементов таблицы: "row" — по строкам, "col" — по колонкам, "cell" — ячейками (по умолчанию);</li>
<li> "keyID" — номер ключевой строки-колонки, для получения значения выбора;</li>
<li> "colsWdthFit" — подстраивать размер колонок, размер которых не фиксирован, под заполнение всей ширины таблицы;</li>
<li> "hHdrVis", "vHdrVis" — установка видимости горизонтального, вертикального заголовков;</li>
<li> "sortEn" — включение прямой сортировки по колонкам.</li></ul></dd>
<dd>"h" — Строка заголовков, возможные атрибуты у тегов ячеек заголовка, для колонки в целом:
<ul><li> "width" — ширина колонки, в пикселях или процентах (10%);</li>
<li> "edit" — возможность редактирования (0 или 1) ячеек колонки, по умолчанию — нет (0);</li>
<li> "color" — цвет колонки, в целом, в виде имени цвета или его кода;</li>
<li> "colorText" — цвет текста колонки, в целом, в виде имени цвета или его кода;</li>
<li> "font" — шрифт текста колонки, в целом, в виде типовой строки OpenSCADA;</li>
<li> "sort" — сортировка по данной колонке [0 — по убыванию; 1 — по возрастанию].</li></ul></dd>
<dd>"r" — Строка значений, возможные атрибуты у тегов ячеек заголовка, для колонки в целом:
<ul><li> "color" — цвет строки, в целом, в виде имени цвета или его кода;</li>
<li> "colorText" — цвет текста строки, в целом, в виде имени цвета или его кода;</li>
<li> "font" — шрифт текста строки, в целом, в виде типовой строки OpenSCADA.</li></ul></dd>
<dd>"s", "i", "r", "b" — ячейки типов данных: "Строка", "Целое", "Вещественное" и "Логическое". Возможные атрибуты:
<ul><li> "color" — цвет ячейки;</li>
<li> "colorText" — цвет текста ячейки, в виде имени цвета или его кода;</li>
<li> "font" — шрифт текста ячейки, в виде типовой строки OpenSCADA;</li>
<li> "img" — изображение ячейки, в виде "<b>[{src}:]{name}</b>", детали выше;</li>
<li> "edit" — возможность редактирования (0 или 1) ячейки, по умолчанию — нет (0). </li></ul></dd></dl>
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td> Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>" (детали выше).
</td></tr>
<tr>
<td colspan="4"> <i>Слайдер и полоса прокрутки:</i>
</td></tr>
<tr>
<td> value </td>
<td> Значение </td>
<td> 21 </td>
<td> Положение слайдера.
</td></tr>
<tr>
<td> cfg </td>
<td> Конфигурация </td>
<td> 22 </td>
<td>
<p>Конфигурация слайдера в формате: "<b>{ВертОриент}:{Минимум}:{Максимум}:{ОдинШаг}:{СтрШаг}</b>".<br />
Где:
</p>
<ul><li> "ВертОриент" — признак вертикальной ориентации (0 или 1), по умолчанию ориентация горизонтальная;</li>
<li> "Минимум" — минимальное значение;</li>
<li> "Максимум" — максимальное значение;</li>
<li> "ОдинШаг" — размер одного шага;</li>
<li> "СтрШаг" — размер страничного шага. </li></ul>
</td></tr></table>
<h4><span class="mw-headline" id=".D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D1.82.D0.B5.D0.BA.D1.81.D1.82.D0.B0_.28Text.29"><span class="mw-headline-number">3.9.3</span> <span id="Text" title="#Text">Элемент текста (Text)</span></span></h4>
<p>Данный примитив предназначен для вывода простого и HTML текста, используемого в роли меток и различных подписей. С целью создания декоративных оформлений, примитив поддерживает обвод текста рамкой.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитива "Элемент текста (Text)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> backColor </td>
<td> Фон: цвет </td>
<td> 20 </td>
<td>
<p>Фоновый цвет. Имя цвета в виде "<b>{color}[-{alpha}]</b>", где:
</p>
<ul><li> "color" — стандартное имя цвета или его числовое представление из трёх шестнадцатеричных чисел отдельных цветов "#RRGGBB";</li>
<li> "alpha" — уровень альфа-канала [0...255], где 0 — полностью прозрачный.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "red" — сплошной красный цвет;</li>
<li> "#FF0000" — сплошной красный цвет в цифровом коде;</li>
<li> "red-127" — полупрозрачный красный цвет.</li></ul>
</td></tr>
<tr>
<td> backImg </td>
<td> Фон: изображение </td>
<td> 21 </td>
<td>
<p>Фоновое изображение. Имя изображения в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник изображения:
<ul><li> <i>file</i> — прямо из локального файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:backLogo" — из таблицы mime ресурсов БД для идентификатора "backLogo";</li>
<li> "backLogo" — как и предыдущий;</li>
<li> "file:/var/tmp/backLogo.png" — из локального файла по пути "/var/tmp/backLogo.png". </li></ul>
</td></tr>
<tr>
<td> bordWidth </td>
<td> Граница: ширина </td>
<td> 22 </td>
<td> Ширина бордюра.
</td></tr>
<tr>
<td> bordColor </td>
<td> Граница: цвет </td>
<td> 23 </td>
<td> Цвет бордюра (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> bordStyle </td>
<td> Граница: стиль </td>
<td> 24 </td>
<td> Стиль бордюра: "Нет", "Точечный", "Пунктирный", "Сплошной", "Двойной", "Канавка", "Кромка", "Вдавлен", "Выступающий".
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 25 </td>
<td>
<p>Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>", где:
</p>
<ul><li> "family" — семейство шрифта, для пробелов используйте символ '_', вроде: "Arial", "Courier", "Times_New_Roman";</li>
<li> "size" — размер шрифта в пикселях;</li>
<li> "bold" — усиление шрифта (0 или 1);</li>
<li> "italic" — наклонность шрифта (0 или 1);</li>
<li> "underline" — подчёркивание шрифта (0 или 1);</li>
<li> "strike" — перечёркивание шрифта (0 или 1).<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "Arial 10 1 0 0 0" — Arial шрифт размером 10 пикселей и усиленный.</li></ul>
</td></tr>
<tr>
<td> color </td>
<td> Цвет </td>
<td> 26 </td>
<td> Цвет текста (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> orient </td>
<td> Угол поворота </td>
<td> 27 </td>
<td> Ориентация текста, угол поворота.
</td></tr>
<tr>
<td> wordWrap </td>
<td> Перенос слов </td>
<td> 28 </td>
<td> Автоматический перенос текста по словам.
</td></tr>
<tr>
<td> alignment </td>
<td> Выравнивание </td>
<td> 29 </td>
<td> Выравнивание текста: "Вверху слева", "Вверху справа", "Вверху по центру", "Вверху по ширине", "Внизу слева", "Внизу справа", "Внизу по центру", "Внизу по ширине", "По центру слева", "По центру справа", "По середине", "По центру по ширине".
</td></tr>
<tr>
<td> inHtml </td>
<td> В HTML </td>
<td> 31 </td>
<td> Отображение и поддержка содержимого аргумента <i>text</i> в HTML.
</td></tr>
<tr>
<td> text </td>
<td> Текст </td>
<td> 30 </td>
<td> Значение текста. Используйте "<b>%{x}</b>" для помещения значения аргумента "x" (от 1).
</td></tr>
<tr>
<td> numbArg </td>
<td> Количество аргументов </td>
<td> 40 </td>
<td> Количество аргументов.
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты аргументов</i>
</td></tr>
<tr>
<td> arg{x}val </td>
<td> Аргумент {x}: значение </td>
<td> 50+10*x </td>
<td> Значение аргумента <i>x</i>.
</td></tr>
<tr>
<td> arg{x}tp </td>
<td> Аргумент {x}: тип </td>
<td> 50+10*x+1 </td>
<td> Тип аргумента <i>x</i>: "Целый", "Вещественный", "Строка".
</td></tr>
<tr>
<td> arg{x}cfg </td>
<td> Аргумент {x}: конфигурация </td>
<td> 50+10*x+2 </td>
<td>
<p>Конфигурация аргумента <i>x</i>:
</p>
<ul><li> "Строка": <b>{len}</b> — ширина строки;</li>
<li> "Вещественный": <b>{wdth};{form};{prec}</b> — ширина, форма ('g', 'e', 'f') и точность значения;</li>
<li> "Целый": <b>{len}</b> — ширина значения. </li></ul>
</td></tr></table>
<h4><span class="mw-headline" id=".D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D0.BE.D1.82.D0.BE.D0.B1.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BC.D0.B5.D0.B4.D0.B8.D0.B0-.D0.BC.D0.B0.D1.82.D0.B5.D1.80.D0.B8.D0.B0.D0.BB.D0.BE.D0.B2_.28Media.29"><span class="mw-headline-number">3.9.4</span> <span id="Media" title="#Media">Элемент отображения медиа-материалов (Media)</span></span></h4>
<p>Данный примитив предназначен для проигрывания различных медиа-материалов, начиная от простых изображений и заканчивая полноценными аудио и видео потоками.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитива "Элемент отображения медиа-материалов (Media)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> backColor </td>
<td> Фон: цвет </td>
<td> 20 </td>
<td>
<p>Фоновый цвет. Имя цвета в виде "<b>{color}[-{alpha}]</b>", где:
</p>
<ul><li> "color" — стандартное имя цвета или его числовое представление из трёх шестнадцатеричных чисел отдельных цветов "#RRGGBB";</li>
<li> "alpha" — уровень альфа-канала [0...255], где 0 — полностью прозрачный.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "red" — сплошной красный цвет;</li>
<li> "#FF0000" — сплошной красный цвет в цифровом коде;</li>
<li> "red-127" — полупрозрачный красный цвет.</li></ul>
</td></tr>
<tr>
<td> backImg </td>
<td> Фон: изображение </td>
<td> 21 </td>
<td>
<p>Фоновое изображение. Имя изображения в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник изображения:
<ul><li> <i>file</i> — прямо из локального файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:backLogo" — из таблицы mime ресурсов БД для идентификатора "backLogo";</li>
<li> "backLogo" — как и предыдущий;</li>
<li> "file:/var/tmp/backLogo.png" — из локального файла по пути "/var/tmp/backLogo.png". </li></ul>
</td></tr>
<tr>
<td> bordWidth </td>
<td> Граница: ширина </td>
<td> 22 </td>
<td> Ширина бордюра.
</td></tr>
<tr>
<td> bordColor </td>
<td> Граница: цвет </td>
<td> 23 </td>
<td> Цвет бордюра (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> bordStyle </td>
<td> Граница: стиль </td>
<td> 24 </td>
<td> Стиль бордюра: "Нет", "Точечный", "Пунктирный", "Сплошной", "Двойной", "Канавка", "Кромка", "Вдавлен", "Выступающий".
</td></tr>
<tr>
<td> src </td>
<td> Источник </td>
<td> 25 </td>
<td>
<p>Имя источника медиа в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник:
<ul><li> <i>file</i> — прямо из локального, визуализатор и движок, файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД;</li>
<li> <i>stream</i> — URL потока проигрывания видео или аудио.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:workMedia" — из таблицы mime ресурсов БД для идентификатора "workMedia";</li>
<li> "workMedia" — как и предыдущий;</li>
<li> "file:/var/tmp/workMedia.mng" — из локального файла по пути "/var/tmp/workMedia.mng";</li>
<li> "stream:http://localhost.localhost:5050" — проигрывание видео или аудио из URL.</li></ul>
</td></tr>
<tr>
<td> type </td>
<td> Тип </td>
<td> 27 </td>
<td>
<p>Тип медиа:
</p>
<ul><li> "Изображение" — растровое или векторное (может не поддерживаться) изображение, вроде: PNG, JPEG, GIF, SVG;</li>
<li> "Анимация" — простое анимированное изображение, вроде: GIF, MNG;</li>
<li> "Видео" — полное видео или поток, вроде: OGM, AVI, MKV, MPG, MP4;</li>
<li> "Аудио" — просто аудио или поток, вроде: OGG, MP3, WAV.</li></ul>
</td></tr>
<tr>
<td> areas </td>
<td> Области карты </td>
<td> 28 </td>
<td> Количество активных областей.
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты изображения (Image)</i>
</td></tr>
<tr>
<td> fit </td>
<td> Заполнять виджет </td>
<td> 26 </td>
<td> Признак "Согласовать содержимое с размером виджета".
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты анимации-видеоролика (Animation)</i>
</td></tr>
<tr>
<td> fit </td>
<td> Заполнять виджет </td>
<td> 26 </td>
<td> Признак "Согласовать содержимое с размером виджета".
</td></tr>
<tr>
<td> speed </td>
<td> Скорость проигрывания </td>
<td> 29 </td>
<td> Скорость проигрывания, в процентах от оригинальной скорости. Если значение меньше или равно 1% то проигрывание прекращается.
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты полноформатного видео (Full video)</i>
</td></tr>
<tr>
<td> play </td>
<td> Играть </td>
<td> 29 </td>
<td> Видео/аудио — "Играть".
</td></tr>
<tr>
<td> roll </td>
<td> Заворачивать проигрывание </td>
<td> 30 </td>
<td> Повторение проигрывания по завершению.
</td></tr>
<tr>
<td> pause </td>
<td> Пауза </td>
<td> 31 </td>
<td> Приостановить проигрывание.
</td></tr>
<tr>
<td> size </td>
<td> Размер </td>
<td> 32 </td>
<td> Общий размер видео, в миллисекундах.
</td></tr>
<tr>
<td> seek </td>
<td> Положение </td>
<td> 33 </td>
<td> Позиция проигрывания видео, в миллисекундах.
</td></tr>
<tr>
<td> volume </td>
<td> Громкость </td>
<td> 34 </td>
<td> Громкость звука [0...100].
</td></tr>
<tr>
<td colspan="4"> <i>Активные области</i>
</td></tr>
<tr>
<td> area{x}shp </td>
<td> Область {x}: образ </td>
<td> 40+3*x </td>
<td> Вид области <i>x</i>: "Квадрат", "Полилиния", "Окружность".
</td></tr>
<tr>
<td> area{x}coord </td>
<td> Область {x}: координаты </td>
<td> 40+3*x+1 </td>
<td> Координаты области <i>x</i>, через запятую идут координаты: "x1,y1,x2,y2,xN,yN".
</td></tr>
<tr>
<td> area{x}title </td>
<td> Область {x}: заголовок </td>
<td> 40+3*x+2 </td>
<td> Заголовок области <i>x</i>.
</td></tr></table>
<h4><span class="mw-headline" id=".D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D0.BF.D0.BE.D1.81.D1.82.D1.80.D0.BE.D0.B5.D0.BD.D0.B8.D1.8F_.D0.B4.D0.B8.D0.B0.D0.B3.D1.80.D0.B0.D0.BC.D0.BC_.28Diagram.29"><span class="mw-headline-number">3.9.5</span> <span id="Diagram" title="#Diagram">Элемент построения диаграмм (Diagram)</span></span></h4>
<p>Данный примитив предназначен для построения различных диаграмм во времени, включая графики-тренды отображения текущего процесса и архивных данных. Реализованы следующие типы диаграмм:
</p>
<ul><li> "График-тренд" — строит график значений параметра во времени.</li>
<li> "Спектр" — строит частотный спектр из значений параметров. Окно данных частотного спектра формируется исходя из размера виджета по горизонтали, в пикселях, и доступных данных параметров, наложенных на сетку горизонтального размера. В связи с этим, минимальная выделяемая частота определяется значением атрибута "tSize" — "<b>1/tSize</b>", а максимальная, половинной шириной графика в пикселях умноженной на минимальную частоту "<b>width/(2*tSize)</b>".</li>
<li> "XY" — строит двумерный график значений параметров, парами на график, где чётные по оси Y (0,2,4...) и нечётные по оси X (1,3,5...). Указанный временной диапазон данных используется в получении значений параметров оси X и Y, с последующим изображением.</li></ul>
<p>Для всех типов диаграмм возможно указание, в качестве источника данных:
</p>
<ul><li> параметра подсистемы "Сбор Данных";</li>
<li> архива значений;</li>
<li> прямого блока данных пользователя.</li></ul>
<p>Поддерживается режим слеживания за текущими значениями и значениями с архива, а также, возможно построение графиков параметров, не имеющих архива значений, путём накопления текущих значений в буфере диаграммы и только на момент активного отображения этой диаграммы.
</p><p>Процесс доступа к архивным данным оптимизирован путём ведения промежуточного буфера отображения, а также, упаковки трафика данных при запросе, путем приведения данных к качеству достаточного для отображения.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитива "Элемент построения диаграмм (Diagram)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> backColor </td>
<td> Фон: цвет </td>
<td> 20 </td>
<td>
<p>Фоновый цвет. Имя цвета в виде "<b>{color}[-{alpha}]</b>", где:
</p>
<ul><li> "color" — стандартное имя цвета или его числовое представление из трёх шестнадцатеричных чисел отдельных цветов "#RRGGBB";</li>
<li> "alpha" — уровень альфа-канала [0...255], где 0 — полностью прозрачный.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "red" — сплошной красный цвет;</li>
<li> "#FF0000" — сплошной красный цвет в цифровом коде;</li>
<li> "red-127" — полупрозрачный красный цвет.</li></ul>
</td></tr>
<tr>
<td> backImg </td>
<td> Фон: изображение </td>
<td> 21 </td>
<td>
<p>Фоновое изображение. Имя изображения в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник изображения:
<ul><li> <i>file</i> — прямо из локального файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:backLogo" — из таблицы mime ресурсов БД для идентификатора "backLogo";</li>
<li> "backLogo" — как и предыдущий;</li>
<li> "file:/var/tmp/backLogo.png" — из локального файла по пути "/var/tmp/backLogo.png". </li></ul>
</td></tr>
<tr>
<td> bordWidth </td>
<td> Граница: ширина </td>
<td> 22 </td>
<td> Ширина бордюра.
</td></tr>
<tr>
<td> bordColor </td>
<td> Граница: цвет </td>
<td> 23 </td>
<td> Цвет бордюра (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> bordStyle </td>
<td> Граница: стиль </td>
<td> 24 </td>
<td> Стиль бордюра: "Нет", "Точечный", "Пунктирный", "Сплошной", "Двойной", "Канавка", "Кромка", "Вдавлен", "Выступающий".
</td></tr>
<tr>
<td> trcPer </td>
<td> Период слежения, секунд </td>
<td> 25 </td>
<td> Режим и периодичность слежения.
</td></tr>
<tr>
<td> type </td>
<td> Тип </td>
<td> 26 </td>
<td> Тип диаграммы: "График", "Спектр", "XY".
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты, общие для всех типов</i>
</td></tr>
<tr>
<td> tSek </td>
<td> Время: секунды </td>
<td> 27 </td>
<td> Текущее время, секунд.
</td></tr>
<tr>
<td> tUSek </td>
<td> Время: микросекунды </td>
<td> 28 </td>
<td> Текущее время, микросекунды.
</td></tr>
<tr>
<td> tSize </td>
<td> Размер, секунды </td>
<td> 29 </td>
<td> Размер данных, секунды.
</td></tr>
<tr>
<td> curSek </td>
<td> Курсор: секунды </td>
<td> 30 </td>
<td> Положение курсора, секунды.
</td></tr>
<tr>
<td> curUSek </td>
<td> Курсор: микросекунды </td>
<td> 31 </td>
<td> Положение курсора, микросекунды.
</td></tr>
<tr>
<td> curColor </td>
<td> Курсор: цвет </td>
<td> 32 </td>
<td> Цвет курсора.
</td></tr>
<tr>
<td> sclColor </td>
<td> Шкала: цвет </td>
<td> 33 </td>
<td> Цвет шкалы-решетки (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> sclHor </td>
<td> Шкала: горизонтальная </td>
<td> 34 </td>
<td> Режим горизонтальной шкалы-решетки: "Не рисовать", "Решетка", "Маркеры", "Решетка и маркеры", "Решетка (лог)", "Маркеры (лог)", "Решетка и маркеры (лог)".
</td></tr>
<tr>
<td> sclHorScl </td>
<td> Шкала: гориз. масштаб (%) </td>
<td> 44 </td>
<td> Горизонтальный масштаб графика в процентах, исключительно для типа "XY".
</td></tr>
<tr>
<td> sclHorSclOff </td>
<td> Шкала: смещ. гориз. масштаба (%) </td>
<td> 45 </td>
<td> Смещение горизонтального маштаба в процентах, исключительно для типа "XY".
</td></tr>
<tr>
<td> sclVer </td>
<td> Шкала: вертикальная </td>
<td> 35 </td>
<td> Режим вертикальной шкалы-решетки: "Не рисовать", "Решетка", "Маркеры", "Решетка и маркеры", "Решетка (лог)", "Маркеры (лог)", "Решетка и маркеры (лог)".
</td></tr>
<tr>
<td> sclVerScl </td>
<td> Шкала: верт. масштаб (%) </td>
<td> 40 </td>
<td> Вертикальный масштаб графика в процентах.
</td></tr>
<tr>
<td> sclVerSclOff </td>
<td> Шкала: смещ. верт. масштаба (%) </td>
<td> 41 </td>
<td> Смещение вертикального масштаба в процентах.
</td></tr>
<tr>
<td> sclMarkColor </td>
<td> Шкала: Маркеры: цвет </td>
<td> 36 </td>
<td> Цвет маркеров шкалы-решетки (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> sclMarkFont </td>
<td> Шкала: Маркеры: шрифт </td>
<td> 37 </td>
<td>
<p>Шрифт маркеров шкалы-решетки. Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>", где:
</p>
<ul><li> "family" — семейство шрифта, для пробелов используйте символ '_', вроде: "Arial", "Courier", "Times_New_Roman";</li>
<li> "size" — размер шрифта в пикселях;</li>
<li> "bold" — усиление шрифта (0 или 1);</li>
<li> "italic" — наклонность шрифта (0 или 1);</li>
<li> "underline" — подчёркивание шрифта (0 или 1);</li>
<li> "strike" — перечёркивание шрифта (0 или 1).<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "Arial 10 1 0 0 0" — Arial шрифт размером 10 пикселей и усиленный.</li></ul>
</td></tr>
<tr>
<td> valArch </td>
<td> Архиватор значений </td>
<td> 38 </td>
<td> Архиватор значений в виде "<b>{МодульАрхивов}.{IdАрхиватора}</b>".
</td></tr>
<tr>
<td> valsForPix </td>
<td> Значений на пиксель </td>
<td> 42 </td>
<td> Количество значений на пиксель. Увеличить для расширения точности экспорта на больших интервалах времени.
</td></tr>
<tr>
<td> parNum </td>
<td> Количество параметров </td>
<td> 39 </td>
<td> Количество параметров, отображаемых на одном тренде.
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты типа: "График"</i>
</td></tr>
<tr>
<td> sclHorPer </td>
<td> Шкала: размер гор. решетки, секунды </td>
<td> 43 </td>
<td> Фиксированный период решётки горизонтальной шкалы — отключает автоматическое вычисление периода решётки. Активируется если количество периодов на общий размер более двух и размер одного периода не менее 15 пикселей.
</td></tr>
<tr>
<td colspan="4"> <i><u>Индивидуальные атрибуты параметров</u></i>
</td></tr>
<tr>
<td> prm{X}addr </td>
<td> Параметр {X}: адрес </td>
<td> 50+10*{X} </td>
<td>
<p>Полный адрес к атрибуту параметра <i>X</i> DAQ или архиву.<br />
Поддерживается прямая установка данных по префиксу:
</p>
<ul><li> "<b>data:{XMLNodeData}</b>" — изображение из прямо установленных данных;</li>
<li> "<b>line:{значение}</b>" — изображение горизонтальной линии по значению, не имеет смысла для типа "XY".<br /></li></ul>
<p>Пример:
</p>
<ul><li> "/DAQ/System/AutoDA/MemInfo/use" — адрес к атрибуту "use" параметра "MemInfo" объекта контроллера "AutoDA" DAQ модуля "System";</li>
<li> "/Archive/va_CPULoad_load" — адрес к архиву "CPULoad_load";</li>
<li> "data:&lt;d s="1" aprox="1" tm="1369465209" tm_grnd="1369465200" per="1"&gt;</li></ul>
<dl><dd>0 3.14</dd>
<dd>1 3.141</dd>
<dd>5 3.1415&lt;/d&gt;" — 10 секунд данных с периодом 1 секунда от "25.05.2013 10:00:00"; возможно "tm" и "tm_grnd" не указывать, в результате чего будут подставлены значения диапазона диаграммы, также, установкой атрибута "s", можно указать на время в секундах; "aprox" — аппроксимировать переход от одной точки к другой вместо подстановки предыдущего значения во все точки периодичности от упаковки;</dd></dl>
<ul><li> "line:3.14159265" — горизонтальная линия по значению "3.14159265".</li></ul>
</td></tr>
<tr>
<td> prm{X}bordL </td>
<td> Параметр {X}: граница отображ.: нижняя </td>
<td> 50+10*{X}+1 </td>
<td> Нижняя граница значений параметра <i>X</i>.
</td></tr>
<tr>
<td> prm{X}bordU </td>
<td> Параметр {X}: граница отображ.: верхняя </td>
<td> 50+10*{X}+2 </td>
<td> Верхняя граница значений параметра <i>X</i>.
</td></tr>
<tr>
<td> prm{X}color </td>
<td> Параметр {X}: цвет </td>
<td> 50+10*{X}+3 </td>
<td> Цвет отображения графика параметра <i>X</i> (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> prm{X}width </td>
<td> Параметр {X}: ширина </td>
<td> 50+10*{X}+6 </td>
<td> Ширина линии графика параметра <i>X</i>, в пикселях.
</td></tr>
<tr>
<td> prm{X}scl </td>
<td> Параметр {X}: шкала </td>
<td> 50+10*{X}+5 </td>
<td> Режим отдельной вертикальной шкалы параметра <i>X</i>: "Глобально", "Маркеры", "Решетка и маркеры", "Маркеры (лог)", "Решетка и маркеры (лог)".
</td></tr>
<tr>
<td> prm{X}val </td>
<td> Параметр {X}: значение </td>
<td> 50+10*{X}+4 </td>
<td> Значение параметра <i>X</i> под курсором, или на текущее время, для типа "XY".
</td></tr>
<tr>
<td> prm{X}prop </td>
<td> Параметр {X}: свойства </td>
<td> 50+10*{X}+7 </td>
<td> Свойства реального архива в виде "<b>{BegArh}:{EndArh}:{DataPeriod}</b>", где "BegArh", "EndArh", "DataPeriod" — начало, конец и период данных архива, в секундах, в вещественном представлении, вплоть до микросекунд (1e-6).
</td></tr></table>
<h4><span class="mw-headline" id=".D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D0.BF.D0.BE.D1.81.D1.82.D1.80.D0.BE.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D1.80.D0.BE.D1.82.D0.BE.D0.BA.D0.BE.D0.BB.D0.BE.D0.B2_.D0.BD.D0.B0_.D0.BE.D1.81.D0.BD.D0.BE.D0.B2.D0.B5_.D0.B0.D1.80.D1.85.D0.B8.D0.B2.D0.BE.D0.B2_.D1.81.D0.BE.D0.BE.D0.B1.D1.89.D0.B5.D0.BD.D0.B8.D0.B9_.28Protocol.29"><span class="mw-headline-number">3.9.6</span> <span id="Protocol" title="#Protocol">Элемент построения протоколов на основе архивов сообщений (Protocol)</span></span></h4>
<p>Данный примитив предназначен для визуализации данных архива сообщений путём формирования протоколов с различными способами визуализации, начиная от статического сканирующего просмотра и заканчивая динамическим слеживанием.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитива "Элемент построения протоколов на основе архивов сообщений (Protocol)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> backColor </td>
<td> Фон: цвет </td>
<td> 20 </td>
<td>
<p>Фоновый цвет. Имя цвета в виде "<b>{color}[-{alpha}]</b>", где:
</p>
<ul><li> "color" — стандартное имя цвета или его числовое представление из трёх шестнадцатеричных чисел отдельных цветов "#RRGGBB";</li>
<li> "alpha" — уровень альфа-канала [0...255], где 0 — полностью прозрачный.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "red" — сплошной красный цвет;</li>
<li> "#FF0000" — сплошной красный цвет в цифровом коде;</li>
<li> "red-127" — полупрозрачный красный цвет.</li></ul>
</td></tr>
<tr>
<td> backImg </td>
<td> Фон: изображение </td>
<td> 21 </td>
<td>
<p>Фоновое изображение. Имя изображения в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник изображения:
<ul><li> <i>file</i> — прямо из локального файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:backLogo" — из таблицы mime ресурсов БД для идентификатора "backLogo";</li>
<li> "backLogo" — как и предыдущий;</li>
<li> "file:/var/tmp/backLogo.png" — из локального файла по пути "/var/tmp/backLogo.png".</li></ul>
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 22 </td>
<td>
<p>Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>", где:
</p>
<ul><li> "family" — семейство шрифта, для пробелов используйте символ '_', вроде: "Arial", "Courier", "Times_New_Roman";</li>
<li> "size" — размер шрифта в пикселях;</li>
<li> "bold" — усиление шрифта (0 или 1);</li>
<li> "italic" — наклонность шрифта (0 или 1);</li>
<li> "underline" — подчёркивание шрифта (0 или 1);</li>
<li> "strike" — перечёркивание шрифта (0 или 1).<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "Arial 10 1 0 0 0" — Arial шрифт размером 10 пикселей и усиленный.</li></ul>
</td></tr>
<tr>
<td> headVis </td>
<td> Заголовок видим </td>
<td> 23 </td>
<td> Видимость заголовка таблицы.
</td></tr>
<tr>
<td> time </td>
<td> Время, секунды </td>
<td> 24 </td>
<td> Текущее время, секунды.
</td></tr>
<tr>
<td> tSize </td>
<td> Размер, секунды </td>
<td> 25 </td>
<td> Размер запроса данных, секунды. Установить значение в '0' для получения всех нарушений, для "lev" &lt; 0.
</td></tr>
<tr>
<td> trcPer </td>
<td> Период слежения, секунды </td>
<td> 26 </td>
<td> Режим и периодичность слежения.
</td></tr>
<tr>
<td> arch </td>
<td> Архиватор </td>
<td> 27 </td>
<td> Архиватор сообщений в виде "<b>{МодульАрхивов}.{IdАрхиватора}</b>".
</td></tr>
<tr>
<td> tmpl </td>
<td> Шаблон </td>
<td> 28 </td>
<td>
<p>Шаблон категории или регулярное выражение "<b>/{re}/</b>". Для шаблона зарезервированы символы:
</p>
<ul><li> '*' — множество любых, группа символов;</li>
<li> '?' — любой, один символ;</li>
<li> '\\' — используйте для экранирования специальных символов.</li></ul>
</td></tr>
<tr>
<td> lev </td>
<td> Уровень </td>
<td> 29 </td>
<td> Уровень сообщений. Установите значение &lt; 0 для получения текущих нарушений.
</td></tr>
<tr>
<td> viewOrd </td>
<td> Порядок отображения </td>
<td> 30 </td>
<td> Порядок отображения: "По времени", "По уровню", "По категории", "По сообщению", "По времени (обратно)", "По уровню (обратно)", "По категории (обратно)", "По сообщению (обратно)".
</td></tr>
<tr>
<td> col </td>
<td> Показать колонки </td>
<td> 31 </td>
<td>
<p>Список видимых и порядок колонок, разделённый символом ';'. Предусматриваются колонки:
</p>
<ul><li> "pos" — номер строки;</li>
<li> "tm" — дата и время сообщения;</li>
<li> "utm" — микросекундная часть времени сообщения;</li>
<li> "lev" — уровень сообщения;</li>
<li> "cat" — категория сообщения;</li>
<li> "mess" — текст сообщения. </li></ul>
</td></tr>
<tr>
<td> itProp </td>
<td> Свойства элемента </td>
<td> 32 </td>
<td> Количество свойств элемента.
</td></tr>
<tr>
<td colspan="4"> <i><u>Индивидуальные атрибуты свойств элемента</u></i>
</td></tr>
<tr>
<td> it{X}lev </td>
<td> Элемент {X}: уровень </td>
<td> 40+5*{X} </td>
<td> Критерий: уровень элемента <i>X</i> более или равно указанному.
</td></tr>
<tr>
<td> it{X}tmpl </td>
<td> Элемент {X}: шаблон </td>
<td> 40+5*{X}+1 </td>
<td> Критерий: шаблон категории элемента <i>X</i> (детальнее в атрибуте 28).
</td></tr>
<tr>
<td> it{X}fnt </td>
<td> Элемент {X}: шрифт </td>
<td> 40+5*{X}+2 </td>
<td> Шрифт элемента <i>X</i> (детальнее в атрибуте 22).
</td></tr>
<tr>
<td> it{X}сolor </td>
<td> Элемент {X}: цвет </td>
<td> 40+5*{X}+3 </td>
<td> Цвет элемента <i>X</i> (детальнее в атрибуте 20).
</td></tr></table>
<h4><span class="mw-headline" id=".D0.AD.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82_.D1.84.D0.BE.D1.80.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BE.D1.82.D1.87.D1.91.D1.82.D0.BD.D0.BE.D0.B9_.D0.B4.D0.BE.D0.BA.D1.83.D0.BC.D0.B5.D0.BD.D1.82.D0.B0.D1.86.D0.B8.D0.B8_.28Document.29"><span class="mw-headline-number">3.9.7</span> <span id="Document" title="#Document">Элемент формирования отчётной документации (Document)</span></span></h4>
<p>Примитив предназначен для формирования отчётной, оперативной и иной документации на основе шаблонов документов.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитиве "Элемент формирования отчётной документации (Document)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> style </td>
<td> CSS </td>
<td> 20 </td>
<td> Правила CSS в строках, вида "<b>body { background-color:#818181; }</b>".
</td></tr>
<tr>
<td> tmpl </td>
<td> Шаблон </td>
<td> 21 </td>
<td>
<p>Шаблон документа в XHTML, начиная с тега "body" и включая процедурные вставки:
</p>
<pre style="white-space: pre-wrap;">
&lt;body docProcLang="JavaLikeCalc.JavaScript"&gt;
  &lt;h1&gt;Значение&lt;?dp return wCod+1.314;?&gt;&lt;/h1&gt;
&lt;/body&gt;</pre> 
</td></tr>
<tr>
<td> doc </td>
<td> Документ </td>
<td> 22 </td>
<td> Финальный документ в XHTML, начинается с тега "body".
</td></tr>
<tr>
<td> font </td>
<td> Шрифт </td>
<td> 26 </td>
<td>
<p>Базовый шрифт текста документа. Имя шрифта в виде "<b>{family} {size} {bold} {italic} {underline} {strike}</b>", где:
</p>
<ul><li> "family" — семейство шрифта, для пробелов используйте символ '_', вроде: "Arial", "Courier", "Times_New_Roman";</li>
<li> "size" — размер шрифта в пикселях;</li>
<li> "bold" — усиление шрифта (0 или 1);</li>
<li> "italic" — наклонность шрифта (0 или 1);</li>
<li> "underline" — подчёркивание шрифта (0 или 1);</li>
<li> "strike" — перечёркивание шрифта (0 или 1).<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "Arial 10 1 0 0 0" — Arial шрифт размером 10 пикселей и усиленный.</li></ul>
</td></tr>
<tr>
<td> bTime </td>
<td> Время: начало </td>
<td> 24 </td>
<td> Время начала документа, секунды.
</td></tr>
<tr>
<td> time </td>
<td> Время: текущее </td>
<td> 23 </td>
<td> Время генерации документа, секунды. Записать время для генерации документа от этой точки или нуль для перегенерации.
</td></tr>
<tr>
<td> process </td>
<td> В процессе </td>
<td> 27 </td>
<td> Признак процесса формирования документа отдельным потоком.
</td></tr>
<tr>
<td> n </td>
<td> Размер архива </td>
<td> 25 </td>
<td> Количество документов или глубина архива.
</td></tr>
<tr>
<td colspan="4"> <i>Атрибуты включеного режима архивирования</i>
</td></tr>
<tr>
<td> aCur </td>
<td> Архив: курсор: текущий </td>
<td> - </td>
<td> Позиция текущего документа в архиве. Запись значения <i>&lt;0</i> производит архивацию текущего документа.
</td></tr>
<tr>
<td> vCur </td>
<td> Архив: курсор: вид </td>
<td> - </td>
<td>
<p>Текущий визуализируемый документ архива. Запись значения:
</p>
<ul><li> <i>-1</i> — выбор следующего документа;</li>
<li> <i>-2</i> — выбор предыдущего документа.</li></ul>
</td></tr>
<tr>
<td> aDoc </td>
<td> Архив: текущий документ </td>
<td> - </td>
<td> Текущий документ архива в XHTML, начинается с тега "body".
</td></tr>
<tr>
<td> aSize </td>
<td> Архив: размер </td>
<td> - </td>
<td> Реальный размер архива документа.
</td></tr></table>
<p>Возможности примитива "Документ":
</p>
<ul><li> Гибкое формирование структуры документа на основе языка гипертекстовой разметки, что предоставляет поддержку широких возможностей форматирования документов.</li>
<li> Формирование документов по команде или расписанию, что необходимо для формирования отчётной документации в архив, с последующим просмотром архива.</li>
<li> Формирование документов в режиме реального времени, для предоставления их полностью динамически и на основе архивов за указанное время.</li>
<li> Использование атрибутов виджета для передачи в документ значений и адресов на архивы, что позволяет использовать виджет документа как шаблон, при формировании отчётов с другими входными данными.</li></ul>
<p>В основе любого документа лежит XHTML-шаблон. XHTML-шаблон это тег "body" WEB-страницы, содержащий статику документа в стандарте XHTML 1.0 и элементы исполняемых инструкций на языке пользовательского программирования OpenSCADA, в виде <b>&lt;?dp {procedure}&nbsp;?&gt;</b>. Результирующий документ формируется путём исполнения процедур и вставки их результата в документ.
</p><p>Источником значений исполняемых инструкций являются атрибуты виджета этого примитива, а также все механизмы языка пользовательского программирования OpenSCADA. Атрибуты могут добавляться пользователем и линковаться на реальные атрибуты параметров или-же являться автономными, значения которых будут формироваться в процедуре виджета. В случае со слинкованными атрибутами, значения могут извлекаться из архива-истории.
</p><p>На рисунке изображена структурная схема виджета примитива "Документ". Согласно этой структуре, "Документ" содержит: XHTML-шаблон, результирующие документы и процедуру обработки данных. Источником данных процедуры и результирующих документов являются атрибуты виджета.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:556px;"><a class="image" href="http://oscada.org/wiki/File:VCA_document_ru.png"><img class="thumbimage" height="381" src="../files/VCA_document_ru.png" width="554" /></a>  <div class="thumbcaption">Рисунок. Структурная схема примитива "Документ".</div></div></div></div>
<p>Предусматривается работа виджета в двух режимах: "Динамический" и "Архивный". Отличием архивного режима является наличие архива указанной глубины и атрибутов, позволяющих управлять процессом архивирования и просмотра указанного документа в архиве.
</p><p>Генерация документа всегда производится в момент установки атрибута времени <i>time</i> относительно установленного ранее начального времени документа в атрибуте <i>bTime</i>. При выключенном архиве, результирующий документ помещается непосредственно в атрибут <i>doc</i>. При включенном архиве, результирующий документ помещается в ячейку под курсором, атрибут <i>aCur</i>, а так-же в <i>doc</i>, если значение курсора архива <i>aCur</i> и курсора визуализируемого документа <i>vCur</i> совпадают. Атрибуты архивных курсоров предусматривают несколько командных значений:
</p>
<ul><li> "aCur &lt; 0" — перемещает курсор архиватора на следующую позицию, тем самым оставляя предыдущий документ в архиве и очищая документ под курсором, если кольцевой архив замкнулся.</li>
<li> "vCur == -1" — выбор следующего документа для отображения, выбранный документ копируется в атрибут <i>doc</i>.</li>
<li> "vCur == -2" — выбор предыдущего документа для отображений, выбранный документ копируется в атрибут <i>doc</i>.</li></ul>
<p>Как было указано выше, динамика шаблона документа определяется вставками исполняемых инструкций вида "<b>&lt;?dp {procedure}&nbsp;?&gt;</b>". В процедурах могут использоваться одноимённые атрибуты виджета и функции пользовательского интерфейса программирования OpenSCADA. Кроме атрибутов виджета, зарезервированы специальные атрибуты, смотри таблицу.
</p><p><b>Таблица.</b> Специальные и зарезервированные элементы шаблона.
</p>
<table class="wikitable">

<tr>
<th> Имя </th>
<th> Назначение
</th></tr>
<tr>
<td colspan="2"> <i>Атрибуты</i>
</td></tr>
<tr>
<td> rez </td>
<td> Атрибут результата исполнения процедуры, содержимое которого помещается в дерево документа.
</td></tr>
<tr>
<td> lTime </td>
<td> Время последнего формирования. Если документ формируется впервые то <i>lTime</i> равен <i>bTime</i>.
</td></tr>
<tr>
<td> rTime </td>
<td> Содержит время перебираемых значений, секунды, определяется внутри тегов с атрибутом "docRept".
</td></tr>
<tr>
<td> rTimeU </td>
<td> Содержит время перебираемых значений, микросекунды, определяется внутри тегов с атрибутом "docRept".
</td></tr>
<tr>
<td> rPer </td>
<td> Содержит период перебора значений, атрибут "docRept".
</td></tr>
<tr>
<td> mTime, mTimeU, mLev, mCat, mVal </td>
<td>
<p>Определяются внутри тегов с атрибутом "docAMess" при разборе сообщений архива сообщений:
</p>
<dl><dd><i>mTime</i> — время сообщения, секунды;</dd>
<dd><i>mTimeU</i> — время сообщения, микросекунды;</dd>
<dd><i>mLev</i> — уровень сообщения;</dd>
<dd><i>mCat</i> — категория сообщения;</dd>
<dd><i>mVal</i> — значение сообщения.</dd></dl>
</td></tr>
<tr>
<td colspan="2"> <i>Специальные теги</i>
</td></tr>
<tr>
<td colspan="2"> <i>Специальные атрибуты стандартных тегов</i>
</td></tr>
<tr>
<td> body.docProcLang </td>
<td> Язык исполняемых процедур документа, по умолчанию это "JavaLikeCalc.JavaScript".
</td></tr>
<tr>
<td> *.docRept="1s" </td>
<td> Тег с указанным атрибутом размножается, при формировании, путём смещения времени в атрибуте "rTime" на значение, указанное в данном атрибуте.
</td></tr>
<tr>
<td> *.docAMess="1:PLC*" </td>
<td> Указывает на необходимость размножения тега с атрибутом, сообщениями из архива сообщений за указанный интервал времени, согласно уровня "1" и шаблона запроса "PLC*", по категории сообщения. В шаблоне запроса могут указываться <a class="extiw" href="https://en.wikipedia.org/wiki/Regular_expression" title="wikipedia:Regular expression">регулярные выражения</a> в виде "<b>/{re}/</b>". Для данного тега, в процессе размножения, определяются атрибуты: "mTime", "mTimeU", "mLev", "mCat" и "mVal".
</td></tr>
<tr>
<td> *.docAMessArchs="ArchMod0.Archivator0[;ArchModN.ArchivatorN]" </td>
<td> Дополняет атрибут "*.docAMess" перечнем архиваторов для чтения сообщений.
</td></tr>
<tr>
<td> *.docRevers="1" </td>
<td> Указывает на инвертирование порядка размножения — последний сверху.
</td></tr>
<tr>
<td> *.docAppend="1" </td>
<td> Признак необходимости добавления результата выполнения процедуры в тег процедуры. Иначе результат исполнения заменяет содержимое тега.
</td></tr>
<tr>
<td> body.docTime </td>
<td> Время формирования документа, используется для установки атрибута <i>lTime</i> при следующем формировании документа. Не устанавливается пользователем!
</td></tr>
<tr>
<td> table.export="1" </td>
<td> Включение возможности экспорта содержимого указанной таблицы в CSV-файл и другие табличные форматы.
</td></tr></table>
<h4><span class="mw-headline" id=".D0.9A.D0.BE.D0.BD.D1.82.D0.B5.D0.B9.D0.BD.D0.B5.D1.80_.28Box.29"><span class="mw-headline-number">3.9.8</span> <span id="Box" title="#Box">Контейнер (Box)</span></span></h4>
<p>Примитив контейнера, используется для формирования составных виджетов и/или страниц пользовательского интерфейса.
</p><p><b>Таблица.</b> Набор дополнительных свойств/атрибутов примитива "Контейнер (Box)"
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Номер </th>
<th> Значение
</th></tr>
<tr>
<td> pgOpenSrc </td>
<td> Страница: источник открытия </td>
<td> 3 </td>
<td> Полный адрес страницы, которая включена внутрь данного контейнера.
</td></tr>
<tr>
<td> pgGrp </td>
<td> Страница: группа </td>
<td> 4 </td>
<td> Группа контейнера страниц.
</td></tr>
<tr>
<td> backColor </td>
<td> Фон: цвет </td>
<td> 20 </td>
<td>
<p>Фоновый цвет. Имя цвета в виде "<b>{color}[-{alpha}]</b>", где:
</p>
<ul><li> "color" — стандартное имя цвета или его числовое представление из трёх шестнадцатеричных чисел отдельных цветов "#RRGGBB";</li>
<li> "alpha" — уровень альфа-канала [0...255], где 0 — полностью прозрачный.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "red" — сплошной красный цвет;</li>
<li> "#FF0000" — сплошной красный цвет в цифровом коде;</li>
<li> "red-127" — полупрозрачный красный цвет.</li></ul>
</td></tr>
<tr>
<td> backImg </td>
<td> Фон: изображение </td>
<td> 21 </td>
<td>
<p>Фоновое изображение. Имя изображения в виде "<b>[{src}:]{name}</b>", где:
</p>
<ul><li> "src" — источник изображения:
<ul><li> <i>file</i> — прямо из локального файла по пути;</li>
<li> <i>res</i> — из таблицы mime ресурсов БД.</li></ul></li>
<li> "name" — путь файла или идентификатор mime-ресурса.<br /></li></ul>
<p>Примеры:
</p>
<ul><li> "res:backLogo" — из таблицы mime ресурсов БД для идентификатора "backLogo";</li>
<li> "backLogo" — как и предыдущий;</li>
<li> "file:/var/tmp/backLogo.png" — из локального файла по пути "/var/tmp/backLogo.png". </li></ul>
</td></tr>
<tr>
<td> bordWidth </td>
<td> Граница: ширина </td>
<td> 22 </td>
<td> Ширина бордюра.
</td></tr>
<tr>
<td> bordColor </td>
<td> Граница: цвет </td>
<td> 23 </td>
<td> Цвет бордюра (детальнее в атрибуте 20).
</td></tr>
<tr>
<td> bordStyle </td>
<td> Граница: стиль </td>
<td> 24 </td>
<td> Стиль бордюра: "Нет", "Точечный", "Пунктирный", "Сплошной", "Двойной", "Канавка", "Кромка", "Вдавлен", "Выступающий".
</td></tr></table>
<p><br />
</p>
<h3><span class="mw-headline" id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.91.D0.94_.D0.B4.D0.BB.D1.8F_.D1.85.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F_.D0.B1.D0.B8.D0.B1.D0.BB.D0.B8.D0.BE.D1.82.D0.B5.D0.BA_.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.BE.D0.B2_.D0.B8_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"><span class="mw-headline-number">3.10</span> Использование БД для хранения библиотек виджетов и проектов</span></h3>
<p>Хранение данных виджетов, библиотек виджетов и проектов реализовано в БД, доступных OpenSCADA. БД организована по принадлежности данных к библиотеке-проекту. Т.е. отдельная библиотека-проект хранится в отдельной группе таблиц БД. Перечень библиотек виджетов хранится в индексной таблице библиотек с именем "VCALibs" и структурой "Libs", а перечень проектов в индексной таблице "VCAPrjs" и структурой "Projs". Экземпляр этих таблиц создаётся в каждой БД, где хранятся данные этого модуля. В состав таблиц, принадлежащих библиотеке виджетов и проекту, входят следующие:
</p>
<ul><li> "<b>{DB_TBL}</b>" — таблица виджетов, принадлежащих библиотеке (структура "LibWigets"), или страниц, принадлежащих проекту (структура "ProjPages");</li>
<li> "<b>{DB_TBL}_io</b>" — таблица рабочих свойств виджетов и вложенных виджетов библиотеки (структура "LibWidgetIO") или свойств страниц проектов (структура "ProjPageIO");</li>
<li> "<b>{DB_TBL}_uio</b>" — таблица пользовательских свойств виджетов и вложенных виджетов этой библиотеки (структура "LibWidgetUserIO") или пользовательских свойств страниц (структура "ProjPageUserIO");</li>
<li> "<b>{DB_TBL}_incl</b>" — таблица виджетов, вложенных в виджеты-контейнеры, библиотеки (структура "LibWidgetIncl") или проекта (структура "ProjPageWIncl");</li>
<li> "<b>{DB_TBL}_mime</b>" — таблица ресурсов библиотеки и её виджетов (структура "LibWidgetMime"), или проекта и его страниц (структура "ProjMime");</li>
<li> "<b>{DB_TBL}_stl</b>" — таблица значений стилевых параметров проекта (структура "PrjStlIO");</li>
<li> "<b>{DB_TBL}_ses</b>" — таблица данных режима исполнения проекта, т.е. сеансов (структура "PrjSesIO").</li></ul>
<p>Проекции (структуры) основных таблиц таковы:
</p>
<ul><li> <b>Libs(<u>ID</u>, NAME, DSCR, DB_TBL, ICO)</b> — библиотеки виджетов <i>ID</i>.</li></ul>
<dl><dd><dl><dd><i>ID</i> — идентификатор;</dd>
<dd><i>NAME</i> — имя;</dd>
<dd><i>DSCR</i> — описание;</dd>
<dd><i>DB_TBL</i> — корень таблиц БД с виджетами;</dd>
<dd><i>ICO</i> — закодированное (Base64) изображение иконки библиотеки.</dd></dl></dd></dl>
<ul><li> <b>LibWigets(<u>ID</u>, ICO, PARENT, PROC, PROC_PER, ATTRS, TIMESTAMP)</b> — виджеты <i>ID</i> библиотеки.</li></ul>
<dl><dd><dl><dd><i>ID</i> — идентификатор;</dd>
<dd><i>ICO</i> — закодированное (Base64) изображение иконки виджета;</dd>
<dd><i>PARENT</i> — адрес виджета основы, в виде <i>/wlb_originals/wdg_Box</i>;</dd>
<dd><i>PROC</i> — внутренняя процедура и язык процедуры виджета;</dd>
<dd><i>PROC_PER</i> — период вычисления процедуры виджета;</dd>
<dd><i>ATTRS</i> — перечень атрибутов виджета, модифицированных пользователем;</dd>
<dd><i>TIMESTAMP</i> — метка времени последней модификации.</dd></dl></dd></dl>
<ul><li> <b>LibWidgetIO(<u>IDW</u>, <u>ID</u>, <u>IDC</u>, IO_VAL, SELF_FLG, CFG_TMPL, CFG_VAL)</b> — рабочие атрибуты <i>ID</i> виджета <i>IDW</i> дочернего виджета <i>IDC</i>.</li></ul>
<dl><dd><dl><dd><i>IDW</i> — идентификатор виджета;</dd>
<dd><i>ID</i> — идентификатор атрибута;</dd>
<dd><i>IDC</i> — идентификатор дочернего виджета;</dd>
<dd><i>IO_VAL</i> — значение атрибута;</dd>
<dd><i>SELF_FLG</i> — внутренние флаги атрибутов;</dd>
<dd><i>CFG_TMPL</i> — шаблон элемента конфигурации, основанного на данном атрибуте;</dd>
<dd><i>CFG_VAL</i> — значение элемента конфигурации (ссылка, константа ...).</dd></dl></dd></dl>
<ul><li> <b>LibWidgetUserIO(<u>IDW</u>, <u>ID</u>, <u>IDC</u>, NAME, IO_TP, IO_VAL, SELF_FLG, CFG_TMPL, CFG_VAL)</b> — пользовательские атрибуты <i>ID</i> виджета <i>IDW</i> дочернего виджета <i>IDC</i>.</li></ul>
<dl><dd><dl><dd><i>IDW</i> — идентификатор виджета;</dd>
<dd><i>ID</i> — идентификатор атрибута;</dd>
<dd><i>IDC</i> — идентификатор дочернего виджета;</dd>
<dd><i>NAME</i> — имя атрибута;</dd>
<dd><i>IO_TP</i> — тип и главные флаги атрибута;</dd>
<dd><i>IO_VAL</i> — значение атрибута;</dd>
<dd><i>SELF_FLG</i> — внутренние флаги атрибута;</dd>
<dd><i>CFG_TMPL</i> — шаблон элемента конфигурации, основанного на данном атрибуте;</dd>
<dd><i>CFG_VAL</i> — значение элемента конфигурации (ссылка, константа ...).</dd></dl></dd></dl>
<ul><li> <b>LibWidgetIncl(<u>IDW</u>, <u>ID</u>, PARENT, ATTRS)</b> — включенные в контейнер <i>IDW</i> виджеты <i>ID</i>.</li></ul>
<dl><dd><dl><dd><i>IDW</i> — идентификатор виджета;</dd>
<dd><i>ID</i> — идентификатор экземпляра вложенного виджета;</dd>
<dd><i>PARENT</i> — адрес виджета основы, в виде <i>/wlb_originals/wdg_Box</i>;</dd>
<dd><i>ATTRS</i> — перечень атрибутов виджета, модифицированных пользователем.</dd></dl></dd></dl>
<ul><li> <b>LibWidgetMime(<u>ID</u>, MIME, DATA)</b> — audio, video, media и другие ресурсы виджетов <i>ID</i> библиотеки.</li></ul>
<dl><dd><dl><dd><i>ID</i> — идентификатор ресурса;</dd>
<dd><i>MIME</i> — Mime тип данных ресурса, в формате — "<b>{mimeType};{Size}</b>";</dd>
<dd><i>DATA</i> — данные ресурса, кодированные Base64.</dd></dl></dd></dl>
<ul><li> <b>Projs(<u>ID</u>, NAME, DSCR, DB_TBL, ICO, USER, GRP, PERMIT, PER, FLGS, STYLE)</b> — проекты <i>ID</i> интерфейса визуализации.</li></ul>
<dl><dd><dl><dd><i>ID</i> — идентификатор проекта;</dd>
<dd><i>NAME</i> — имя проекта;</dd>
<dd><i>DSCR</i> — описание проекта;</dd>
<dd><i>DB_TBL</i> — корень таблиц БД со страницами;</dd>
<dd><i>ICO</i> — закодированное (Base64) изображение иконки проекта;</dd>
<dd><i>USER</i> — имя владельца проекта;</dd>
<dd><i>GRP</i> — имя группы пользователей проекта;</dd>
<dd><i>PERMIT</i> — права доступа к проекту;</dd>
<dd><i>PER</i> — период вычисления проекта, в миллисекундах;</dd>
<dd><i>FLGS</i> — флаги проекта;</dd>
<dd><i>STYLE</i> — типовой стиль проекта.</dd></dl></dd></dl>
<ul><li> <b>ProjPages(<u>OWNER</u>, <u>ID</u>, ICO, PARENT, PROC, PROC_PER, FLGS, ATTRS, TIMESTAMP)</b> — страницы <i>ID</i>, содержащиеся в проекте-странице <i>OWNER</i>.</li></ul>
<dl><dd><dl><dd><i>OWNER</i> — проект-страница — владелец данной страницы, в виде — "/AGLKS/so/1/gcadr";</dd>
<dd><i>ID</i> — идентификатор страницы;</dd>
<dd><i>ICO</i> — закодированное (Base64) изображение иконки страницы;</dd>
<dd><i>PARENT</i> — адрес виджета основы, в виде <i>/wlb_originals/wdg_Box</i>;</dd>
<dd><i>PROC</i> — внутренняя процедура и язык процедуры страницы;</dd>
<dd><i>PROC_PER</i> — период вычисления процедуры страницы;</dd>
<dd><i>FLGS</i> — флаги типов страницы;</dd>
<dd><i>ATTRS</i> — перечень атрибутов страницы, модифицированных пользователем;</dd>
<dd><i>TIMESTAMP</i> — метка времени последней модификации.</dd></dl></dd></dl>
<ul><li> <b>ProjPageIO(<u>IDW</u>, <u>ID</u>, <u>IDC</u>, IO_VAL, SELF_FLG, CFG_TMPL, CFG_VAL)</b> — рабочие атрибуты страниц, структура фактически совпадает с таблицей "LibWidgetIO".</li>
<li> <b>ProjPageUserIO(<u>IDW</u>, <u>ID</u>, <u>IDC</u>, NAME, IO_TP, IO_VAL, SELF_FLG, CFG_TMPL, CFG_VAL)</b> — пользовательские атрибуты страниц, структура фактически совпадает с таблицей "LibWidgetUserIO".</li>
<li> <b>ProjPageWIncl(<u>IDW</u>, <u>ID</u>, PARENT, ATTRS)</b> — виджеты, включенные на страницы, структура фактически совпадает с таблицей "LibWidgetIncl".</li>
<li> <b>ProjMime(<u>ID</u>, MIME, DATA)</b> — audio, video, media и другие ресурсы страниц проектов, структура фактически совпадает с таблицей "LibWidgetMime".</li>
<li> <b>PrjStl(<u>ID</u>, V_0, V_1, V_2, V_3, V_4, V_5, V_6, V_7, V_8, V_9)</b> — значения поля стиля <i>ID</i> проекта.</li></ul>
<dl><dd><dl><dd><i>ID</i> — идентификатор поля стиля;</dd>
<dd><i>V_{N}</i> — значение поля стиля для стиля <i>N</i>.</dd></dl></dd></dl>
<ul><li> <b>ProjSess(<u>IDW</u>, <u>ID</u>, IO_VAL)</b> — таблица проекта <i>IDW</i> для хранения данных сеансов, исполняющих проект.</li></ul>
<dl><dd><dl><dd><i>IDW</i> — полный путь элемента проекта;</dd>
<dd><i>ID</i> — атрибут элемента;</dd>
<dd><i>IO_VAL</i> — значение атрибута.</dd></dl></dd></dl>
<p><br />
</p>
<h3><span class="mw-headline" id="API_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.B8_.D1.81.D0.B5.D1.80.D0.B2.D0.B8.D1.81.D0.BD.D1.8B.D0.B5_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D1.8B_OpenSCADA"><span class="mw-headline-number">3.11</span> <span id="UserAPI" title="#UserAPI">API пользовательского программирования и сервисные интерфейсы OpenSCADA</span></span></h3>
<h4><span class="mw-headline" id="API_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F"><span class="mw-headline-number">3.11.1</span> <span id="UserAPI" title="#UserAPI">API пользовательского программирования</span></span></h4>
<p>API пользовательского программирования движка визуализации непосредственно представлено объектами OpenSCADA, формирующие пользовательский интерфейс, а именно "Сеансом" и "Виджетами-страницами". Для пользователя эти объекты предоставляют набор функций управления:
</p>
<div class="floatright"><a class="image" href="http://oscada.org/wiki/File:Oscada_UserOM_VCAEngine_ru.png" title="Объектная модель пользователя модуля VCAEngine."><img alt="Объектная модель пользователя модуля VCAEngine." height="238" src="../files/Oscada_UserOM_VCAEngine_ru.png" width="364" /></a></div>
<p><b>Объект "Сеанс" ( this.ownerSess() )</b>
</p>
<ul><li> <i>string user( )</i> — текущий пользователь сеанса.</li>
<li> <i>int alrmQuietance( int quit_tmpl, string wpath = "", bool ret = false )</i> — квитирует нарушение <i>wpath</i> с шаблоном <i>quit_tmpl</i>. Если <i>wpath</i> это пустая строка то производится глобальное квитирование. В строке <i>wpath</i>, через символ ';', могут быть перечислены адреса нескольких виджетов. При установке <i>ret</i> осуществляется возврат квитирования.</li>
<li> <i>int reqTm( )</i> — время последнего запроса в секундах от эпохи 1.1.1970.</li>
<li> <i>string reqUser( )</i> — пользователь последнего запроса.</li>
<li> <i>string reqLang( )</i> — язык последнего запроса.</li>
<li> <i>int userActTm( )</i> — время последнего действия пользователя в секундах от эпохи 1.1.1970.</li>
<li> <i>bool uiCmd( string cmd, string prm, string src )</i> — отправляет UI команду управления страницами, как: "open", "next", "prev"; детальнее смотрите в <a href="#Events">секции сообщений</a>. Эта функция должна быть приоритетной для использования при контроле страницами перед прямой записью в атрибут страниц "pgOpen" и "pgOpenSrc" поскольку это единственный метод корректной работы с <a href="#Project">линкованными страницами</a>.</li></ul>
<p><b>Объект "Виджет" (this)</b>
</p>
<ul><li> <i>TCntrNodeObj ownerSess( )</i> — объект сеанса данного виджета.</li>
<li> <i>TCntrNodeObj ownerPage( )</i> — объект родительской страницы данного виджета.</li>
<li> <i>TCntrNodeObj ownerWdg( bool base = false )</i> — объект родительского виджета данного виджета. При указании <i>base</i> будут возвращены и объекты страниц.</li>
<li> <i>TCntrNodeObj wdgAdd( string wid, string wname, string parent )</i> — добавляет виджет <i>wid</i> с именем <i>wname</i> на основе библиотечного виджета <i>parent</i>.</li></ul>
<pre style="white-space: pre-wrap; margin-left: 15px">
//Добавляет новый виджет на основе виджета текстового примитива
nw = this.wdgAdd("nw", "Новый виджет", "/wlb_originals/wdg_Text");
nw.attrSet("geomX", 50).attrSet("geomY", 50);
</pre>
<ul><li> <i>bool wdgDel( string wid )</i> — удаляет виджет <i>wid</i>.</li>
<li> <i>TCntrNodeObj wdgAt( string wid, bool byPath = false )</i> — подключается к дочернему или глобальному виджету, посредством пути <i>byPath</i>. В случае глобального подключения можно использовать абсолютный или относительный путь к виджету. Точкой отсчёта абсолютного адреса выступает объект корня модуля "VCAEngine", а значит, первым элементом абсолютного адреса является идентификатор сеанса, который опускается. Относительный адрес берёт отсчёт от текущего виджета. Специальным элементом относительного адреса является элемент вышестоящего узла "..".</li>
<li> <i>Array attrList()</i> — перечень атрибутов виджета.</li>
<li> <i>bool attrPresent( string attr )</i> — проверяет атрибут виджета <i>attr</i> на факт присутствия.</li>
<li> <i>ElTp attr( string attr, bool fromSess = false )</i> — значение атрибута виджета <i>attr</i> или из сеанса <i>fromSess</i>. Для отсутствующих атрибутов возвращается пустая строка.</li>
<li> <i>TCntrNodeObj attrSet( string attr, ElTp vl, bool toSess = false )</i> — устанавливает значение <i>vl</i> в атрибут виджета <i>attr</i> или в сеанс, для <i>toSess</i>. Возвращает текущий объект, для конкатенации функций установки.</li>
<li> <i>string link( string attr, bool prm = false )</i> — ссылка атрибута виджета <i>attr</i>. При установке <i>prm</i> запрашивает ссылку группы атрибутов (параметр), представленную указанным атрибутом.</li>
<li> <i>string linkSet( string attr, string vl, bool prm = false )</i> — устанавливает ссылку атрибута виджета <i>attr</i>. При установке <i>prm</i> осуществляется установка ссылки группы атрибутов (параметр), представленной указанным атрибутом.</li></ul>
<pre style="white-space: pre-wrap; margin-left: 15px">
//Устанавливает ссылку восьмого тренда параметром
this.linkSet("el8.name", "prm:/LogicLev/experiment/Pi", true);
</pre>
<ul><li> <i>string mime( string addr, string type = "" )</i> — "mime" объект по адресу <i>addr</i> (прямая ссылка на ресурс или атрибут виджета с этой ссылкой) с типом в <i>type</i>, из таблицы сеанса или источника. Предназначено для редактирования "mime" объекта и подстановки его в контексте сеанса, например, изображений SVG.</li>
<li> <i>int mimeSet( string addr, string data, string type = "" )</i> — устанавливает "mime" объект в <i>data</i> с типом <i>type</i> по адресу <i>addr</i>.</li>
<li> <i>int messDebug( string mess ); int messInfo( string mess ); int messNote( string mess ); int messWarning( string mess ); int messErr( string mess ); int messCrit( string mess ); int messAlert( string mess ); int messEmerg( string mess );</i> — формирует сообщения программы <i>mess</i> с категорией — путь к данному виджету.</li></ul>
<p><b>Объект "Виджет", примитива "Документ" (this)</b>
</p>
<ul><li> <i>string getArhDoc( int nDoc)</i> — текст документа архива на глубине <i>nDoc</i> (0-{aSize-1}).</li></ul>
<p><br />
Устаревшее, но поддерживаемое, API представляется группой функций непосредственно в модуле движка СВУ. Вызов этих функций из процедуры виджета может осуществляться прямо по идентификатору, поскольку их область имён определяется в контексте процедур виджетов.
</p><p><b>Список виджетов (WdgList)</b><br />
<i>Описание:</i> Возвращает список виджетов, в контейнере виджетов, или дочерних виджетов. Если установлено <i>pg</i>, то возвращается список страниц проектов и сеанса.<br />
<i>Параметры:</i>
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Тип </th>
<th> Режим </th>
<th> По умолчанию
</th></tr>
<tr>
<td> list </td>
<td> Список </td>
<td> Строка </td>
<td> Возврат </td>
<td>
</td></tr>
<tr>
<td> addr </td>
<td> Адрес </td>
<td> Строка </td>
<td> Вход </td>
<td>
</td></tr>
<tr>
<td> pg </td>
<td> Страницы </td>
<td> Логический </td>
<td> Вход </td>
<td> 0
</td></tr></table>
<p><b>Присутствие узла (NodePresent)</b><br />
<i>Описание:</i> Проверка узла на присутствие, включая виджеты, атрибуты и другие.<br />
<i>Параметры:</i>
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Тип </th>
<th> Режим </th>
<th> По умолчанию
</th></tr>
<tr>
<td> rez </td>
<td> Результат </td>
<td> Логический </td>
<td> Возврат </td>
<td>
</td></tr>
<tr>
<td> addr </td>
<td> Адрес </td>
<td> Строка </td>
<td> Вход </td>
<td>
</td></tr></table>
<p><b>Список атрибутов (AttrList)</b><br />
<i>Описание:</i> Возвращает список атрибутов виджета. Если установлен <i>noUser</i> тогда возвращаются только не пользовательские атрибуты.<br />
<i>Параметры:</i>
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Тип </th>
<th> Режим </th>
<th> По умолчанию
</th></tr>
<tr>
<td> list </td>
<td> Список </td>
<td> Строка </td>
<td> Возврат </td>
<td>
</td></tr>
<tr>
<td> addr </td>
<td> Адрес </td>
<td> Строка </td>
<td> Вход </td>
<td>
</td></tr>
<tr>
<td> noUser </td>
<td> Без пользовательских </td>
<td> Логический </td>
<td> Вход </td>
<td> 1
</td></tr></table>
<p><b>Получить атрибут (AttrGet)</b><br />
<i>Описание:</i> Запрос значения атрибута виджета. Запрос может осуществляться как указанием полного адреса атрибута в <i>addr</i>, так и: отдельно адрес виджета в <i>addr</i> и идентификатор атрибута в <i>attr</i>.<br />
<i>Параметры:</i>
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Тип </th>
<th> Режим </th>
<th> По умолчанию
</th></tr>
<tr>
<td> val </td>
<td> Значение </td>
<td> Строка </td>
<td> Возврат </td>
<td>
</td></tr>
<tr>
<td> addr </td>
<td> Адрес </td>
<td> Строка </td>
<td> Вход </td>
<td>
</td></tr>
<tr>
<td> attr </td>
<td> Атрибут </td>
<td> Логический </td>
<td> Вход </td>
<td>
</td></tr></table>
<p><b>Установить атрибут (AttrSet)</b><br />
<i>Описание:</i> Установка значения атрибута виджета. Установка может осуществляться как указанием полного адреса атрибута в <i>addr</i>, так и: отдельно адрес виджета в <i>addr</i> и идентификатор атрибута в <i>attr</i>.<br />
<i>Параметры:</i>
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Тип </th>
<th> Режим </th>
<th> По умолчанию
</th></tr>
<tr>
<td> addr </td>
<td> Адрес </td>
<td> Строка </td>
<td> Вход </td>
<td>
</td></tr>
<tr>
<td> val </td>
<td> Значение </td>
<td> Строка </td>
<td> Вход </td>
<td>
</td></tr>
<tr>
<td> attr </td>
<td> Атрибут </td>
<td> Логический </td>
<td> Вход </td>
<td>
</td></tr></table>
<p><b>Пользователь сеанса (SesUser)</b><br />
<i>Описание:</i> Возвращает пользователя сеанса по пути к виджету сеанса.<br />
<i>Параметры:</i>
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Тип </th>
<th> Режим </th>
<th> По умолчанию
</th></tr>
<tr>
<td> user </td>
<td> Пользователь </td>
<td> Строка </td>
<td> Возврат </td>
<td>
</td></tr>
<tr>
<td> addr </td>
<td> Адрес </td>
<td> Строка </td>
<td> Вход </td>
<td>
</td></tr></table>
<h4><span class="mw-headline" id=".D0.A1.D0.B5.D1.80.D0.B2.D0.B8.D1.81.D0.BD.D1.8B.D0.B5_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D1.8B_OpenSCADA"><span class="mw-headline-number">3.11.2</span> Сервисные интерфейсы OpenSCADA</span></h4>
<p>Сервисные интерфейсы это интерфейсы доступа к OpenSCADA посредством <a href="../../en/API.html#CntrNode" title="Special:MyLanguage/Documents/API">интерфейса управления OpenSCADA</a>. Данный механизм положен в основу всех механизмов обмена внутри OpenSCADA, реализованных посредством слабых связей и стандартного протокола обмена OpenSCADA.
</p>
<h5><span class="mw-headline" id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC_.D0.B0.D1.82.D1.80.D0.B8.D0.B1.D1.83.D1.82.D0.BE.D0.B2_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.BE.D0.B2_.D0.B2.D0.B8.D0.B7.D1.83.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8_.28.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D1.8B.29"><span class="mw-headline-number">3.11.2.1</span> Доступ к значениям атрибутов элементов визуализации (виджеты)</span></h5>
<p>С целью предоставления унифицированного, группового и сравнительно быстрого доступа к значениям атрибутов визуальных элементов, предусмотрена сервисная функция визуального элемента "/serv/attr" и команды получения-установки значений атрибутов:
</p>
<ul><li> получение: <b>&lt;get path="/UI/VCAEngine/{wdg_addr}/%2fserv%2fattr"/&gt;</b>;</li>
<li> установка: <b>&lt;set path="/UI/VCAEngine/{wdg_addr}/%2fserv%2fattr"/&gt;</b>.</li></ul>
<p><b>Таблица.</b> Атрибуты команд получения и установки атрибутов визуальных элементов
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Значение
</th></tr>
<tr>
<td colspan="3"> <i>Команда запроса визуальных атрибутов виджета: <b>&lt;get path="/UI/VCAEngine/{wdg_addr}/%2fserv%2fattr"/&gt;</b></i>
</td></tr>
<tr>
<td> tm </td>
<td> Время-счётчик изменений </td>
<td> Установка времени-счётчика изменений для запроса только изменившихся атрибутов.
</td></tr>
<tr>
<td> &lt;el id="{attr}" p="{a_id}"&gt;{val}&lt;/el&gt; </td>
<td> Формирование дочерних элементов с результатами атрибутов </td>
<td> В дочернем элементе указываются: строковых идентификатор <i>attr</i>, индекс <i>a_id</i> и значение <i>val</i> атрибута.
</td></tr>
<tr>
<td colspan="3"> <i>Команда установки визуальных атрибутов виджета: <b>&lt;set path="/UI/VCAEngine/{wdg_addr}/%2fserv%2fattr"/&gt;</b></i>
</td></tr>
<tr>
<td> &lt;el id="{attr}"&gt;{val}&lt;/el&gt; </td>
<td> Установка атрибутов </td>
<td> В дочерних элементах указывается: строковый идентификатор <i>attr</i> и значение <i>val</i> атрибута.
</td></tr>
<tr>
<td colspan="3"> <i>Команда активации-создания специфичного для визуализатора атрибута: <b>&lt;activate path="/UI/VCAEngine/{wdg_addr}/%2fserv%2fattr/{attrId}" aNm="{Name}" aTp="{Type} aFlg="{Flags}"/&gt;</b></i>
</td></tr>
<tr>
<td> attrId </td>
<td> Идентификатор атрибута </td>
<td>
</td></tr>
<tr>
<td> aNm </td>
<td> Имя атрибута </td>
<td>
</td></tr>
<tr>
<td> aTp </td>
<td> Тип атрибута </td>
<td>
</td></tr>
<tr>
<td> aFlg </td>
<td> Флаги атрибута </td>
<td>
</td></tr></table>
<h5><span class="mw-headline" id=".D0.93.D1.80.D1.83.D0.BF.D0.BF.D0.BE.D0.B2.D0.BE.D0.B9_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC_.D0.B0.D1.82.D1.80.D0.B8.D0.B1.D1.83.D1.82.D0.BE.D0.B2_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.BE.D0.B2_.D0.B2.D0.B8.D0.B7.D1.83.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8_.28.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.B0.D0.BC.29"><span class="mw-headline-number">3.11.2.2</span> Групповой доступ к значениям атрибутов элементов визуализации (виджетам)</span></h5>
<p>С целью оптимизации трафика сетевого взаимодействия путём исключения мелких запросов и использования одного большого, предусмотрен групповой запрос значений атрибутов визуальных элементов. Группировка данного запроса подразумевает запрос атрибутов всей ветви виджета, включая и вложенные элементы. Для данного запроса предусмотрена сервисная команда "/serv/attrBr". Запрос данной сервисной команды эквивалентен сервисной команде "/serv/attr" и выглядит следующим образом:<br />
<b>&lt;get path="/UI/VCAEngine/{wdg_addr}/%2fserv%2fattrBr"/&gt;</b>
</p>
<dl><dd><i>tm</i> — время-счётчик изменений. Установка времени-счётчика изменений для запроса только изменившихся атрибутов.<br /></dd></dl>
<p>Результат:
</p>
<dl><dd><i>&lt;el id="{attr}" p="{a_id}"&gt;{val}&lt;/el&gt;</i> — элементы с результатами атрибутов. В элементе указываются: строковый идентификатор <i>attr</i>, индекс <i>a_id</i> и значение <i>val</i> атрибута.</dd>
<dd><i>&lt;w id="{wid}" lnkPath="{lnk_path}"&gt;{childs+attrs}&lt;/w&gt;</i> — элементы с дочерними виджетами и их атрибутами. В элементе указываются: идентификатор дочернего виджета <i>wid</i> и путь виджета, на который ссылается данный виджет если он является ссылкой <i>lnk_path</i>.</dd></dl>
<h5><span class="mw-headline" id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D0.B0.D0.BC_.D1.81.D0.B5.D0.B0.D0.BD.D1.81.D0.B0"><span class="mw-headline-number">3.11.2.3</span> Доступ к страницам сеанса</span></h5>
<p>С целью унификации и оптимизации доступа к страницам, предусмотрена сервисная функция сеанса "/serv/pg" и команды:
</p>
<ul><li> запрос перечня открытых страниц: <b>&lt;openlist path="/UI/VCAEngine/ses_{Session}/%2fserv%2fpg"/&gt;</b>;</li>
<li> открытие страницы: <b>&lt;open path="/UI/VCAEngine/ses_{Session}/%2fserv%2fpg"/&gt;</b>;</li>
<li> закрытие страницы: <b>&lt;close path="/UI/VCAEngine/ses_{Session}/%2fserv%2fpg"/&gt;</b>.</li></ul>
<p>Результатом запроса перечня открытых страниц являются дочерние элементы <b>&lt;el&gt;{OpPage}&lt;/el&gt;</b>, содержащие полный путь открытой страницы. Кроме перечня открытых страниц запрос возвращает значение текущего счётчика вычисления сеанса, в атрибуте <i>tm</i>. Если данный атрибут устанавливается при запросе, то, для каждой открытой страницы, возвращается список изменённых, с момента указанного значения счётчика, виджетов открытой страницы.
</p>
<h5><span class="mw-headline" id=".D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.B8.D0.B3.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B5.D0.B9"><span class="mw-headline-number">3.11.2.4</span> Управление сигнализацией</span></h5>
<p>Для предоставления механизма глобального контроля за сигнализацией сеанса, предусмотрена сервисная функция сеанса "/serv/alarm" и команды:
</p>
<ul><li> запрос статуса сигналов: <b>&lt;get path="/UI/VCAEngine/ses_{Session}/%2fserv%2falarm"/&gt;</b>;</li>
<li> квитирование сигналов: <b>&lt;quietance path="/UI/VCAEngine/ses_{Session}/%2fserv%2falarm"/&gt;</b>.</li></ul>
<p>Запрос статуса сигналов возвращает обобщённое состояние сигналов, а также ресурс уведомления, если атрибут "mode" равен "resource". Результатом запроса ресурса уведомления, обычно, является звуковой файл, для воспроизведения. В это-же время, обеспечивается отслеживание последовательности сигнализации и квитации отдельных ресурсов сообщений.
</p><p>Запрос на квитацию выполняет квитацию, указанного в атрибуте <i>wdg</i>, виджета, согласно шаблону в атрибуте <i>tmpl</i>.
</p>
<h5><span class="mw-headline" id=".D0.9C.D0.B0.D0.BD.D0.B8.D0.BF.D1.83.D0.BB.D1.8F.D1.86.D0.B8.D1.8F_.D1.81.D0.B5.D0.B0.D0.BD.D1.81.D0.B0.D0.BC.D0.B8_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.BE.D0.B2"><span class="mw-headline-number">3.11.2.5</span> Манипуляция сеансами проектов</span></h5>
<p>Для предоставления унифицированного механизма манипуляции сеансами, модулем движка СВУ (VCAEngine), для визуализаторов СВУ, предусмотрена сервисная функция "/serv/sess" и команды:
</p>
<ul><li> запроса перечня открытых сеансов: <b>&lt;list path="/UI/VCAEngine/%2fserv%2fsess"/&gt;</b>;</li>
<li> подключения-создания нового сеанса: <b>&lt;connect path="/UI/VCAEngine/%2fserv%2fsess"/&gt;</b>; </li>
<li> отключения-удаления сеанса: <b>&lt;disconnect path="/UI/VCAEngine/%2fserv%2fsess"/&gt;</b>.</li></ul>
<p><b>Таблица.</b> Атрибуты команд механизма манипуляции сеансами
</p>
<table class="wikitable">

<tr>
<th> Идентификатор </th>
<th> Имя </th>
<th> Значение
</th></tr>
<tr>
<td colspan="3"> <i>Команда запроса перечня открытых сеансов для проекта: <b>&lt;list path="/UI/VCAEngine/%2fserv%2fsess"/&gt;</b></i>
</td></tr>
<tr>
<td> prj </td>
<td> Указание проекта </td>
<td> Указывает проект, для которого возвращать перечень открытых сеансов.
</td></tr>
<tr>
<td> &lt;el&gt;{Session}&lt;/el&gt; </td>
<td> Контроль перечня сеансов </td>
<td> В дочерних элементах указываются сеансы, открытые для запрошенного проекта.
</td></tr>
<tr>
<td colspan="3"> <i>Команда подключения-открытия сеанса: <b>&lt;connect path="/UI/VCAEngine/%2fserv%2fsess"/&gt;</b></i>
</td></tr>
<tr>
<td> sess </td>
<td> Установка и контроль имени сеанса </td>
<td> Если атрибут определён, то производится подключение к существующему сеансу, иначе — создание нового сеанса. В случае открытия нового сеанса, в данный атрибут помещается его имя.
</td></tr>
<tr>
<td> prj </td>
<td> Установка имени проекта </td>
<td> Используется для открытия нового сеанса для указанного проекта и когда атрибут <i>sess</i> не указан.
</td></tr>
<tr>
<td colspan="3"> <i>Команда отключения-закрытия сеанса: <b>&lt;disconnect path="/UI/VCAEngine/%2fserv%2fsess"/&gt;</b></i>
</td></tr>
<tr>
<td> sess </td>
<td> Установка имени сеанса </td>
<td> Указывает имя сеанса от которого выполняется отключение или закрытие. Сеансы, не являющиеся фоновыми, и к которым ни один из визуализаторов не подключен, автоматически закрываются.
</td></tr></table>
<h5><span class="mw-headline" id=".D0.93.D1.80.D1.83.D0.BF.D0.BF.D0.BE.D0.B2.D0.BE.D0.B9_.D0.B7.D0.B0.D0.BF.D1.80.D0.BE.D1.81_.D0.B4.D0.B5.D1.80.D0.B5.D0.B2.D0.B0_.D0.B1.D0.B8.D0.B1.D0.BB.D0.B8.D0.BE.D1.82.D0.B5.D0.BA_.D0.B2.D0.B8.D0.B4.D0.B6.D0.B5.D1.82.D0.BE.D0.B2"><span class="mw-headline-number">3.11.2.6</span> Групповой запрос дерева библиотек виджетов</span></h5>
<p>С целью оптимизации производительности локального и, особенно, сетевого взаимодействия, предусмотрена сервисная функция "/serv/wlbBr" и команда запроса дерева библиотек виджетов: <b>&lt;get path="/UI/VCAEngine/%2fserv%2fwlbBr"/&gt;</b>. Результатом запроса является дерево с элементами библиотек виджетов — теги <i>wlb</i>. Внутри тегов библиотек виджетов содержаться тег иконки <i>ico</i> и теги виджетов библиотеки <i>w</i>. Теги виджетов, в свою очередь, содержат тег иконки и теги дочерних виджетов <i>cw</i>.
</p><p><br />
</p>
<h2><span class="mw-headline" id=".D0.9A.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D1.8F_.D0.BF.D0.BE.D1.81.D1.80.D0.B5.D0.B4.D1.81.D1.82.D0.B2.D0.BE.D0.BC_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D0.B0_.D1.83.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F_OpenSCADA"><span class="mw-headline-number">4</span> Конфигурация модуля посредством интерфейса управления OpenSCADA</span></h2>
<p>Посредством интерфейса управления OpenSCADA компоненты, которые его используют, можно конфигурировать из любого конфигуратора OpenSCADA. Данным модулем предоставляется интерфейс доступа ко всем объектам данных СВУ. Главная вкладка конфигурационной страницы модуля предоставляет доступ к библиотекам виджетов и проектам (рис.4.1). Вкладка "Сеансы" предоставляет доступ и открытым сеансам проектов (рис.4.2).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:761px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_main_ru.png"><img class="thumbimage" height="577" src="../files/VCAeng_main_ru.png" width="759" /></a>  <div class="thumbcaption">Рис.4.1. Главная конфигурационная страница модуля.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:742px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_sess_ru.png"><img class="thumbimage" height="563" src="../files/VCAeng_sess_ru.png" width="740" /></a>  <div class="thumbcaption">Рис.4.2. Вкладка "Сеансы" конфигурационной страницы модуля.</div></div></div></div>
<p>Кроме списка открытых сеансов, вкладка на рисунке 4.2 содержит таблицу с перечнем сеансов, которые должны создаваться и запускаться в момент загрузки OpenSCADA. Создание сеансов посредством этого механизма может быть полезным для Web-интерфейса. В таком случае, при подключении Web-пользователя, все данные уже готовы и обеспечивается непрерывность формирования архивных документов.
</p><p>Конфигурация контейнеров виджетов, в лице библиотек виджетов и проектов, выполняется посредством страниц на рисунке 4.3 (для проекта) и рисунке 4.5 (для библиотеки виджетов). Библиотека виджетов содержит виджеты, а проект — страницы. Оба типа контейнера содержат вкладку конфигурации Mime-данных, используемых виджетами (рис.4.6). Страница проекта, также, содержит вкладку "Диагностика" (рис.4.4) для отладки и контроля за исполнением страницы в сеансах.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:922px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_pg_ru.png"><img class="thumbimage" height="661" src="../files/VCAeng_pg_ru.png" width="920" /></a>  <div class="thumbcaption">Рис.4.3. Страница конфигурации проектов.</div></div></div></div>
<p>С помощью этой страницы можно установить:
</p>
<ul><li> Состояние контейнера, а именно: "Включен", имя БД (содержащей конфигурацию), дата и время последней модификации, счётчик использования.</li>
<li> Идентификатор, имя, описание и иконка контейнера.</li>
<li> Владелец, группа пользователей и права доступа к элементу.</li>
<li> Период вычисления сеансов, основанных на данном проекте.</li>
<li> Признак включения по надобности.</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:996px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_pg_diag_ru.png"><img class="thumbimage" height="563" src="../files/VCAeng_pg_diag_ru.png" width="994" /></a>  <div class="thumbcaption">Рис.4.4. Вкладка "Диагностика" проекта.</div></div></div></div>
<p>В этой вкладке Вы можете выбрать время (или обновить к текущему) и размер для получения диагностических сообщений сеансов исполнения данного проекта.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:775px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_wlb_ru.png"><img class="thumbimage" height="578" src="../files/VCAeng_wlb_ru.png" width="773" /></a>  <div class="thumbcaption">Рис.4.5. Страница конфигурации библиотек виджетов.</div></div></div></div>
<p>С помощью этой страницы можно установить:
</p>
<ul><li> Состояние контейнера, а именно: "Включен", имя БД (содержащей конфигурацию) дата и время последней модификации, счётчик использования.</li>
<li> Идентификатор, имя, описание и иконка контейнера.</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:775px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_mime_ru.png"><img class="thumbimage" height="578" src="../files/VCAeng_mime_ru.png" width="773" /></a>  <div class="thumbcaption">Рис.4.6. Вкладка конфигурации mime-данных контейнера.</div></div></div></div>
<p>Конфигурация сеанса проекта значительно отличается от конфигурации проекта (рис.4.7), однако, также, содержит страницы проекта.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1109px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_pg_ses_ru.png"><img class="thumbimage" height="647" src="../files/VCAeng_pg_ses_ru.png" width="1107" /></a>  <div class="thumbcaption">Рис.4.7. Страница конфигурации сеансов проектов.</div></div></div></div>
<p>С помощью этой страницы можно установить:
</p>
<ul><li> Состояние сеанса, а именно: "Включен"; "Исполняется"; пользователь; владелец; группа пользователей; доступ; исходный проект; режим исполнения в фоне; время исполнения сеанса; счётчик клиентских подключений; время, пользователь, язык последнего запроса; последнее действие пользователя и остаток времени до принудительного закрытия.</li>
<li> Период обсчёта сеанса.</li>
<li> Текущий стиль проекта.</li>
<li> Перечень открытых страниц.</li></ul>
<p>Страницы конфигурации визуальных элементов, расположенных в разных контейнерах, могут сильно отличаться, однако, это отличие заключается в наличии или отсутствии отдельных вкладок. Главная вкладка визуальных элементов фактически везде одинакова, отличаясь на одно конфигурационное поле и три в сеансе (рис.4.8). У страниц присутствуют вкладки дочерних страниц и вложенных виджетов. У контейнерных виджетов содержится вкладка вложенных виджетов. Все визуальные элементы содержат вкладку атрибутов (рис.4.9), кроме логических контейнеров проектов. Элементы, на уровне которых можно формировать пользовательскую процедуру и определять связи, содержат вкладки "Обработка" (рис.4.10) и "Связи" (рис.4.11).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:932px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_vit_main_ru.png"><img class="thumbimage" height="740" src="../files/VCAeng_vit_main_ru.png" width="930" /></a>  <div class="thumbcaption">Рис.4.8. Главная вкладка конфигурации визуальных элементов.</div></div></div></div>
<p>С помощью этой страницы можно установить:
</p>
<ul><li> Состояние элемента, а именно: "Включен", количество использования, родительский элемент и переход к нему, дата и время последней модификации.</li>
<li> Состояния режима сеанса исполнения: "Открыт", "Обработка" и использовано времени при исполнении поддерева и элемента, в <a href="../Program_manual.html#Config" title="Special:MyLanguage/Documents/Program manual">режиме отладки</a>.</li>
<li> Идентификатор, тип, корень, путь, имя, описание и иконка элемента.</li>
<li> Команда — очистить изменения.</li>
<li> Команда — опустить изменения виджета его предку.</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:885px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_vit_attr_ru.png"><img class="thumbimage" height="740" src="../files/VCAeng_vit_attr_ru.png" width="883" /></a>  <div class="thumbcaption">Рис.4.9. Вкладка атрибутов визуальных элементов.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1044px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_vit_proc_ru.png"><img class="thumbimage" height="765" src="../files/VCAeng_vit_proc_ru.png" width="1042" /></a>  <div class="thumbcaption">Рис.4.10. Вкладка обработки визуальных элементов.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1085px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_vit_lnk_ru.png"><img class="thumbimage" height="582" src="../files/VCAeng_vit_lnk_ru.png" width="1083" /></a>  <div class="thumbcaption">Рис.4.11. Вкладка связей визуальных элементов.</div></div></div></div>






</div><table style="border-top: dotted 2px #999999; margin-top: 20pt; color: gray;" width="100%"><tr><td style="text-align: left;" width="40%"><a href="http://oscada.org/wiki/Modules/VCAEngine/ru">Modules/VCAEngine/ru</a> - <a href="http://oscada.org/en/main/about-the-project/licenses/">GFDL</a></td><td style="text-align: center;">November 2020</td><td style="text-align: right;" width="40%">OpenSCADA 1+r2719</td></tr></table></body>
</html>