<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="UTF-8" />
<title>Модули/Web пользователя - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="../../en/files/doc.css" rel="stylesheet" /></head>
<body><div class="floatright"><a href="../index.html"><img src="../../en/files/index.png" /></a></div><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="ru">Модули/Web пользователя</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="ru"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a class="external text" href="http://oscada.org/wiki/index.php?title=Special:Translate&amp;group=page-Modules%2FWebUser&amp;action=page&amp;filter=&amp;language=ru" rel="nofollow noreferrer noopener" target="_blank">translated version</a></span> of the page <a class="external" href="http://oscada.org/wiki/Modules/WebUser" title="Modules/WebUser">Modules/WebUser</a> and the translation is 100% complete.</div><hr /><div class="mw-pt-languages" dir="ltr" lang="en"><div class="mw-pt-languages-list autonym"><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" href="../../en/Modules/WebUser.html" title="Modules/WebUser (100% translated)">English</a>&nbsp;• ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">mRussian</span>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="../../uk/Modules/WebUser.html" title="Модулі/Web користувача (100% translated)">Українська</a></div></div>
<table class="wikitable">

<tr>
<th> Модуль </th>
<th> Имя </th>
<th> Версия </th>
<th> Лицензия </th>
<th> Источник </th>
<th> Языки </th>
<th> Платформы </th>
<th> Тип </th>
<th> Автор </th>
<th> Описание
</th></tr>

<tr>
<td> <a href="../Modules/WebUser.html" title="Special:MyLanguage/Modules/WebUser">WebUser</a> </td>
<td> WWW-страница пользователя
</td>
<td> 1.5 </td>
<td> GPL2 </td>
<td> ui_WebUser.so </td>
<td> en,uk,ru,de </td>
<td> x86,x86_64,ARM
</td>
<td> Пользовательские интерфейсы </td>
<td> Роман Савоченко </td>
<td> Обеспечивает создание собственных WWW-страниц на внутреннем языке OpenSCADA.
</td></tr></table>
<p>Модуль предоставляет пользователю механизм создания WWW-страниц, а также позволяет обрабатывать иные WWW-запросы на внутреннем языке OpenSCADA, обычно <a href="../Modules/JavaLikeCalc.html" title="Special:MyLanguage/Modules/JavaLikeCalc">JavaLikeCalc</a>, не прибегая к низкоуровневому программированию. В роли обработчика страниц модуль позволяет использовать <a href="../Program_manual.html#DAQTmpl" title="Special:MyLanguage/Documents/Program manual">стандартные шаблоны DAQ</a>. Использование шаблонов DAQ позволяет создавать библиотеки WWW-страниц и вызов их в этом модуле многократно, как их реализации, а также предоставляет контекст данных исполнения шаблона с их связыванием с данными подсистемы "Сбор Данных".
</p><p>Кроме принадлежности модуля к OpenSCADA он также принадлежит и является модулем модуля транспортного протокола <a href="../Modules/HTTP.html" title="Special:MyLanguage/Modules/HTTP">Protocol.HTTP</a>. Собственно вызов модуля WebUser осуществляется из Protocol.HTTP и посредством расширенного механизма коммуникации, экспортированными в этом модуле функциями: HTTP_GET(), HTTP_POST().
</p><p>Адресация страниц начинается со второго элемента URI. Это связанно с тем, что первый элемент URI используется для идентификации самого модуля пользовательского WWW-интерфейса. Например, URL <i>http://localhost.localdomain:10002/WebUser/UserPage</i> можно расшифровать как вызов пользовательской страницы "UserPage" этого модуля "WebUser" на хосте "localhost.localdomain" через порт 10002. В случае отсутствия второго элемента URI и указания отображать индекс пользовательских страниц в конфигурации — формируется индекс страниц (рис.1).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:636px;"><a class="image" href="http://oscada.org/wiki/File:WebUser_idx_ru.png"><img class="thumbimage" height="310" src="../files/WebUser_idx_ru.png" width="634" /></a>  <div class="thumbcaption">Рис.1. Индекс пользовательских страниц.</div></div></div></div>
<p>Главная вкладка конфигурации модуля (рис.2) содержит состояние модуля, предоставляет возможность выбора страницы по умолчанию и позволяет сформировать перечень пользовательских страниц.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:828px;"><a class="image" href="http://oscada.org/wiki/File:WebUser_main_ru.png"><img class="thumbimage" height="532" src="../files/WebUser_main_ru.png" width="826" /></a>  <div class="thumbcaption">Рис.2. Основная вкладка конфигурации модуля.</div></div></div></div>
<h2><span class="mw-headline" id="WWW-.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D1.8B">WWW-страницы</span></h2>
<p>Модуль предоставляет возможность создания реализаций множества WWW-страниц в объекте "Пользовательская WWW-страница" (рис.3).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:828px;"><a class="image" href="http://oscada.org/wiki/File:WebUser_up_main_ru.png"><img class="thumbimage" height="532" src="../files/WebUser_up_main_ru.png" width="826" /></a>  <div class="thumbcaption">Рис.3. Главная вкладка конфигурации пользовательской страницы.</div></div></div></div>
<p>Главная вкладка содержит основные настройки WWW-страницы:
</p>
<ul><li> Раздел "Состояние" — содержит свойства, характеризующие состояние страницы: статус, "Включен", имя БД (содержащей конфигурацию и с отслеживанием наличия данных в различных хранилищах и предоставлением последовательного удаления дубликатов) и дату последней модификации.</li>
<li> Идентификатор, имя и описание страницы.</li>
<li> Состояние "Включен", в которое переводить страницу при загрузке.</li>
<li> Язык прямой процедуры или <a href="../Program_manual.html#DAQTmpl" title="Special:MyLanguage/Documents/Program manual">DAQ-шаблон</a>, связанный со страницей.</li></ul>
<p>Все запросы к пользовательским страницам направляются в прямую процедуру обработки запросов пользовательской страницы, или процедуру DAQ-шаблона, которая представлена на вкладке "Программа" объекта страницы пользователя (рис.4). В случае с DAQ-шаблоном также предоставляется вкладка конфигурации шаблона (рис.5).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:910px;"><a class="image" href="http://oscada.org/wiki/File:WebUser_up_prog_ru.png"><img class="thumbimage" height="683" src="../files/WebUser_up_prog_ru.png" width="908" /></a>  <div class="thumbcaption">Рис.4. Вкладка "Процедура" объекта пользовательской WWW-страницы.</div></div></div></div>
<p>Вкладка процедуры обработки запросов к пользовательской странице содержит:
</p>
<ul><li> Таблицу контекста данных процедуры. В основном имеет смысл только при работе по шаблону и где можно контролировать этот процесс обработки, включая возможность вмешательства через изменение значений данных.</li>
<li> Текст прямой процедуры страницы, отсутствует в режиме работы по шаблону.</li>
<li> Связи на данные подсистемы "Сбор Данных", которые видимы и доступны для определения в режиме работы по шаблону и во включенном состоянии объекта страницы.</li></ul>
<p>Для прямой процедуры обработки предопределены, и обязательны или опциональны для создания в шаблоне, следующие атрибуты обмена с протоколом HTTP:
</p>
<ul><li> <i><b>Результат (rez)</b></i> &lt;Строка&gt; — результат обработки, по умолчанию — "200 OK"; в режиме DAQ-шаблона Вы должны писать сюда прямо, не оператором "return";</li>
<li> <i><b>HTTP запрос (HTTPreq)</b></i> &lt;Строка&gt; — метод HTTP запроса: GET, POST;</li>
<li> <i><b>URL (url)</b></i> &lt;Строка&gt; — URI запроса;</li>
<li> <i><b>WWW-страница (page)</b></i> &lt;Строка&gt; — содержимое страницы Get/Post, как для запроса так и ответа;</li>
<li> <i>Отправитель (sender)</i> &lt;Строка&gt; — отправитель запроса;</li>
<li> <i>Пользователь (user)</i> &lt;Строка&gt; — аутентифицированный пользователь;</li>
<li> <i><b>HTTP переменные (HTTPvars)</b></i> &lt;Объект&gt; — HTTP переменные; изменённые и добавленные переменные (кроме "Date", "Server", "Accept-Ranges" и "Content-Length") будут помещены в пакет ответа;</li>
<li> <i>Параметры URL (URLprms)</i> &lt;Объект&gt; — параметры URL;</li>
<li> <i>Элементы содержимого (cnts)</i> &lt;Объект::Array&lt;XMLNodeObj&gt;&gt; — элементы содержимого для POST;</li>
<li> <i>Этот объект (this)</i> &lt;Объект&gt; — указатель на объект этой страницы;</li>
<li> <i>Объект протокола (prt)</i> &lt;Объект&gt; — указатель на объект входной части HTTP протокола.</li></ul>
<p>Общий сценарий запроса пользовательской страницы:
</p>
<ul><li> Внешняя сетевая станция формирует HTTP запрос с URI вида "/WebUser/{UserPage}", который попадает на транспорт OpenSCADA с значением поля конфигурации "Протокол", равного "HTTP".</li>
<li> Транспорт направляет запрос на модуль транспортного протокола "Protocol.HTTP".</li>
<li> Модуль транспортного протокола, согласно первого элемента URI, направляет запрос данному модулю.</li>
<li> Данный модуль выбирает объект страницы пользователя, которая указана во втором элементе URI.</li>
<li> Выполняется инициализация переменных HTTP-протокола для процедуры страницы:
<ul><li> <i><b>HTTPreq</b></i> — устанавливается в значение строки "GET" или "POST", в зависимости от типа запроса;</li>
<li> <i><b>url</b></i> — адрес запрашиваемого ресурса (URI);</li>
<li> <i><b>page</b></i> — входное одиночное содержимое и передаваемая страница, для метода "POST";</li>
<li> <i>sender</i> — адрес отправителя запроса;</li>
<li> <i>user</i> — идентификатор аутентифицированного пользователя, если аутентификация имела место;</li>
<li> <i><b>HTTPvars</b></i> — разобранный перечень переменных протокола HTTP в виде свойств объекта;</li>
<li> <i>URLprms</i> — разобранный перечень параметров URL в виде свойств объекта;</li>
<li> <i>cnts</i> — разобранные элементы содержимого для POST, в Array&lt;XMLNodeObj&gt;, с содержимым элементов в тексте и свойствами, в атрибутах XMLNodeObj.</li></ul></li>
<li> Вызов процедуры на исполнение, которая, обработав запрос, формирует содержимое страницы в "page" и результат запроса в "rez".</li>
<li> В завершение формируется ответ с кодом возврата HTTP из "rez" и содержимым из "page", а также изменёнными и добавленными переменными протокола HTTP из "HTTPvars".</li></ul>






</div><table style="border-top: dotted 2px #999999; margin-top: 20pt; color: gray;" width="100%"><tr><td style="text-align: left;" width="40%"><a href="http://oscada.org/wiki/Modules/WebUser/ru">Modules/WebUser/ru</a> - <a href="http://oscada.org/en/main/about-the-project/licenses/">GFDL</a></td><td style="text-align: center;">January 2023</td><td style="text-align: right;" width="40%"> 1+r2866</td></tr></table></body>
</html>